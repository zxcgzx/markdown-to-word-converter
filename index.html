<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarkdownËΩ¨WordÊ†ºÂºèËΩ¨Êç¢Âô®</title>
    <script src="https://cdn.jsdelivr.net/npm/marked@9.0.0/marked.min.js"></script>
    <script src="https://unpkg.com/docx@7.8.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- KaTeXÊï∞Â≠¶ÂÖ¨ÂºèÊîØÊåÅ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    <!-- Chart.jsÁî®‰∫éÊï∞ÊçÆÂèØËßÜÂåñ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <style>
        /* Ê∏©ÊöñÁê•ÁèÄ‰∏ªÈ¢ò‰Ωú‰∏∫ÈªòËÆ§‰∏ªÈ¢ò */
        :root {
            --bg-gradient-start: #ffeaa7;
            --bg-gradient-end: #fab1a0;
            --container-bg: rgba(255, 255, 255, 0.95);
            --header-gradient-start: #0984e3;
            --header-gradient-end: #00b894;
            --text-primary: #2d3436;
            --text-secondary: #636e72;
            --text-muted: #b2bec3;
            --text-white: #ffffff;
            --border-color: rgba(255, 234, 167, 0.6);
            --border-focus: #0984e3;
            --preview-bg: rgba(255, 255, 255, 0.8);
            --controls-bg: rgba(255, 255, 255, 0.9);
            --card-bg: rgba(255, 255, 255, 0.85);
            --accent-primary: #0984e3;
            --accent-secondary: #00b894;
            --success: #00b894;
            --warning: #e17055;
            --info: #74b9ff;
            --shadow: rgba(255, 177, 160, 0.2);
            --shadow-hover: rgba(9, 132, 227, 0.15);
            --shadow-focus: rgba(9, 132, 227, 0.25);
            --transition: all 0.18s ease-out;
            --blur: blur(15px);
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 234, 167, 0.3);
        }

        /* ÊûÅÁÆÄÁôΩËâ≤‰∏ªÈ¢ò - LinearÈ£éÊ†º */
        [data-theme="light"] {
            --bg-gradient-start: #ffffff;
            --bg-gradient-end: #fafbfc;
            --container-bg: rgba(255, 255, 255, 0.95);
            --header-gradient-start: #0070f3;
            --header-gradient-end: #0366d6;
            --text-primary: #171717;
            --text-secondary: #525252;
            --text-muted: #a3a3a3;
            --text-white: #ffffff;
            --border-color: #e5e5e5;
            --border-focus: #0070f3;
            --preview-bg: rgba(250, 251, 252, 0.8);
            --controls-bg: rgba(255, 255, 255, 0.9);
            --card-bg: rgba(255, 255, 255, 0.9);
            --accent-primary: #0070f3;
            --accent-secondary: #00d4aa;
            --success: #00d4aa;
            --warning: #ff4444;
            --info: #0070f3;
            --shadow: rgba(0, 0, 0, 0.04);
            --shadow-hover: rgba(0, 112, 243, 0.08);
            --shadow-focus: rgba(0, 112, 243, 0.12);
            --transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --blur: blur(20px);
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.2);
        }



        /* ÁªèÂÖ∏‰∏ªÈ¢ò - ÂéüÂßãÈÖçËâ≤ÊñπÊ°à */
        [data-theme="classic"] {
            --bg-gradient-start: #667eea;
            --bg-gradient-end: #764ba2;
            --container-bg: #ffffff;
            --header-gradient-start: #4CAF50;
            --header-gradient-end: #45a049;
            --text-primary: #333333;
            --text-secondary: #666666;
            --text-muted: #999999;
            --text-white: #ffffff;
            --border-color: #e0e0e0;
            --border-focus: #4CAF50;
            --preview-bg: #fafafa;
            --controls-bg: #f8f9fa;
            --card-bg: #ffffff;
            --accent-primary: #4CAF50;
            --accent-secondary: #2196F3;
            --success: #4CAF50;
            --warning: #ff9800;
            --info: #2196F3;
            --shadow: rgba(0, 0, 0, 0.1);
            --shadow-hover: rgba(76, 175, 80, 0.3);
            --shadow-focus: rgba(76, 175, 80, 0.4);
            --transition: all 0.3s ease;
            --blur: blur(8px);
            --glass-bg: #ffffff;
            --glass-border: #e0e0e0;
        }

        /* ÁªèÂÖ∏‰∏ªÈ¢òÁâπÊÆäÊ†∑ÂºèÂ§ÑÁêÜ */
        [data-theme="classic"] .container {
            background: var(--container-bg);
            border-radius: 15px;
            box-shadow: 0 20px 40px var(--shadow);
            backdrop-filter: none;
            border: none;
        }

        [data-theme="classic"] .analytics-card {
            background: var(--card-bg);
            backdrop-filter: none;
            box-shadow: 0 2px 8px var(--shadow);
        }

        [data-theme="classic"] .btn {
            backdrop-filter: none;
            border: none;
            box-shadow: 0 4px 15px var(--shadow-hover);
        }

        [data-theme="classic"] .btn-secondary {
            backdrop-filter: none;
            box-shadow: 0 1px 3px var(--shadow);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            padding: 20px;
            margin: 0;
            transition: var(--transition);
            position: relative;
            overflow-x: hidden;
        }


        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: float 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(10px, -10px) rotate(1deg); }
            66% { transform: translate(-5px, 5px) rotate(-1deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--glass-bg);
            border-radius: 24px;
            box-shadow: 
                0 8px 32px var(--shadow),
                0 0 0 1px var(--glass-border),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--blur);
            overflow: hidden;
            min-height: calc(100vh - 40px);
            transition: var(--transition);
            position: relative;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--glass-border), transparent);
        }

        .header {
            background: linear-gradient(135deg, var(--header-gradient-start), var(--header-gradient-end));
            color: var(--text-white);
            text-align: center;
            padding: 32px;
            position: relative;
            transition: var(--transition);
            backdrop-filter: var(--blur);
            box-shadow: 0 1px 0 0 rgba(255, 255, 255, 0.1) inset;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .author-info {
            font-size: 0.9em;
            opacity: 0.8;
            font-style: italic;
        }

        .author-info .author-name {
            font-weight: bold;
            color: #E8F5E8;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            min-height: 500px;
        }

        .input-section, .preview-section {
            display: flex;
            flex-direction: column;
        }

        .section-title {
            font-size: 1.3em;
            color: var(--text-primary);
            margin-bottom: 15px;
            font-weight: 600;
            transition: var(--transition);
        }

        #markdownInput {
            width: 100%;
            height: 400px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: var(--transition);
            line-height: 1.5;
            background: var(--container-bg);
            color: var(--text-primary);
        }

        #markdownInput:focus {
            outline: none;
            border-color: var(--border-focus);
        }

        #preview {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            min-height: 400px;
            background: var(--preview-bg);
            overflow-y: auto;
            transition: var(--transition);
            color: var(--text-primary);
        }

        .controls {
            padding: 30px;
            background: var(--controls-bg);
            text-align: center;
            border-top: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--text-white);
            border: none;
            padding: 14px 28px;
            font-size: 15px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            margin: 0 8px;
            transition: var(--transition);
            box-shadow: 
                0 4px 14px var(--shadow-hover),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            backdrop-filter: var(--blur);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 24px var(--shadow-focus),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            filter: brightness(1.05) saturate(1.1);
        }

        .btn:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 14px var(--shadow-hover);
        }

        .btn-secondary {
            background: var(--glass-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            box-shadow: 
                0 2px 8px var(--shadow),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .btn-secondary:hover {
            background: var(--preview-bg);
            border-color: var(--border-focus);
            color: var(--accent-primary);
            transform: translateY(-1px);
            box-shadow: 
                0 4px 12px var(--shadow-hover),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .example-section {
            margin: 20px 0;
        }

        .example-btn {
            background: #2196F3;
            font-size: 14px;
            padding: 8px 20px;
        }

        .example-btn:hover {
            background: #1976D2;
        }

        /* Âπ≥ÊùøÁ´Ø‰ºòÂåñ */
        @media (max-width: 1024px) {
            .container {
                margin: 5px;
                border-radius: 10px;
            }
            
            .main-content {
                padding: 15px;
                gap: 15px;
            }
        }

        /* ÁßªÂä®Á´Ø‰ºòÂåñ */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            .container {
                border-radius: 8px;
                min-height: calc(100vh - 10px);
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 1.8em;
                margin-bottom: 8px;
            }
            
            .header p {
                font-size: 1em;
                margin-bottom: 10px;
            }
            
            .author-info {
                font-size: 0.8em;
            }
            
            .main-content {
                grid-template-columns: 1fr;
                padding: 15px;
                gap: 20px;
            }
            
            #markdownInput {
                height: 300px;
                font-size: 16px; /* Èò≤Ê≠¢iOSÁº©Êîæ */
                padding: 12px;
            }
            
            #preview {
                min-height: 300px;
                padding: 15px;
            }
            
            .controls {
                padding: 20px 15px;
                text-align: center;
            }
            
            .btn {
                margin: 5px;
                padding: 12px 20px;
                font-size: 14px;
                display: inline-block;
                min-width: 120px;
            }
            
            .btn-secondary {
                padding: 10px 16px;
                font-size: 13px;
                min-width: 100px;
            }
            
            .shortcut-info {
                font-size: 0.8em;
                margin-top: 10px;
                line-height: 1.4;
            }
            
            .word-count {
                position: static;
                margin-top: 5px;
                text-align: right;
                background: none;
                font-size: 11px;
            }
            
            .drag-hint::after {
                font-size: 11px;
                bottom: -20px;
            }
        }

        /* Â∞èÂ±èÊâãÊú∫‰ºòÂåñ */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .header p {
                font-size: 0.9em;
            }
            
            .author-info {
                font-size: 0.75em;
            }
            
            .main-content {
                padding: 10px;
            }
            
            #markdownInput {
                height: 250px;
                padding: 10px;
                font-size: 16px;
            }
            
            #preview {
                min-height: 250px;
                padding: 12px;
            }
            
            .controls {
                padding: 15px 10px;
            }
            
            .btn {
                width: calc(50% - 10px);
                margin: 3px 5px;
                padding: 10px 8px;
                font-size: 13px;
            }
            
            .btn-secondary {
                width: calc(50% - 10px);
                margin: 3px 5px;
                padding: 8px 6px;
                font-size: 12px;
            }
            
            .shortcut-info {
                font-size: 0.7em;
                padding: 0 5px;
            }
            
            .section-title {
                font-size: 1.1em;
                margin-bottom: 10px;
            }
        }

        /* È¢ÑËßàÊ†∑Âºè */
        #preview h1, #preview h2, #preview h3, #preview h4, #preview h5, #preview h6 {
            color: #333;
            margin: 20px 0 10px 0;
        }

        #preview h1 { font-size: 2em; }
        #preview h2 { font-size: 1.7em; }
        #preview h3 { font-size: 1.4em; }

        #preview p {
            margin: 10px 0;
            line-height: 1.6;
        }

        #preview ul, #preview ol {
            margin: 10px 0;
            padding-left: 30px;
        }

        #preview li {
            margin: 5px 0;
        }

        #preview code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }

        #preview pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
        }

        #preview blockquote {
            border-left: 4px solid #4CAF50;
            margin: 15px 0;
            padding: 10px 20px;
            background: #f9f9f9;
        }

        #preview table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
        }

        #preview th, #preview td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        #preview th {
            background-color: #f2f2f2;
        }

        /* ÊãñÊãΩÊèêÁ§∫Ê†∑Âºè */
        .drag-hint {
            position: relative;
        }

        .drag-hint::after {
            content: "üí° ÊèêÁ§∫ÔºöÊîØÊåÅÊãñÊãΩ .md Êñá‰ª∂Âà∞ËæìÂÖ•Ê°Ü";
            position: absolute;
            bottom: -25px;
            left: 0;
            font-size: 12px;
            color: #666;
            opacity: 0.7;
        }

        /* Âø´Êç∑ÈîÆÊèêÁ§∫ */
        .shortcut-info {
            margin-top: 15px;
            font-size: 0.9em;
            color: #666;
            text-align: center;
        }

        .shortcut-info strong {
            color: #4CAF50;
        }

        /* Áä∂ÊÄÅÊåáÁ§∫Âô® */
        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 8px 15px;
            background: #4CAF50;
            color: white;
            border-radius: 20px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .status-indicator.show {
            opacity: 1;
        }

        .status-indicator.error {
            background: #f44336;
        }

        .status-indicator.info {
            background: #2196F3;
        }

        /* ÊîπËøõÊåâÈíÆÊ†∑Âºè */
        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #5a6268);
            font-size: 14px;
            padding: 10px 20px;
        }

        .btn-secondary:hover {
            background: linear-gradient(45deg, #5a6268, #495057);
        }

        /* Êñá‰ª∂ËæìÂÖ•Âå∫Âüü‰ºòÂåñ */
        .input-section {
            position: relative;
        }

        /* Â≠óÊï∞ÁªüËÆ° */
        .word-count {
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 12px;
            color: #999;
            background: rgba(255, 255, 255, 0.8);
            padding: 2px 6px;
            border-radius: 3px;
        }

        /* ÂØÜÁ†ÅÈ™åËØÅÁïåÈù¢Ê†∑Âºè */
        .password-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .password-modal {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .password-modal h2 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        .password-modal .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1em;
        }

        .password-modal .beta-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-size: 0.9em;
        }

        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
            transition: border-color 0.3s;
        }

        .password-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .password-btn {
            width: 100%;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px;
            font-size: 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
        }

        .password-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .password-error {
            color: #f44336;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .password-hint {
            color: #666;
            font-size: 12px;
            margin-top: 15px;
            line-height: 1.4;
        }

        /* ÈöêËóè‰∏ªÂÜÖÂÆπ */
        .main-app {
            display: none;
        }

        .main-app.authenticated {
            display: block;
        }

        /* ÂØÜÁ†ÅÁïåÈù¢ÁßªÂä®Á´ØÈÄÇÈÖç */
        @media (max-width: 768px) {
            .password-modal {
                padding: 30px 20px;
                margin: 20px;
                max-width: none;
                width: calc(100% - 40px);
            }
            
            .password-modal h2 {
                font-size: 1.5em;
            }
            
            .password-input {
                font-size: 16px; /* Èò≤Ê≠¢iOSÁº©Êîæ */
            }
        }

        @media (max-width: 480px) {
            .password-modal {
                padding: 25px 15px;
                margin: 15px;
                width: calc(100% - 30px);
            }
            
            .password-modal h2 {
                font-size: 1.3em;
            }
            
            .password-modal .subtitle {
                font-size: 0.9em;
            }
            
            .password-modal .beta-info {
                font-size: 0.8em;
                padding: 12px;
            }
        }

        /* ÁÆ°ÁêÜÂëòÈù¢ÊùøÊ†∑Âºè */
        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 20000;
        }

        .admin-modal {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .admin-header {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-header h2 {
            margin: 0;
            font-size: 1.5em;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .admin-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }

        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: white;
            color: #333;
            border-bottom: 3px solid #4CAF50;
        }

        .tab-btn:hover {
            background: #e9ecef;
        }

        .admin-tab-content {
            padding: 25px;
        }

        .admin-tab-content h3 {
            margin-top: 0;
            color: #333;
            font-size: 1.3em;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .admin-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .password-list,
        .statistics-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .password-item,
        .stat-item {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .password-info,
        .stat-info {
            flex: 1;
        }

        .password-text {
            font-family: 'Courier New', monospace;
            background: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
            color: #333;
            border: 1px solid #ddd;
        }

        .password-meta {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .password-actions {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .delete-btn {
            background: #f44336;
            color: white;
        }

        .delete-btn:hover {
            background: #d32f2f;
        }

        .extend-btn {
            background: #2196F3;
            color: white;
        }

        .extend-btn:hover {
            background: #1976D2;
        }

        .usage-btn {
            background: #FF9800;
            color: white;
        }

        .usage-btn:hover {
            background: #F57C00;
        }

        .expired {
            opacity: 0.6;
            background: #ffebee;
        }

        .usage-exceeded {
            opacity: 0.6;
            background: #fff3e0;
        }

        @media (max-width: 768px) {
            .admin-modal {
                width: 95%;
                max-height: 95vh;
            }
            
            .admin-header {
                padding: 15px;
            }
            
            .admin-header h2 {
                font-size: 1.2em;
            }
            
            .admin-tab-content {
                padding: 15px;
            }
            
            .password-item,
            .stat-item {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .password-actions {
                justify-content: flex-end;
            }
        }

        /* ÁÆ°ÁêÜÂëòÊèêÁ§∫Ê†∑Âºè */
        .admin-hint {
            margin-left: 15px;
            font-size: 0.8em;
            color: #FFD700;
            animation: pulse 2s infinite;
            cursor: pointer;
            transition: all 0.3s;
        }

        .admin-hint:hover {
            transform: scale(1.2);
            color: #FFA500;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Áî®Êà∑Áä∂ÊÄÅÂ¢ûÂº∫Ê†∑Âºè */
        .user-status-super {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
            animation: glow 3s ease-in-out infinite alternate;
        }

        .user-status-temp {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            box-shadow: 0 2px 10px rgba(76, 175, 80, 0.3);
        }

        @keyframes glow {
            from { box-shadow: 0 2px 10px rgba(255, 215, 0, 0.3); }
            to { box-shadow: 0 2px 20px rgba(255, 215, 0, 0.6); }
        }

        /* ÂØÜÁ†ÅÈ™åËØÅÁïåÈù¢Â¢ûÂº∫ */
        .password-modal .beta-info {
            position: relative;
        }

        .password-modal .beta-info::before {
            content: "üí°";
            position: absolute;
            left: -30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(-50%); }
            40% { transform: translateY(-60%); }
            60% { transform: translateY(-55%); }
        }

        /* Áä∂ÊÄÅÊèêÁ§∫Â¢ûÂº∫ */
        .status-indicator.info {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            border-radius: 25px;
            padding: 10px 20px;
            font-weight: bold;
        }

        .status-indicator.success {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            border-radius: 25px;
            padding: 10px 20px;
            font-weight: bold;
        }

        .status-indicator.error {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            border-radius: 25px;
            padding: 10px 20px;
            font-weight: bold;
        }

        /* ÊâπÈáèÁîüÊàêÁªìÊûúÊ†∑Âºè */
        .batch-result {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .batch-result h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .batch-result-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            background: white;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        .batch-password-item {
            padding: 5px 10px;
            margin: 2px 0;
            background: #f0f8ff;
            border-radius: 4px;
            border-left: 3px solid #4CAF50;
        }

        .copy-success {
            color: #4CAF50;
            font-weight: bold;
            margin-left: 10px;
        }

        /* Áî®Êà∑Áä∂ÊÄÅÊ†èÊ†∑Âºè */
        .user-status-bar {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-top: 1px solid #dee2e6;
            border-bottom: 1px solid #dee2e6;
            padding: 15px 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 60px;
        }

        .user-status-content {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .user-status-super {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--text-white);
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 15px;
            backdrop-filter: var(--blur);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 16px var(--shadow-hover);
            animation: glow 3s ease-in-out infinite alternate;
        }

        .user-status-temp {
            background: linear-gradient(135deg, var(--success), #388e3c);
            color: var(--text-white);
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 15px;
            backdrop-filter: var(--blur);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 16px var(--shadow-hover);
        }

        .status-detail {
            background: var(--card-bg);
            padding: 8px 16px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
            backdrop-filter: var(--blur);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .status-warning {
            background: linear-gradient(135deg, var(--warning), #d84315);
            color: var(--text-white);
            padding: 8px 16px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 13px;
            backdrop-filter: var(--blur);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: pulse 2s infinite;
        }

        /* ÁßªÂä®Á´ØÈÄÇÈÖç */
        @media (max-width: 768px) {
            .user-status-bar {
                padding: 12px 15px;
                min-height: auto;
            }
            
            .user-status-content {
                flex-direction: column;
                gap: 10px;
            }
            
            .user-status-super,
            .user-status-temp {
                font-size: 14px;
                padding: 6px 15px;
            }
            
            .status-detail {
                font-size: 12px;
                padding: 6px 12px;
                text-align: center;
            }
        }

        /* ÂØºÂá∫ÂäüËÉΩÊ†∑Âºè */
        .export-section {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .export-section h4 {
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .export-desc {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .btn-warning {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: white;
        }

        .btn-warning:hover {
            background: linear-gradient(45deg, #f57c00, #ef6c00);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.4);
        }

        /* Áé∞‰ª£ÂåñÁä∂ÊÄÅÊåâÈíÆÊ†∑Âºè */
        .logout-btn {
            background: linear-gradient(135deg, var(--warning), #c62828);
            color: var(--text-white);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: var(--transition);
            margin-left: 12px;
            backdrop-filter: var(--blur);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logout-btn:hover {
            background: linear-gradient(135deg, #c62828, #b71c1c);
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(244, 67, 54, 0.3);
            filter: brightness(1.1);
        }

        /* Áé∞‰ª£Âåñ‰∏ªÈ¢òÂàáÊç¢Âô®Ê†∑Âºè */
        .theme-switcher {
            display: flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.15);
            padding: 6px 12px;
            border-radius: 12px;
            backdrop-filter: var(--blur);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .theme-switcher span {
            font-size: 14px;
            color: var(--text-white);
            margin-right: 4px;
        }

        .theme-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-white);
            padding: 4px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: var(--transition);
            margin: 0 1px;
            backdrop-filter: var(--blur);
        }

        .theme-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }

        .theme-btn.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.6);
            font-weight: 600;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2) inset;
        }

        /* Áé∞‰ª£ÂåñÊï∞ÊçÆÂàÜÊûê‰ª™Ë°®ÊùøÊ†∑Âºè */
        .analytics-dashboard {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(16px);
            z-index: 10000;
            display: none;
            overflow-y: auto;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .analytics-content {
            max-width: 1200px;
            margin: 20px auto;
            background: var(--container-bg);
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 16px 64px var(--shadow), 0 0 0 1px var(--border-color);
            backdrop-filter: var(--blur);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .analytics-title {
            font-size: 2em;
            color: var(--text-primary);
            margin: 0;
        }

        .analytics-close {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
        }

        .analytics-close:hover {
            background: linear-gradient(45deg, #d32f2f, #c62828);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.4);
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .analytics-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            transition: var(--transition);
            backdrop-filter: var(--blur);
            box-shadow: 
                0 4px 16px var(--shadow),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .analytics-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--glass-border), transparent);
        }

        .analytics-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                0 12px 40px var(--shadow-hover),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: var(--accent-primary);
        }

        .analytics-card h3 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .stats-number {
            font-size: 2.5em;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 10px 0;
        }

        .stats-label {
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .data-table th {
            background: var(--controls-bg);
            font-weight: 600;
        }


        .data-table tr:hover {
            background: var(--preview-bg);
        }

        /* Âø´Êç∑ÈîÆÊèêÁ§∫ */
        .shortcut-hint {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--container-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            font-size: 12px;
            color: var(--text-secondary);
            box-shadow: 0 5px 15px var(--shadow);
            z-index: 1000;
        }

        /* ÂàÜÁ±ªÁÆ°ÁêÜÊ†∑Âºè */
        .category-management {
            display: none;
        }

        .category-form {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .category-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .category-item {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            padding: 15px;
            transition: var(--transition);
        }

        .category-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-hover);
        }

        .category-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .category-stats {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .category-actions {
            display: flex;
            gap: 8px;
        }

        .filter-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--controls-bg);
            color: var(--text-primary);
        }

        /* ÁõëÊéßÂëäË≠¶Ê†∑Âºè */
        .monitoring-management {
            display: none;
        }

        .monitoring-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .monitoring-section {
            margin-bottom: 25px;
        }

        .monitoring-section h4 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .alert-item {
            background: var(--preview-bg);
            border-left: 4px solid var(--warning);
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 0 6px 6px 0;
        }

        .alert-critical {
            border-left-color: #f44336;
        }

        .alert-warning {
            border-left-color: #ff9800;
        }

        .alert-info {
            border-left-color: #2196f3;
        }

        .monitoring-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .monitoring-stat {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .monitoring-stat-value {
            font-size: 1.8em;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 5px;
        }

        .monitoring-stat-label {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        /* ÁßªÂä®Á´ØÈÄÇÈÖç */
        @media (max-width: 768px) {
            .analytics-content {
                margin: 10px;
                padding: 20px;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .theme-switcher {
                flex-direction: column;
                gap: 5px;
                padding: 10px;
            }
            
            .shortcut-hint {
                bottom: 10px;
                right: 10px;
                font-size: 11px;
            }

            .category-list {
                grid-template-columns: 1fr;
            }

            .filter-controls {
                flex-direction: column;
            }

            .monitoring-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- ÂØÜÁ†ÅÈ™åËØÅÁïåÈù¢ -->
    <div id="passwordOverlay" class="password-overlay">
        <div class="password-modal">
            <h2>üîê ËÆøÈóÆÈ™åËØÅ</h2>
            <p class="subtitle">MarkdownËΩ¨WordËΩ¨Êç¢Âô®</p>
            <div class="beta-info">
                <strong>‚ö†Ô∏è ‰∏™‰∫∫ÂÜÖÊµãÁâàÊú¨</strong><br>
                Ê≠§ÁâàÊú¨‰ªÖ‰æõÂÜÖÈÉ®ÊµãËØï‰ΩøÁî®ÔºåËØ∑ËæìÂÖ•ËÆøÈóÆÂØÜÁ†Å
            </div>
            <input type="password" id="passwordInput" class="password-input" placeholder="ËØ∑ËæìÂÖ•ËÆøÈóÆÂØÜÁ†Å" maxlength="20">
            <button onclick="verifyPassword()" class="password-btn">üöÄ ËøõÂÖ•Â∫îÁî®</button>
            <div id="passwordError" class="password-error">ÂØÜÁ†ÅÈîôËØØÔºåËØ∑ÈáçËØï</div>
            <div class="password-hint">
                üí° ÊèêÁ§∫ÔºöÂ¶ÇÈúÄËé∑ÂèñËÆøÈóÆÂØÜÁ†ÅÔºåËØ∑ËÅîÁ≥ªÂºÄÂèëËÄÖ<br>
                <strong>Boning</strong> ¬∑ TJUT<br><br>
                <small style="color: #999;">Ë∞ÉËØïÔºö<a href="#" onclick="resetPasswordData()" style="color: #666;">ÈáçÁΩÆÂØÜÁ†ÅÊï∞ÊçÆ</a></small>
            </div>
        </div>
    </div>

    <!-- ‰∏ªÂ∫îÁî®ÁïåÈù¢ -->
    <div id="mainApp" class="main-app">
        <div class="container">
            <div class="header">
                <h1 id="mainTitle" onclick="handleTitleClick()">
                    üìù MarkdownËΩ¨WordËΩ¨Êç¢Âô®
                    <span id="adminHint" class="admin-hint" style="display: none;" title="ÁÇπÂáª‰∏âÊ¨°ËøõÂÖ•ÁÆ°ÁêÜÈù¢Êùø">üîß</span>
                </h1>
                <p>Â∞ÜÊÇ®ÁöÑMarkdownÊñáÊ°£Âø´ÈÄüËΩ¨Êç¢‰∏∫WordÊ†ºÂºè</p>
                <div class="author-info">
                    Áî± <span class="author-name">Boning</span> ÂºÄÂèë ¬∑ TJUT ¬∑ <span style="color: #E8F5E8;">ÂÜÖÊµãÁâà</span>
                </div>
            </div>
            
            <!-- Áî®Êà∑Áä∂ÊÄÅÊ†è -->
            <div id="userStatusBar" class="user-status-bar" style="display: none;">
                <div id="userStatusContent" class="user-status-content">
                    <!-- Áî®Êà∑Áä∂ÊÄÅ‰ø°ÊÅØÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>

        <div class="main-content">
            <div class="input-section drag-hint">
                <h2 class="section-title">üìù ËæìÂÖ•MarkdownÂÜÖÂÆπ</h2>
                <textarea id="markdownInput" placeholder="Âú®ËøôÈáåËæìÂÖ•ÊÇ®ÁöÑMarkdownÂÜÖÂÆπ...

‰æãÂ¶Ç:
# Ê†áÈ¢ò‰∏Ä
## Ê†áÈ¢ò‰∫å
### Ê†áÈ¢ò‰∏â

**Á≤ó‰ΩìÊñáÊú¨**
*Êñú‰ΩìÊñáÊú¨*

- ÂàóË°®È°π1
- ÂàóË°®È°π2
- ÂàóË°®È°π3

> ËøôÊòØ‰∏Ä‰∏™ÂºïÁî®Âùó

```javascript
console.log('Hello World!');
```

[ÈìæÊé•ÊñáÊú¨](https://example.com)

| Ë°®Ê†º | Á§∫‰æã |
|------|------|
| ÂçïÂÖÉÊ†º1 | ÂçïÂÖÉÊ†º2 |
| ÂçïÂÖÉÊ†º3 | ÂçïÂÖÉÊ†º4 |"></textarea>
                <div class="word-count" id="wordCount">0 Â≠óÁ¨¶</div>
                
                <div class="example-section">
                    <button class="btn example-btn" onclick="loadExample()">üìÑ Âä†ËΩΩÁ§∫‰æã</button>
                </div>
            </div>

            <div class="preview-section">
                <h2 class="section-title">üëÄ ÂÆûÊó∂È¢ÑËßà</h2>
                <div id="preview">ËØ∑Âú®Â∑¶‰æßËæìÂÖ•MarkdownÂÜÖÂÆπ...</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" onclick="downloadWord()">üìÑ ‰∏ãËΩΩWordÊñáÊ°£</button>
            <button class="btn" onclick="copyFormattedText()">üìã Â§çÂà∂ÂØåÊñáÊú¨</button>
            <button class="btn btn-secondary" onclick="clearContent()">üóëÔ∏è Ê∏ÖÁ©∫ÂÜÖÂÆπ</button>
            <button class="btn btn-secondary" onclick="uploadFile()">üìÅ ‰∏ä‰º†MarkdownÊñá‰ª∂</button>
            <button class="btn btn-secondary" onclick="saveToLocal()">üíæ ‰øùÂ≠òËçâÁ®ø</button>
            <button class="btn btn-secondary" onclick="loadFromLocal()">üìÇ Âä†ËΩΩËçâÁ®ø</button>
            
            <div class="shortcut-info">
                Âø´Êç∑ÈîÆÔºö<strong>Ctrl+S</strong> ‰øùÂ≠òËçâÁ®ø | <strong>Ctrl+O</strong> ÊâìÂºÄÊñá‰ª∂ | <strong>Ctrl+D</strong> ‰∏ãËΩΩWord
            </div>
        </div>
        
        <!-- Áä∂ÊÄÅÊåáÁ§∫Âô® -->
        <div id="statusIndicator" class="status-indicator"></div>
        
        <!-- ÈöêËóèÁöÑÊñá‰ª∂ËæìÂÖ• -->
        <input type="file" id="fileInput" accept=".md,.markdown,.txt" style="display: none;" onchange="handleFileUpload(event)">
        
        <!-- ÁÆ°ÁêÜÂëòÈù¢ÊùøÔºàÈöêËóèÔºâ -->
        <div id="adminPanel" class="admin-panel" style="display: none;">
            <div class="admin-modal">
                <div class="admin-header">
                    <h2>üîê ÂØÜÁ†ÅÁÆ°ÁêÜÁ≥ªÁªü</h2>
                    <button onclick="closeAdminPanel()" class="close-btn">‚úï</button>
                </div>
                
                <div class="admin-tabs">
                    <button class="tab-btn active" onclick="showAdminTab('passwords')">ÂØÜÁ†ÅÁÆ°ÁêÜ</button>
                    <button class="tab-btn" onclick="showAdminTab('generator')">ÁîüÊàêÂØÜÁ†Å</button>
                    <button class="tab-btn" onclick="showAdminTab('batch')">ÊâπÈáèÁîüÊàê</button>
                    <button class="tab-btn" onclick="showAdminTab('categories')">ÂàÜÁªÑÁÆ°ÁêÜ</button>
                    <button class="tab-btn" onclick="showAdminTab('monitoring')">ÁõëÊéßÂëäË≠¶</button>
                    <button class="tab-btn" onclick="showAdminTab('statistics')">‰ΩøÁî®ÁªüËÆ°</button>
                    <button class="tab-btn" onclick="showAdminTab('export')">Êï∞ÊçÆÂØºÂá∫</button>
                </div>
                
                <!-- ÂØÜÁ†ÅÁÆ°ÁêÜÊ†áÁ≠æÈ°µ -->
                <div id="adminTabPasswords" class="admin-tab-content">
                    <h3>‰∏¥Êó∂ÂØÜÁ†ÅÂàóË°®</h3>
                    <div id="passwordList" class="password-list">
                        <!-- Âä®ÊÄÅÁîüÊàêÁöÑÂØÜÁ†ÅÂàóË°® -->
                    </div>
                </div>
                
                <!-- ÁîüÊàêÂØÜÁ†ÅÊ†áÁ≠æÈ°µ -->
                <div id="adminTabGenerator" class="admin-tab-content" style="display: none;">
                    <h3>ÁîüÊàêÊñ∞ÁöÑ‰∏¥Êó∂ÂØÜÁ†Å</h3>
                    <div class="form-group">
                        <label>ÂØÜÁ†ÅÂÜÖÂÆπÔºö</label>
                        <input type="text" id="newPasswordText" placeholder="ÁïôÁ©∫Ëá™Âä®ÁîüÊàê" />
                    </div>
                    <div class="form-group">
                        <label>ÂØÜÁ†ÅÊèèËø∞Ôºö</label>
                        <input type="text" id="newPasswordDesc" placeholder="Â¶ÇÔºöVIPÁî®Êà∑„ÄÅÊºîÁ§∫Ë¥¶Êà∑Á≠â" />
                    </div>
                    <div class="form-group">
                        <label>ÊúâÊïàÊúüÔºö</label>
                        <select id="newPasswordExpiry" onchange="toggleCustomExpiry('newPasswordExpiry', 'customExpiryGroup')">
                            <option value="1">1Â§©</option>
                            <option value="3">3Â§©</option>
                            <option value="7">7Â§©</option>
                            <option value="15">15Â§©</option>
                            <option value="30" selected>30Â§©</option>
                            <option value="60">2‰∏™Êúà</option>
                            <option value="90">3‰∏™Êúà</option>
                            <option value="180">6‰∏™Êúà</option>
                            <option value="365">1Âπ¥</option>
                            <option value="730">2Âπ¥</option>
                            <option value="custom">Ëá™ÂÆö‰πâÂ§©Êï∞</option>
                        </select>
                    </div>
                    <div class="form-group" id="customExpiryGroup" style="display: none;">
                        <label>Ëá™ÂÆö‰πâÂ§©Êï∞Ôºö</label>
                        <input type="number" id="customExpiryDays" min="1" max="3650" placeholder="ËæìÂÖ•Â§©Êï∞" />
                    </div>
                    <div class="form-group">
                        <label>ÊúÄÂ§ß‰ΩøÁî®Ê¨°Êï∞Ôºö</label>
                        <input type="number" id="newPasswordMaxUsage" value="100" min="1" max="10000" />
                    </div>
                    <div class="form-group">
                        <label>ÂØÜÁ†ÅÂàÜÁ±ªÔºö</label>
                        <select id="newPasswordCategory">
                            <option value="default">ÈªòËÆ§ÂàÜÁ±ª</option>
                            <option value="premium">È´òÁ∫ßÁî®Êà∑</option>
                            <option value="trial">ËØïÁî®Ë¥¶Êà∑</option>
                            <option value="internal">ÂÜÖÈÉ®ÊµãËØï</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ê†áÁ≠æÔºàÂ§ö‰∏™Áî®ÈÄóÂè∑ÂàÜÈöîÔºâÔºö</label>
                        <input type="text" id="newPasswordTags" placeholder="Â¶ÇÔºöÈáçË¶Å,‰∏¥Êó∂,ÊµãËØï" />
                    </div>
                    <button onclick="generateNewPassword()" class="admin-btn">ÁîüÊàêÂØÜÁ†Å</button>
                </div>
                
                <!-- ÊâπÈáèÁîüÊàêÊ†áÁ≠æÈ°µ -->
                <div id="adminTabBatch" class="admin-tab-content" style="display: none;">
                    <h3>ÊâπÈáèÁîüÊàê‰∏¥Êó∂ÂØÜÁ†Å</h3>
                    <div class="form-group">
                        <label>ÁîüÊàêÊï∞ÈáèÔºö</label>
                        <input type="number" id="batchCount" value="5" min="1" max="50" />
                    </div>
                    <div class="form-group">
                        <label>ÂØÜÁ†ÅÂâçÁºÄÔºö</label>
                        <input type="text" id="batchPrefix" placeholder="Â¶ÇÔºöuser„ÄÅvip„ÄÅdemoÁ≠â" maxlength="10" />
                    </div>
                    <div class="form-group">
                        <label>ÂØÜÁ†ÅÈïøÂ∫¶Ôºö</label>
                        <select id="batchLength">
                            <option value="6">6‰Ωç</option>
                            <option value="8" selected>8‰Ωç</option>
                            <option value="10">10‰Ωç</option>
                            <option value="12">12‰Ωç</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Áªü‰∏ÄÊèèËø∞Ôºö</label>
                        <input type="text" id="batchDesc" placeholder="Â¶ÇÔºöÊâπÈáèÁîüÊàêÁöÑÁî®Êà∑ÂØÜÁ†Å" />
                    </div>
                    <div class="form-group">
                        <label>ÂØÜÁ†ÅÂàÜÁªÑÔºö</label>
                        <select id="batchCategory" onchange="toggleCustomCategory('batchCategory', 'customCategoryGroup')">
                            <option value="default">ÈªòËÆ§ÂàÜÁªÑ</option>
                            <option value="premium">È´òÁ∫ßÁî®Êà∑</option>
                            <option value="trial">ËØïÁî®Ë¥¶Êà∑</option>
                            <option value="internal">ÂÜÖÈÉ®ÊµãËØï</option>
                            <option value="custom">Ëá™ÂÆö‰πâÂàÜÁªÑ</option>
                        </select>
                    </div>
                    <div class="form-group" id="customCategoryGroup" style="display: none;">
                        <label>Ëá™ÂÆö‰πâÂàÜÁªÑÂêçÔºö</label>
                        <input type="text" id="customCategoryName" placeholder="ËæìÂÖ•ÂàÜÁªÑÂêçÁß∞" maxlength="20" />
                    </div>
                    <div class="form-group">
                        <label>Ê†áÁ≠æÔºàÂ§ö‰∏™Áî®ÈÄóÂè∑ÂàÜÈöîÔºâÔºö</label>
                        <input type="text" id="batchTags" placeholder="Â¶ÇÔºöÈáçË¶Å,Á¥ßÊÄ•,ÈôêÊó∂" />
                    </div>
                    <div class="form-group">
                        <label>ÊúâÊïàÊúüÔºö</label>
                        <select id="batchExpiry" onchange="toggleCustomExpiry('batchExpiry', 'batchCustomExpiryGroup')">
                            <option value="1">1Â§©</option>
                            <option value="3">3Â§©</option>
                            <option value="7">7Â§©</option>
                            <option value="15">15Â§©</option>
                            <option value="30" selected>30Â§©</option>
                            <option value="60">2‰∏™Êúà</option>
                            <option value="90">3‰∏™Êúà</option>
                            <option value="180">6‰∏™Êúà</option>
                            <option value="365">1Âπ¥</option>
                            <option value="730">2Âπ¥</option>
                            <option value="custom">Ëá™ÂÆö‰πâÂ§©Êï∞</option>
                        </select>
                    </div>
                    <div class="form-group" id="batchCustomExpiryGroup" style="display: none;">
                        <label>Ëá™ÂÆö‰πâÂ§©Êï∞Ôºö</label>
                        <input type="number" id="batchCustomExpiryDays" min="1" max="3650" placeholder="ËæìÂÖ•Â§©Êï∞" />
                    </div>
                    <div class="form-group">
                        <label>ÊØè‰∏™ÂØÜÁ†ÅÊúÄÂ§ß‰ΩøÁî®Ê¨°Êï∞Ôºö</label>
                        <input type="number" id="batchMaxUsage" value="50" min="1" max="1000" />
                    </div>
                    <button onclick="batchGeneratePasswords()" class="admin-btn">ÊâπÈáèÁîüÊàê</button>
                    
                    <div id="batchResult" class="batch-result" style="display: none;">
                        <h4>ÁîüÊàêÁªìÊûúÔºö</h4>
                        <div id="batchResultList" class="batch-result-list"></div>
                        <button onclick="copyBatchResult()" class="admin-btn" style="margin-top: 15px;">Â§çÂà∂ÊâÄÊúâÂØÜÁ†Å</button>
                    </div>
                </div>
                
                <!-- ÂàÜÁªÑÁÆ°ÁêÜÊ†áÁ≠æÈ°µ -->
                <div id="adminTabCategories" class="admin-tab-content" style="display: none;">
                    <h3>ÂØÜÁ†ÅÂàÜÁªÑÁÆ°ÁêÜ</h3>
                    
                    <!-- Ê∑ªÂä†Êñ∞ÂàÜÁ±ªË°®Âçï -->
                    <div class="category-form">
                        <h4>Ê∑ªÂä†Êñ∞ÂàÜÁ±ª</h4>
                        <div class="form-group">
                            <label>ÂàÜÁ±ªÂêçÁß∞Ôºö</label>
                            <input type="text" id="categoryName" placeholder="ËæìÂÖ•ÂàÜÁ±ªÂêçÁß∞" maxlength="20" />
                        </div>
                        <div class="form-group">
                            <label>ÂàÜÁ±ªÊèèËø∞Ôºö</label>
                            <input type="text" id="categoryDesc" placeholder="ÂàÜÁ±ªËØ¥ÊòéÔºàÂèØÈÄâÔºâ" maxlength="50" />
                        </div>
                        <div class="form-group">
                            <label>ÂàÜÁ±ªÈ¢úËâ≤Ôºö</label>
                            <input type="color" id="categoryColor" value="#4CAF50" />
                        </div>
                        <button onclick="addCategory()" class="admin-btn">Ê∑ªÂä†ÂàÜÁ±ª</button>
                    </div>
                    
                    <!-- ÂàÜÁ±ªÂàóË°® -->
                    <div class="category-management">
                        <h4>Áé∞ÊúâÂàÜÁ±ª</h4>
                        <div id="categoryList" class="category-list">
                            <!-- Âä®ÊÄÅÁîüÊàêÂàÜÁ±ªÂàóË°® -->
                        </div>
                    </div>
                    
                    <!-- Á≠õÈÄâÊéßÂà∂ -->
                    <div class="filter-controls">
                        <label>ÊåâÂàÜÁªÑÁ≠õÈÄâÔºö</label>
                        <select id="categoryFilter" class="filter-select" onchange="filterPasswords()">
                            <option value="">ÊâÄÊúâÂàÜÁ±ª</option>
                        </select>
                        <label>ÊåâÊ†áÁ≠æÁ≠õÈÄâÔºö</label>
                        <input type="text" id="tagFilter" class="filter-select" placeholder="ËæìÂÖ•Ê†áÁ≠æ" onchange="filterPasswords()" />
                        <button onclick="refreshCategoryManagement()" class="admin-btn btn-secondary">Âà∑Êñ∞</button>
                    </div>
                    
                    <!-- ÂàÜÁªÑÂØÜÁ†ÅÂàóË°® -->
                    <div id="categoryPasswordsList" class="password-list">
                        <!-- Âä®ÊÄÅÁîüÊàêÂàÜÁªÑÂØÜÁ†ÅÂàóË°® -->
                    </div>
                </div>
                
                <!-- ÁõëÊéßÂëäË≠¶Ê†áÁ≠æÈ°µ -->
                <div id="adminTabMonitoring" class="admin-tab-content" style="display: none;">
                    <h3>‰ΩøÁî®ÁõëÊéß‰∏éÂëäË≠¶</h3>
                    
                    <!-- ÁõëÊéßÁªüËÆ°Ê¶ÇËßà -->
                    <div class="monitoring-stats">
                        <div class="monitoring-stat">
                            <div class="monitoring-stat-value" id="expiringPasswords">0</div>
                            <div class="monitoring-stat-label">Âç≥Â∞ÜËøáÊúüÂØÜÁ†Å</div>
                        </div>
                        <div class="monitoring-stat">
                            <div class="monitoring-stat-value" id="overusedPasswords">0</div>
                            <div class="monitoring-stat-label">‰ΩøÁî®ÁéáËøáÈ´ò</div>
                        </div>
                        <div class="monitoring-stat">
                            <div class="monitoring-stat-value" id="failedLogins">0</div>
                            <div class="monitoring-stat-label">ÁôªÂΩïÂ§±Ë¥•Ê¨°Êï∞</div>
                        </div>
                        <div class="monitoring-stat">
                            <div class="monitoring-stat-value" id="activeAlerts">0</div>
                            <div class="monitoring-stat-label">Ê¥ªË∑ÉÂëäË≠¶</div>
                        </div>
                    </div>
                    
                    <!-- ÁõëÊéßËÆæÁΩÆ -->
                    <div class="monitoring-card">
                        <h4>üìã ÁõëÊéßËÆæÁΩÆ</h4>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="enableNotifications" checked onchange="updateMonitoringSettings()">
                                ÂêØÁî®ÊµèËßàÂô®ÈÄöÁü•
                            </label>
                        </div>
                        <div class="form-group">
                            <label>ËøáÊúüÈ¢ÑË≠¶Â§©Êï∞Ôºö</label>
                            <input type="number" id="expiryWarningDays" value="7" min="1" max="30" onchange="updateMonitoringSettings()">
                        </div>
                        <div class="form-group">
                            <label>‰ΩøÁî®ÁéáÈ¢ÑË≠¶ÈòàÂÄºÔºö</label>
                            <input type="range" id="usageWarningPercent" min="50" max="95" value="80" oninput="updateThresholdDisplay()" onchange="updateMonitoringSettings()">
                            <span id="thresholdDisplay">80%</span>
                        </div>
                        <div class="form-group">
                            <label>ÁõëÊéßÊ£ÄÊü•Èó¥ÈöîÔºàÁßíÔºâÔºö</label>
                            <input type="number" id="monitoringInterval" value="300" min="60" max="3600" onchange="updateMonitoringSettings()">
                        </div>
                    </div>
                    
                    <!-- ÂëäË≠¶ÂàóË°® -->
                    <div class="monitoring-card">
                        <h4>üö® ÊúÄËøëÂëäË≠¶</h4>
                        <div id="alertsList" class="alerts-list">
                            <!-- Âä®ÊÄÅÁîüÊàêÂëäË≠¶‰ø°ÊÅØ -->
                        </div>
                    </div>
                </div>
                
                <!-- ‰ΩøÁî®ÁªüËÆ°Ê†áÁ≠æÈ°µ -->
                <div id="adminTabStatistics" class="admin-tab-content" style="display: none;">
                    <h3>ÂØÜÁ†Å‰ΩøÁî®ÁªüËÆ°</h3>
                    <div id="statisticsList" class="statistics-list">
                        <!-- Âä®ÊÄÅÁîüÊàêÁöÑÁªüËÆ°‰ø°ÊÅØ -->
                    </div>
                </div>
                
                <!-- Êï∞ÊçÆÂØºÂá∫Ê†áÁ≠æÈ°µ -->
                <div id="adminTabExport" class="admin-tab-content" style="display: none;">
                    <h3>Êï∞ÊçÆÂØºÂá∫‰∏éÂ§á‰ªΩ</h3>
                    
                    <div class="export-section">
                        <h4>üìã ÂØÜÁ†ÅÊï∞ÊçÆÂØºÂá∫</h4>
                        <p class="export-desc">ÂØºÂá∫ÊâÄÊúâ‰∏¥Êó∂ÂØÜÁ†Å‰ø°ÊÅØ‰∏∫CSVÊ†ºÂºèÔºå‰æø‰∫éÂ§ñÈÉ®ÂàÜÊûêÊàñÂ§á‰ªΩ„ÄÇ</p>
                        <button onclick="exportPasswordsCSV()" class="admin-btn">ÂØºÂá∫ÂØÜÁ†ÅÂàóË°® (CSV)</button>
                    </div>
                    
                    <div class="export-section">
                        <h4>üìä ‰ΩøÁî®ÁªüËÆ°Êä•Ë°®</h4>
                        <p class="export-desc">ÁîüÊàêËØ¶ÁªÜÁöÑ‰ΩøÁî®ÁªüËÆ°Êä•Ë°®ÔºåÂåÖÂê´Áî®Êà∑Ê¥ªÂä®ÂíåÁ≥ªÁªü‰ΩøÁî®ÊÉÖÂÜµ„ÄÇ</p>
                        <button onclick="exportUsageReport()" class="admin-btn">ÂØºÂá∫‰ΩøÁî®Êä•Ë°® (CSV)</button>
                    </div>
                    
                    <div class="export-section">
                        <h4>üíæ Á≥ªÁªüÂ§á‰ªΩ</h4>
                        <p class="export-desc">ÂÆåÊï¥Â§á‰ªΩÁ≥ªÁªüÈÖçÁΩÆÂíåÊï∞ÊçÆÔºåÁî®‰∫éÁÅæÈöæÊÅ¢Â§çÊàñÊï∞ÊçÆËøÅÁßª„ÄÇ</p>
                        <button onclick="exportSystemBackup()" class="admin-btn">ÂàõÂª∫Á≥ªÁªüÂ§á‰ªΩ (JSON)</button>
                        <button onclick="importSystemBackup()" class="admin-btn btn-secondary">ÊÅ¢Â§çÁ≥ªÁªüÂ§á‰ªΩ</button>
                        <input type="file" id="backupFile" accept=".json" style="display: none;" onchange="handleBackupImport(event)">
                    </div>
                    
                    <div class="export-section">
                        <h4>üóÇÔ∏è Êìç‰ΩúÊó•Âøó</h4>
                        <p class="export-desc">ÂØºÂá∫Á≥ªÁªüÊìç‰ΩúÊó•ÂøóÔºåÁî®‰∫éÂÆ°ËÆ°ÂíåÂÆâÂÖ®ÂàÜÊûê„ÄÇ</p>
                        <button onclick="exportOperationLogs()" class="admin-btn">ÂØºÂá∫Êìç‰ΩúÊó•Âøó (CSV)</button>
                        <button onclick="clearOperationLogs()" class="admin-btn btn-warning">Ê∏ÖÁ©∫Êó•Âøó</button>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- Êï∞ÊçÆÂàÜÊûê‰ª™Ë°®Êùø -->
    <div id="analyticsDashboard" class="analytics-dashboard">
        <div class="analytics-content">
            <div class="analytics-header">
                <h2 class="analytics-title">üìä Êï∞ÊçÆÂàÜÊûê‰ª™Ë°®Êùø</h2>
                <button onclick="closeAnalytics()" class="analytics-close">ÂÖ≥Èó≠</button>
            </div>
            
            <div class="analytics-grid">
                <div class="analytics-card">
                    <h3>üìà ÊÄª‰ΩìÁªüËÆ°</h3>
                    <div class="stats-number" id="totalConversions">0</div>
                    <div class="stats-label">ÊÄªËΩ¨Êç¢Ê¨°Êï∞</div>
                </div>
                
                <div class="analytics-card">
                    <h3>üë• Ê¥ªË∑ÉÁî®Êà∑</h3>
                    <div class="stats-number" id="activeUsers">0</div>
                    <div class="stats-label">Ê¥ªË∑ÉÂØÜÁ†ÅÊï∞Èáè</div>
                </div>
                
                <div class="analytics-card">
                    <h3>‚è±Ô∏è Âπ≥Âùá‰ΩøÁî®Êó∂Èïø</h3>
                    <div class="stats-number" id="avgSessionTime">0</div>
                    <div class="stats-label">ÂàÜÈíü</div>
                </div>
                
                <div class="analytics-card">
                    <h3>üîÑ ‰ªäÊó•Ê¥ªÂä®</h3>
                    <div class="stats-number" id="todayActivity">0</div>
                    <div class="stats-label">Ê¨°Êìç‰Ωú</div>
                </div>
            </div>
            
            <div class="analytics-card">
                <h3>üìä ‰ΩøÁî®Ë∂ãÂäøÂõæ</h3>
                <div class="chart-container">
                    <canvas id="usageChart"></canvas>
                </div>
            </div>
            
            <div class="analytics-card">
                <h3>üïê Êó∂Èó¥ÂàÜÂ∏ÉÂõæ</h3>
                <div class="chart-container">
                    <canvas id="timeChart"></canvas>
                </div>
            </div>
            
            <div class="analytics-card">
                <h3>üìã ÊúÄËøëÊìç‰ΩúËÆ∞ÂΩï</h3>
                <div style="max-height: 300px; overflow-y: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Êó∂Èó¥</th>
                                <th>Êìç‰ΩúÁ±ªÂûã</th>
                                <th>Áî®Êà∑</th>
                                <th>ËØ¶ÊÉÖ</th>
                            </tr>
                        </thead>
                        <tbody id="recentOperations">
                            <!-- Âä®ÊÄÅÁîüÊàêÊìç‰ΩúËÆ∞ÂΩï -->
                        </tbody>
                    </table>
                </div>
                <div style="margin-top: 15px;">
                    <button onclick="exportAnalyticsData()" class="btn">ÂØºÂá∫ÂàÜÊûêÊï∞ÊçÆ</button>
                    <button onclick="refreshAnalytics()" class="btn btn-secondary">Âà∑Êñ∞Êï∞ÊçÆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Âø´Êç∑ÈîÆÊèêÁ§∫ -->
    <div id="shortcutHint" class="shortcut-hint" style="display: none;">
        <strong>‚å®Ô∏è Âø´Êç∑ÈîÆ</strong><br>
        Ctrl+T - ÂàáÊç¢‰∏ªÈ¢ò<br>
        F12 - Êï∞ÊçÆÂàÜÊûê<br>
        Esc - ÂÖ≥Èó≠Èù¢Êùø
    </div>

    <!-- Á¥ßÊÄ•ÈáçÁΩÆÊåâÈíÆ -->
    <div style="position: fixed; bottom: 10px; right: 10px; z-index: 99999;">
        <button onclick="emergencyReset()" style="background: #e74c3c; color: white; border: none; padding: 8px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;">
            Á¥ßÊÄ•ÈáçÁΩÆ
        </button>
    </div>


    <script>
        // ========== ÂÖ®Â±ÄÂáΩÊï∞ÂÆö‰πâÔºàÈ°µÈù¢Âä†ËΩΩÊó∂Á´ãÂç≥ÂèØÁî®Ôºâ ==========
        
        // ÂØÜÁ†ÅÈ™åËØÅÂáΩÊï∞
        window.verifyPassword = function() {
            console.log('verifyPassword Ë¢´Ë∞ÉÁî®');
            
            const passwordInput = document.getElementById('passwordInput');
            const passwordError = document.getElementById('passwordError');
            
            if (!passwordInput) {
                console.error('Êâæ‰∏çÂà∞ÂØÜÁ†ÅËæìÂÖ•Ê°Ü');
                return;
            }
            
            const password = passwordInput.value.trim();
            console.log('ËæìÂÖ•ÁöÑÂØÜÁ†Å:', password);
            
            // ÁÆÄÂçïÂØÜÁ†ÅÈ™åËØÅ
            if (password === 'lingling' || password === '517517' || password === 'demo2024') {
                console.log('ÂØÜÁ†ÅÈ™åËØÅÊàêÂäü');
                
                // ÈöêËóèÈ™åËØÅÁïåÈù¢
                const overlay = document.getElementById('passwordOverlay');
                const mainApp = document.getElementById('mainApp');
                
                console.log('overlay element:', overlay);
                console.log('mainApp element:', mainApp);
                
                if (overlay) {
                    overlay.style.display = 'none';
                    console.log('ÂØÜÁ†ÅÁïåÈù¢Â∑≤ÈöêËóè');
                }
                if (mainApp) {
                    mainApp.classList.add('authenticated');
                    console.log('‰∏ªÂ∫îÁî®ÁïåÈù¢Â∑≤ÊòæÁ§∫');
                }
                
                // ‰øùÂ≠òÁä∂ÊÄÅ
                sessionStorage.setItem('authenticated', 'true');
                console.log('ÁôªÂΩïÁä∂ÊÄÅÂ∑≤‰øùÂ≠ò');
                
                return;
            }
            
            // ÂØÜÁ†ÅÈîôËØØ
            console.log('ÂØÜÁ†ÅÈîôËØØ');
            if (passwordError) {
                passwordError.textContent = 'ÂØÜÁ†ÅÈîôËØØÔºåËØ∑ÈáçËØï';
                passwordError.style.display = 'block';
            }
            
            if (passwordInput) {
                passwordInput.value = '';
                passwordInput.focus();
            }
            
            setTimeout(() => {
                if (passwordError) passwordError.style.display = 'none';
            }, 3000);
        };
        
        // Á°Æ‰øùÂáΩÊï∞Âú®ÂÖ®Â±Ä‰ΩúÁî®Âüü
        console.log('verifyPassword ÂáΩÊï∞Â∑≤ÂÆö‰πâ:', typeof window.verifyPassword);

        // ÂØÜÁ†ÅÈ™åËØÅÂäüËÉΩ - ÂçáÁ∫ßÁâà
        const passwordConfig = {
            // Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†ÅÔºàÊ∞∏‰πÖÊúâÊïàÔºâ
            superAdmin: {
                password: 'lingling',
                type: 'super_admin',
                permanent: true,
                permissions: ['admin', 'convert', 'manage'],
                createdAt: new Date().toISOString()
            },
            // ‰∏¥Êó∂ÂØÜÁ†ÅÂ≠òÂÇ®
            tempPasswords: JSON.parse(localStorage.getItem('temp_passwords') || '{}'),
            // ÂØÜÁ†Å‰ΩøÁî®ÁªüËÆ°
            usageStats: JSON.parse(localStorage.getItem('password_usage') || '{}'),
            // Êìç‰ΩúÊó•Âøó
            operationLogs: JSON.parse(localStorage.getItem('operation_logs') || '[]')
        };

        // ÂàùÂßãÂåñ‰∏Ä‰∫õÁ§∫‰æã‰∏¥Êó∂ÂØÜÁ†Å
        function initDefaultTempPasswords() {
            const now = new Date();
            const oneWeekLater = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);
            const oneMonthLater = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000);
            
            console.log('ÂàùÂßãÂåñ‰∏¥Êó∂ÂØÜÁ†Å...');
            console.log('ÂΩìÂâç‰∏¥Êó∂ÂØÜÁ†ÅÊï∞Èáè:', Object.keys(passwordConfig.tempPasswords).length);
            
            // Âº∫Âà∂ÈáçÊñ∞ÂàùÂßãÂåñÔºàÁî®‰∫é‰øÆÂ§çÂØÜÁ†ÅÈóÆÈ¢òÔºâ
            const shouldReinit = Object.keys(passwordConfig.tempPasswords).length === 0 || !passwordConfig.tempPasswords['517517'];
            
            if (shouldReinit) {
                console.log('ÂàõÂª∫ÈªòËÆ§‰∏¥Êó∂ÂØÜÁ†Å...');
                passwordConfig.tempPasswords = {
                    '517517': {
                        password: '517517',
                        type: 'temp_user',
                        expiresAt: oneMonthLater.toISOString(),
                        permissions: ['convert'],
                        usageCount: 0,
                        maxUsage: 50,
                        createdAt: now.toISOString(),
                        createdBy: 'system',
                        description: 'È´òÁ∫ß‰∏¥Êó∂Ë¥¶Êà∑'
                    },
                    'demo2024': {
                        password: 'demo2024',
                        type: 'temp_user', 
                        expiresAt: oneWeekLater.toISOString(),
                        permissions: ['convert'],
                        usageCount: 0,
                        maxUsage: 30,
                        createdAt: now.toISOString(),
                        createdBy: 'system',
                        description: 'ÊºîÁ§∫Ë¥¶Êà∑'
                    }
                };
                saveTempPasswords();
                console.log('ÈªòËÆ§ÂØÜÁ†ÅÂ∑≤ÂàõÂª∫:', Object.keys(passwordConfig.tempPasswords));
            } else {
                console.log('Â∑≤Â≠òÂú®‰∏¥Êó∂ÂØÜÁ†Å:', Object.keys(passwordConfig.tempPasswords));
            }
        }

        // ‰øùÂ≠ò‰∏¥Êó∂ÂØÜÁ†ÅÂà∞localStorage
        function saveTempPasswords() {
            localStorage.setItem('temp_passwords', JSON.stringify(passwordConfig.tempPasswords));
        }

        // ‰øùÂ≠ò‰ΩøÁî®ÁªüËÆ°
        function saveUsageStats() {
            localStorage.setItem('password_usage', JSON.stringify(passwordConfig.usageStats));
        }

        // ‰øùÂ≠òÊìç‰ΩúÊó•Âøó
        function saveOperationLogs() {
            localStorage.setItem('operation_logs', JSON.stringify(passwordConfig.operationLogs));
        }

        // ËÆ∞ÂΩïÊìç‰ΩúÊó•Âøó
        function logOperation(action, details = {}) {
            const userInfo = JSON.parse(sessionStorage.getItem('user_info') || '{}');
            const currentPassword = sessionStorage.getItem('current_password');
            
            const logEntry = {
                timestamp: new Date().toISOString(),
                action: action,
                user: userInfo.type === 'super_admin' ? 'Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëò' : `‰∏¥Êó∂Áî®Êà∑(${currentPassword})`,
                userType: userInfo.type,
                details: details,
                userAgent: navigator.userAgent.substring(0, 100),
                ip: 'N/A' // ÂâçÁ´ØÊó†Ê≥ïËé∑ÂèñÁúüÂÆûIP
            };
            
            passwordConfig.operationLogs.push(logEntry);
            
            // Âè™‰øùÁïôÊúÄËøë1000Êù°Êó•Âøó
            if (passwordConfig.operationLogs.length > 1000) {
                passwordConfig.operationLogs = passwordConfig.operationLogs.slice(-1000);
            }
            
            saveOperationLogs();
        }

        // ÈáçÁΩÆÂØÜÁ†ÅÊï∞ÊçÆÔºàË∞ÉËØïÂäüËÉΩÔºâ
        function resetPasswordData() {
            if (confirm('Á°ÆËÆ§ÈáçÁΩÆÊâÄÊúâÂØÜÁ†ÅÊï∞ÊçÆÔºüËøôÂ∞ÜÊ∏ÖÈô§ÊâÄÊúâ‰∏¥Êó∂ÂØÜÁ†ÅÂíå‰ΩøÁî®ÁªüËÆ°„ÄÇ')) {
                logOperation('system_reset', { reason: 'debug_reset' });
                localStorage.removeItem('temp_passwords');
                localStorage.removeItem('password_usage');
                localStorage.removeItem('operation_logs');
                passwordConfig.tempPasswords = {};
                passwordConfig.usageStats = {};
                passwordConfig.operationLogs = [];
                console.log('ÂØÜÁ†ÅÊï∞ÊçÆÂ∑≤ÈáçÁΩÆ');
                alert('ÂØÜÁ†ÅÊï∞ÊçÆÂ∑≤ÈáçÁΩÆÔºåÈ°µÈù¢Â∞ÜÂà∑Êñ∞');
                location.reload();
            }
        }
        
        // Ê£ÄÊü•ÂØÜÁ†ÅÊòØÂê¶ÊúâÊïà
        function validatePassword(password) {
            const now = new Date();
            
            console.log('È™åËØÅÂØÜÁ†Å:', password);
            console.log('Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†Å:', passwordConfig.superAdmin.password);
            console.log('ÂèØÁî®‰∏¥Êó∂ÂØÜÁ†Å:', Object.keys(passwordConfig.tempPasswords));
            
            // Ê£ÄÊü•Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†Å
            if (password === passwordConfig.superAdmin.password) {
                console.log('Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†ÅÈ™åËØÅÊàêÂäü');
                return {
                    valid: true,
                    userInfo: passwordConfig.superAdmin,
                    message: 'Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÁôªÂΩïÊàêÂäü'
                };
            }
            
            // Ê£ÄÊü•‰∏¥Êó∂ÂØÜÁ†Å
            const tempPassword = passwordConfig.tempPasswords[password];
            console.log('‰∏¥Êó∂ÂØÜÁ†ÅÈÖçÁΩÆ:', tempPassword);
            
            if (tempPassword) {
                // Ê£ÄÊü•ÂØÜÁ†ÅÊòØÂê¶ËøáÊúü
                const expiresAt = new Date(tempPassword.expiresAt);
                console.log('ËøáÊúüÊó∂Èó¥:', expiresAt, 'ÂΩìÂâçÊó∂Èó¥:', now);
                
                if (now > expiresAt) {
                    console.log('ÂØÜÁ†ÅÂ∑≤ËøáÊúü');
                    return {
                        valid: false,
                        error: 'expired',
                        message: 'ÂØÜÁ†ÅÂ∑≤ËøáÊúüÔºåËØ∑ËÅîÁ≥ªÁÆ°ÁêÜÂëòËé∑ÂèñÊñ∞ÂØÜÁ†Å'
                    };
                }
                
                // Ê£ÄÊü•‰ΩøÁî®Ê¨°Êï∞ÊòØÂê¶Ë∂ÖÈôê
                console.log('‰ΩøÁî®Ê¨°Êï∞:', tempPassword.usageCount, 'ÊúÄÂ§ßÊ¨°Êï∞:', tempPassword.maxUsage);
                if (tempPassword.usageCount >= tempPassword.maxUsage) {
                    console.log('‰ΩøÁî®Ê¨°Êï∞Ë∂ÖÈôê');
                    return {
                        valid: false,
                        error: 'usage_exceeded',
                        message: 'ÂØÜÁ†Å‰ΩøÁî®Ê¨°Êï∞Â∑≤Ëææ‰∏äÈôêÔºåËØ∑ËÅîÁ≥ªÁÆ°ÁêÜÂëò'
                    };
                }
                
                console.log('‰∏¥Êó∂ÂØÜÁ†ÅÈ™åËØÅÊàêÂäü');
                return {
                    valid: true,
                    userInfo: tempPassword,
                    message: `Ê¨¢Ëøé‰ΩøÁî®ÔºÅÂâ©‰Ωô‰ΩøÁî®Ê¨°Êï∞Ôºö${tempPassword.maxUsage - tempPassword.usageCount}`
                };
            }
            
            console.log('ÂØÜÁ†ÅÈ™åËØÅÂ§±Ë¥•');
            return {
                valid: false,
                error: 'invalid',
                message: 'ÂØÜÁ†ÅÈîôËØØÔºåËØ∑ÈáçËØï'
            };
        }

        // ËÆ∞ÂΩïÂØÜÁ†Å‰ΩøÁî®
        function recordPasswordUsage(password, userInfo) {
            const now = new Date().toISOString();
            
            // Êõ¥Êñ∞‰ΩøÁî®Ê¨°Êï∞Ôºà‰ªÖÂØπ‰∏¥Êó∂ÂØÜÁ†ÅÔºâ
            if (userInfo.type === 'temp_user') {
                passwordConfig.tempPasswords[password].usageCount++;
                saveTempPasswords();
            }
            
            // ËÆ∞ÂΩï‰ΩøÁî®ÁªüËÆ°
            if (!passwordConfig.usageStats[password]) {
                passwordConfig.usageStats[password] = {
                    totalUsage: 0,
                    lastUsed: null,
                    sessions: []
                };
            }
            
            passwordConfig.usageStats[password].totalUsage++;
            passwordConfig.usageStats[password].lastUsed = now;
            passwordConfig.usageStats[password].sessions.push({
                timestamp: now,
                userAgent: navigator.userAgent.substring(0, 100)
            });
            
            // Âè™‰øùÁïôÊúÄËøë50Ê¨°‰ºöËØùËÆ∞ÂΩï
            if (passwordConfig.usageStats[password].sessions.length > 50) {
                passwordConfig.usageStats[password].sessions = 
                    passwordConfig.usageStats[password].sessions.slice(-50);
            }
            
            saveUsageStats();
        }

        
        // ‰ºöËØùÁÆ°ÁêÜ
        const SESSION_TIMEOUT = 30 * 60 * 1000; // 30ÂàÜÈíü
        let sessionTimer = null;
        let lastActivity = Date.now();

        // ÈáçÁΩÆ‰ºöËØùËÆ°Êó∂Âô®
        function resetSessionTimer() {
            lastActivity = Date.now();
            sessionStorage.setItem('last_activity', lastActivity.toString());
            
            if (sessionTimer) {
                clearTimeout(sessionTimer);
            }
            
            sessionTimer = setTimeout(() => {
                logoutUser('session_timeout');
            }, SESSION_TIMEOUT);
        }

        // Áî®Êà∑ÁôªÂá∫
        function logoutUser(reason = 'manual') {
            logOperation('user_logout', { reason: reason });
            
            sessionStorage.removeItem('authenticated');
            sessionStorage.removeItem('user_info');
            sessionStorage.removeItem('current_password');
            sessionStorage.removeItem('last_activity');
            
            if (sessionTimer) {
                clearTimeout(sessionTimer);
                sessionTimer = null;
            }
            
            // ÊòæÁ§∫ÁôªÂΩïÁïåÈù¢
            document.getElementById('passwordOverlay').style.display = 'flex';
            document.getElementById('mainApp').classList.remove('authenticated');
            
            // ÂÖ≥Èó≠ÁÆ°ÁêÜÈù¢Êùø
            document.getElementById('adminPanel').style.display = 'none';
            
            if (reason === 'session_timeout') {
                showStatus('‰ºöËØùÂ∑≤Ë∂ÖÊó∂ÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï', 'error');
            } else {
                showStatus('Â∑≤ÂÆâÂÖ®ÈÄÄÂá∫', 'info');
            }
            
            // ËÅöÁÑ¶Âà∞ÂØÜÁ†ÅËæìÂÖ•Ê°Ü
            setTimeout(() => {
                document.getElementById('passwordInput').focus();
            }, 100);
        }

        // Ê£ÄÊü•‰ºöËØùÊòØÂê¶ËøáÊúü
        function checkSessionTimeout() {
            const lastActivityStr = sessionStorage.getItem('last_activity');
            if (lastActivityStr) {
                const lastActivityTime = parseInt(lastActivityStr);
                const now = Date.now();
                
                if (now - lastActivityTime > SESSION_TIMEOUT) {
                    logoutUser('session_timeout');
                    return false;
                }
            }
            return true;
        }

        // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÈ™åËØÅËøá
        function checkAuthentication() {
            // ÂàùÂßãÂåñÈªòËÆ§‰∏¥Êó∂ÂØÜÁ†Å
            initDefaultTempPasswords();
            
            if (sessionStorage.getItem('authenticated') === 'true') {
                // Ê£ÄÊü•‰ºöËØùÊòØÂê¶ËøáÊúü
                if (checkSessionTimeout()) {
                    document.getElementById('passwordOverlay').style.display = 'none';
                    document.getElementById('mainApp').classList.add('authenticated');
                    resetSessionTimer();
                    initializeApp();
                } else {
                    // ‰ºöËØùÂ∑≤ËøáÊúüÔºåÊòæÁ§∫ÁôªÂΩïÁïåÈù¢
                    return;
                }
            } else {
                // ËÅöÁÑ¶Âà∞ÂØÜÁ†ÅËæìÂÖ•Ê°Ü
                setTimeout(() => {
                    document.getElementById('passwordInput').focus();
                }, 100);
            }
        }
        
        
        // ÂàùÂßãÂåñÂ∫îÁî®ÔºàÂéüÊù•ÁöÑÂàùÂßãÂåñÈÄªËæëÔºâ
        function initializeApp() {
            // Ê∏ÖÈô§ÂèØËÉΩÂØºËá¥ÂºπÁ™óÁöÑËá™Âä®‰øùÂ≠òÊï∞ÊçÆ
            localStorage.removeItem('markdown-auto-save');
            localStorage.removeItem('markdown-auto-save-timestamp');
            
            // ÂàùÂßãÂåñÊãñÊãΩÂäüËÉΩ
            initializeDragAndDrop();
            
            // Áõ¥Êé•Âä†ËΩΩÁ§∫‰æãÔºå‰∏çÊ£ÄÊü•Ëá™Âä®‰øùÂ≠òÂÜÖÂÆπÈÅøÂÖçÂºπÁ™ó
            loadExample();
            
            // Ê†πÊçÆÁî®Êà∑ÊùÉÈôêË∞ÉÊï¥ÁïåÈù¢
            adjustUIBasedOnPermissions();
            
            // ÂàùÂßãÂåñ‰∏ªÈ¢òÁ≥ªÁªü
            initializeTheme();
            
            // ÂàùÂßãÂåñÂø´Êç∑ÈîÆ
            initializeShortcuts();
            
            // ÊòæÁ§∫Âø´Êç∑ÈîÆÊèêÁ§∫
            showShortcutHint();
        }

        // Ê†πÊçÆÁî®Êà∑ÊùÉÈôêË∞ÉÊï¥ÁïåÈù¢
        function adjustUIBasedOnPermissions() {
            const userInfo = JSON.parse(sessionStorage.getItem('user_info') || '{}');
            const currentPassword = sessionStorage.getItem('current_password');
            
            // Êõ¥Êñ∞Ê†áÈ¢òÊòæÁ§∫Áî®Êà∑‰ø°ÊÅØ
            updateUserDisplay(userInfo, currentPassword);
            
            // Â¶ÇÊûúÊòØ‰∏¥Êó∂Áî®Êà∑ÔºåÂèØ‰ª•ËÄÉËôëÈöêËóèÊüê‰∫õÈ´òÁ∫ßÂäüËÉΩ
            if (userInfo.type === 'temp_user') {
                // ÊöÇÊó∂‰∏çÈôêÂà∂ÂäüËÉΩÔºå‰ΩÜ‰øùÁïôÊâ©Â±ïÊÄß
                console.log('‰∏¥Êó∂Áî®Êà∑ÁôªÂΩïÔºåÊâÄÊúâÂäüËÉΩÂèØÁî®');
            }
        }

        // Êõ¥Êñ∞Áî®Êà∑ÊòæÁ§∫‰ø°ÊÅØ
        function updateUserDisplay(userInfo, currentPassword) {
            const userStatusBar = document.getElementById('userStatusBar');
            const userStatusContent = document.getElementById('userStatusContent');
            const adminHint = document.getElementById('adminHint');
            
            if (!userStatusBar || !userStatusContent) return;
            
            let statusHTML = '';
            
            if (userInfo.type === 'super_admin') {
                statusHTML = `
                    <div class="user-status-super">üîë Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëò</div>
                    <div class="status-detail">ÂÆåÊï¥Á≥ªÁªüÊùÉÈôê ¬∑ Ê∞∏‰πÖÊúâÊïà</div>
                    <div class="theme-switcher">
                        <span>üé®</span>
                        <button class="theme-btn ${getCurrentTheme() === 'amber' || getCurrentTheme() === '' ? 'active' : ''}" onclick="switchTheme('amber')">Áê•ÁèÄ</button>
                        <button class="theme-btn ${getCurrentTheme() === 'light' ? 'active' : ''}" onclick="switchTheme('light')">ÊûÅÁÆÄ</button>
                        <button class="theme-btn ${getCurrentTheme() === 'classic' ? 'active' : ''}" onclick="switchTheme('classic')">ÁªèÂÖ∏</button>
                    </div>
                    <button onclick="openAnalytics()" class="logout-btn" style="background: linear-gradient(45deg, #2196F3, #1976D2); margin-right: 10px;" title="Êï∞ÊçÆÂàÜÊûê">üìä ÂàÜÊûê</button>
                    <button onclick="logoutUser('manual')" class="logout-btn" title="ÂÆâÂÖ®ÈÄÄÂá∫">üö™ ÈÄÄÂá∫</button>
                `;
                // ÊòæÁ§∫ÁÆ°ÁêÜÂëòÊèêÁ§∫ÂõæÊ†á
                if (adminHint) {
                    adminHint.style.display = 'inline';
                }
            } else if (userInfo.type === 'temp_user') {
                const config = passwordConfig.tempPasswords[currentPassword];
                if (config) {
                    const remainingUsage = config.maxUsage - config.usageCount;
                    const expiresAt = new Date(config.expiresAt);
                    const remainingDays = Math.ceil((expiresAt - new Date()) / (1000 * 60 * 60 * 24));
                    const description = config.description || '‰∏¥Êó∂Áî®Êà∑';
                    
                    // Âà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅË≠¶Âëä
                    const isExpiringSoon = remainingDays <= 3;
                    const isUsageRunningLow = remainingUsage <= 5;
                    
                    statusHTML = `
                        <div class="user-status-temp">üë§ ${description}</div>
                        <div class="${isUsageRunningLow ? 'status-warning' : 'status-detail'}">
                            Ââ©‰Ωô ${remainingUsage} Ê¨°‰ΩøÁî®
                        </div>
                        <div class="${isExpiringSoon ? 'status-warning' : 'status-detail'}">
                            ${remainingDays > 0 ? `${remainingDays} Â§©ÂêéÂà∞Êúü` : 'Â∑≤ËøáÊúü'}
                        </div>
                        <div class="theme-switcher">
                            <span>üé®</span>
                            <button class="theme-btn ${getCurrentTheme() === 'amber' || getCurrentTheme() === '' ? 'active' : ''}" onclick="switchTheme('amber')">Áê•ÁèÄ</button>
                            <button class="theme-btn ${getCurrentTheme() === 'light' ? 'active' : ''}" onclick="switchTheme('light')">ÊûÅÁÆÄ</button>
                            <button class="theme-btn ${getCurrentTheme() === 'classic' ? 'active' : ''}" onclick="switchTheme('classic')">ÁªèÂÖ∏</button>
                        </div>
                        <button onclick="logoutUser('manual')" class="logout-btn" title="ÂÆâÂÖ®ÈÄÄÂá∫">üö™ ÈÄÄÂá∫</button>
                    `;
                } else {
                    statusHTML = '<div class="user-status-temp">üë§ ‰∏¥Êó∂Áî®Êà∑</div>';
                }
                // ÈöêËóèÁÆ°ÁêÜÂëòÊèêÁ§∫ÂõæÊ†á
                if (adminHint) {
                    adminHint.style.display = 'none';
                }
            }
            
            userStatusContent.innerHTML = statusHTML;
            userStatusBar.style.display = 'flex';
        }

        // Ê£ÄÊü•Áî®Êà∑ÊùÉÈôê
        function checkPermission(action) {
            const userInfo = JSON.parse(sessionStorage.getItem('user_info') || '{}');
            
            if (!userInfo.permissions) return false;
            
            return userInfo.permissions.includes(action) || userInfo.permissions.includes('admin');
        }

        // ÊùÉÈôêÊéßÂà∂ÁöÑÂäüËÉΩÂåÖË£ÖÂô®
        function withPermission(action, callback, errorMessage = 'ÊÇ®Ê≤°ÊúâÊùÉÈôêÊâßË°åÊ≠§Êìç‰Ωú') {
            if (checkPermission(action)) {
                callback();
            } else {
                showStatus(errorMessage, 'error');
            }
        }

        // ========== ‰∏ªÈ¢òÁ≥ªÁªü ==========
        
        // Ëé∑ÂèñÂΩìÂâç‰∏ªÈ¢ò
        function getCurrentTheme() {
            return localStorage.getItem('theme') || 'amber';
        }

        // Â∫îÁî®‰∏ªÈ¢ò
        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            
            // ËÆ∞ÂΩï‰∏ªÈ¢òÂàáÊç¢
            logOperation('theme_change', { 
                newTheme: theme, 
                timestamp: new Date().toISOString() 
            });
        }

        // ÂàáÊç¢‰∏ªÈ¢ò
        function switchTheme(theme) {
            applyTheme(theme);
            
            // Êõ¥Êñ∞‰∏ªÈ¢òÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ËÆæÁΩÆÂΩìÂâç‰∏ªÈ¢òÊåâÈíÆ‰∏∫Ê¥ªË∑ÉÁä∂ÊÄÅ
            const currentBtn = document.querySelector(`.theme-btn[onclick="switchTheme('${theme}')"]`);
            if (currentBtn) {
                currentBtn.classList.add('active');
            }
            
            const themeNames = {
                'amber': 'Ê∏©ÊöñÁê•ÁèÄ',
                'light': 'ÊûÅÁÆÄÁôΩËâ≤',
                'classic': 'ÁªèÂÖ∏ÈÖçËâ≤'
            };
            showStatus(`Â∑≤ÂàáÊç¢Âà∞${themeNames[theme] || theme}‰∏ªÈ¢ò`, 'info');
        }

        // ÂàùÂßãÂåñ‰∏ªÈ¢ò
        function initializeTheme() {
            const savedTheme = getCurrentTheme();
            applyTheme(savedTheme);
        }

        // ========== Êï∞ÊçÆÂàÜÊûêÁ≥ªÁªü ==========
        
        let usageChart = null;
        let timeChart = null;

        // ÊâìÂºÄÊï∞ÊçÆÂàÜÊûêÈù¢Êùø
        function openAnalytics() {
            document.getElementById('analyticsDashboard').style.display = 'block';
            updateAnalyticsData();
            createCharts();
            
            // ËÆ∞ÂΩïÊâìÂºÄÂàÜÊûêÈù¢Êùø
            logOperation('analytics_open', { timestamp: new Date().toISOString() });
        }

        // ÂÖ≥Èó≠Êï∞ÊçÆÂàÜÊûêÈù¢Êùø
        function closeAnalytics() {
            document.getElementById('analyticsDashboard').style.display = 'none';
            
            // ÈîÄÊØÅÂõæË°®ÂÆû‰æã‰ª•ÈáäÊîæÂÜÖÂ≠ò
            if (usageChart) {
                usageChart.destroy();
                usageChart = null;
            }
            if (timeChart) {
                timeChart.destroy();
                timeChart = null;
            }
        }

        // Êõ¥Êñ∞ÂàÜÊûêÊï∞ÊçÆ
        function updateAnalyticsData() {
            // ËÆ°ÁÆóÊÄªËΩ¨Êç¢Ê¨°Êï∞
            const operationLogs = passwordConfig.operationLogs || [];
            const conversions = operationLogs.filter(log => log.action === 'word_download');
            document.getElementById('totalConversions').textContent = conversions.length;

            // ËÆ°ÁÆóÊ¥ªË∑ÉÁî®Êà∑Êï∞
            const activePasswords = Object.keys(passwordConfig.usageStats || {}).length;
            document.getElementById('activeUsers').textContent = activePasswords;

            // ËÆ°ÁÆóÂπ≥Âùá‰ºöËØùÊó∂ÈïøÔºàÊ®°ÊãüÊï∞ÊçÆÔºâ
            const avgTime = Math.round(Math.random() * 20 + 5);
            document.getElementById('avgSessionTime').textContent = avgTime;

            // ËÆ°ÁÆó‰ªäÊó•Ê¥ªÂä®
            const today = new Date().toISOString().split('T')[0];
            const todayOps = operationLogs.filter(log => 
                log.timestamp && log.timestamp.startsWith(today)
            );
            document.getElementById('todayActivity').textContent = todayOps.length;

            // Êõ¥Êñ∞Êìç‰ΩúËÆ∞ÂΩïË°®Ê†º
            updateOperationsTable();
        }

        // Êõ¥Êñ∞Êìç‰ΩúËÆ∞ÂΩïË°®Ê†º
        function updateOperationsTable() {
            const tbody = document.getElementById('recentOperations');
            const operationLogs = passwordConfig.operationLogs || [];
            
            // Ëé∑ÂèñÊúÄËøë20Êù°ËÆ∞ÂΩï
            const recentLogs = operationLogs.slice(-20).reverse();
            
            tbody.innerHTML = recentLogs.map(log => {
                const time = new Date(log.timestamp || Date.now()).toLocaleString('zh-CN');
                const operation = getOperationDisplayName(log.action || log.operation);
                const user = log.userType === 'super_admin' ? 'Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëò' : '‰∏¥Êó∂Áî®Êà∑';
                const details = JSON.stringify(log.details || {});
                
                return `
                    <tr>
                        <td>${time}</td>
                        <td>${operation}</td>
                        <td>${user}</td>
                        <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;">${details}</td>
                    </tr>
                `;
            }).join('');
        }

        // Ëé∑ÂèñÊìç‰ΩúÊòæÁ§∫ÂêçÁß∞
        function getOperationDisplayName(operation) {
            const names = {
                'user_login': 'Áî®Êà∑ÁôªÂΩï',
                'user_logout': 'Áî®Êà∑ÁôªÂá∫',
                'word_download': 'Word‰∏ãËΩΩ',
                'copy_content': 'Â§çÂà∂ÂÜÖÂÆπ',
                'file_upload': 'Êñá‰ª∂‰∏ä‰º†',
                'theme_change': '‰∏ªÈ¢òÂàáÊç¢',
                'analytics_open': 'ÊâìÂºÄÂàÜÊûê',
                'admin_panel': 'ÁÆ°ÁêÜÈù¢Êùø',
                'password_create': 'ÂàõÂª∫ÂØÜÁ†Å',
                'password_delete': 'Âà†Èô§ÂØÜÁ†Å',
                'system_reset': 'Á≥ªÁªüÈáçÁΩÆ'
            };
            return names[operation] || operation;
        }

        // ÂàõÂª∫ÂõæË°®
        function createCharts() {
            createUsageChart();
            createTimeChart();
        }

        // ÂàõÂª∫‰ΩøÁî®Ë∂ãÂäøÂõæ
        function createUsageChart() {
            const ctx = document.getElementById('usageChart').getContext('2d');
            
            // ÁîüÊàêÊúÄËøë7Â§©ÁöÑÊ®°ÊãüÊï∞ÊçÆ
            const days = [];
            const data = [];
            const now = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);
                days.push(date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' }));
                data.push(Math.floor(Math.random() * 20) + 5);
            }

            usageChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'ËΩ¨Êç¢Ê¨°Êï∞',
                        data: data,
                        borderColor: getComputedStyle(document.documentElement).getPropertyValue('--header-gradient-start') || '#4CAF50',
                        backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--header-gradient-start') + '20' || '#4CAF5020',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary') || '#333'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') || '#666'
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') || '#666'
                            }
                        }
                    }
                }
            });
        }

        // ÂàõÂª∫Êó∂Èó¥ÂàÜÂ∏ÉÂõæ
        function createTimeChart() {
            const ctx = document.getElementById('timeChart').getContext('2d');
            
            const hours = Array.from({length: 24}, (_, i) => `${i}:00`);
            const data = Array.from({length: 24}, () => Math.floor(Math.random() * 10));

            timeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: hours,
                    datasets: [{
                        label: 'Â∞èÊó∂‰ΩøÁî®Èáè',
                        data: data,
                        backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--header-gradient-start') + '60' || '#4CAF5060',
                        borderColor: getComputedStyle(document.documentElement).getPropertyValue('--header-gradient-start') || '#4CAF50',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary') || '#333'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') || '#666'
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') || '#666'
                            }
                        }
                    }
                }
            });
        }


        // Âà∑Êñ∞ÂàÜÊûêÊï∞ÊçÆ
        function refreshAnalytics() {
            updateAnalyticsData();
            
            // ÈáçÊñ∞ÂàõÂª∫ÂõæË°®
            if (usageChart) {
                usageChart.destroy();
            }
            if (timeChart) {
                timeChart.destroy();
            }
            createCharts();
            
            showStatus('Êï∞ÊçÆÂ∑≤Âà∑Êñ∞', 'info');
        }

        // ÂàõÂª∫ÂõæË°®
        function createCharts() {
            if (typeof Chart === 'undefined') {
                console.warn('Chart.js Êú™Âä†ËΩΩ');
                return;
            }
            createUsageChart();
            createTimeChart();
        }

        // ÂàõÂª∫‰ΩøÁî®Ë∂ãÂäøÂõæ
        function createUsageChart() {
            const ctx = document.getElementById('usageChart');
            if (!ctx) return;

            // Ê®°Êãü7Â§©Êï∞ÊçÆ
            const data = Array.from({length: 7}, () => Math.floor(Math.random() * 20 + 5));
            const labels = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                labels.push(date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' }));
            }

            usageChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ÊØèÊó•‰ΩøÁî®Èáè',
                        data: data,
                        borderColor: '#0984e3',
                        backgroundColor: 'rgba(9, 132, 227, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // ÂàõÂª∫Êó∂Èó¥ÂàÜÂ∏ÉÂõæ
        function createTimeChart() {
            const ctx = document.getElementById('timeChart');
            if (!ctx) return;

            // Ê®°Êãü24Â∞èÊó∂Êï∞ÊçÆ
            const data = Array.from({length: 24}, () => Math.floor(Math.random() * 10));
            const labels = Array.from({length: 24}, (_, i) => `${i}:00`);

            timeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Â∞èÊó∂‰ΩøÁî®Èáè',
                        data: data,
                        backgroundColor: 'rgba(116, 185, 255, 0.8)',
                        borderColor: '#74b9ff',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // ÊâìÂºÄÂàÜÊûêÈù¢Êùø
        function openAnalytics() {
            const dashboard = document.getElementById('analyticsDashboard');
            if (!dashboard) return;

            dashboard.style.display = 'block';
            updateAnalyticsData();
            
            // ÂàõÂª∫ÂõæË°®
            if (!usageChart || !timeChart) {
                setTimeout(() => createCharts(), 100);
            }

            logOperation('analytics_open', { timestamp: new Date().toISOString() });
        }

        // ÂÖ≥Èó≠ÂàÜÊûêÈù¢Êùø
        function closeAnalytics() {
            const dashboard = document.getElementById('analyticsDashboard');
            if (dashboard) {
                dashboard.style.display = 'none';
            }
        }

        // ÂØºÂá∫ÂàÜÊûêÊï∞ÊçÆ
        function exportAnalyticsData() {
            const data = {
                exportTime: new Date().toISOString(),
                totalConversions: document.getElementById('totalConversions').textContent,
                activeUsers: document.getElementById('activeUsers').textContent,
                avgSessionTime: document.getElementById('avgSessionTime').textContent,
                todayActivity: document.getElementById('todayActivity').textContent,
                operationLogs: passwordConfig.operationLogs || [],
                usageStats: passwordConfig.usageStats || {}
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analytics-data-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);

            showStatus('ÂàÜÊûêÊï∞ÊçÆÂ∑≤ÂØºÂá∫', 'info');
            logOperation('analytics_export', { timestamp: new Date().toISOString() });
        }

        // ========== Âø´Êç∑ÈîÆÁ≥ªÁªü ==========
        
        // ÂàùÂßãÂåñÂø´Êç∑ÈîÆ
        function initializeShortcuts() {
            document.addEventListener('keydown', function(e) {
                // Ctrl+T - ÂàáÊç¢‰∏ªÈ¢ò
                if (e.ctrlKey && e.key === 't') {
                    e.preventDefault();
                    const currentTheme = getCurrentTheme() || 'amber';
                    const themes = ['amber', 'light', 'classic'];
                    const currentIndex = themes.indexOf(currentTheme);
                    const nextTheme = themes[(currentIndex + 1) % themes.length];
                    switchTheme(nextTheme);
                }
                
                // F12 - ÊâìÂºÄÊï∞ÊçÆÂàÜÊûêÔºà‰ªÖË∂ÖÁ∫ßÁÆ°ÁêÜÂëòÔºâ
                if (e.key === 'F12') {
                    e.preventDefault();
                    const userInfo = JSON.parse(sessionStorage.getItem('user_info') || '{}');
                    if (userInfo.type === 'super_admin') {
                        if (document.getElementById('analyticsDashboard').style.display === 'block') {
                            closeAnalytics();
                        } else {
                            openAnalytics();
                        }
                    }
                }
                
                // Esc - ÂÖ≥Èó≠Èù¢Êùø
                if (e.key === 'Escape') {
                    if (document.getElementById('analyticsDashboard').style.display === 'block') {
                        closeAnalytics();
                    }
                    if (document.getElementById('adminPanel').style.display === 'block') {
                        document.getElementById('adminPanel').style.display = 'none';
                    }
                }
            });
        }

        // ÊòæÁ§∫Âø´Êç∑ÈîÆÊèêÁ§∫
        function showShortcutHint() {
            const hint = document.getElementById('shortcutHint');
            if (hint) {
                hint.style.display = 'block';
                
                // 5ÁßíÂêéËá™Âä®ÈöêËóè
                setTimeout(() => {
                    hint.style.display = 'none';
                }, 5000);
            }
        }
        // ÈÖçÁΩÆmarkedÈÄâÈ°π
        marked.setOptions({
            breaks: true,
            gfm: true
        });

        const markdownInput = document.getElementById('markdownInput');
        const preview = document.getElementById('preview');
        const wordCount = document.getElementById('wordCount');
        const statusIndicator = document.getElementById('statusIndicator');

        // Ê∏≤ÊüìÊï∞Â≠¶ÂÖ¨Âºè
        function renderMath(element) {
            if (window.renderMathInElement) {
                renderMathInElement(element, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\(', right: '\\)', display: false},
                        {left: '\\[', right: '\\]', display: true}
                    ],
                    throwOnError: false
                });
            }
        }

        // ÊòæÁ§∫Áä∂ÊÄÅÊ∂àÊÅØ
        function showStatus(message, type = 'success') {
            statusIndicator.textContent = message;
            statusIndicator.className = `status-indicator show ${type}`;
            setTimeout(() => {
                statusIndicator.classList.remove('show');
            }, 3000);
        }

        // Êõ¥Êñ∞Â≠óÊï∞ÁªüËÆ°
        function updateWordCount() {
            const text = markdownInput.value;
            const charCount = text.length;
            const wordCount_en = text.trim() ? text.trim().split(/\s+/).length : 0;
            const lineCount = text.split('\n').length;
            
            wordCount.textContent = `${charCount} Â≠óÁ¨¶ | ${wordCount_en} ÂçïËØç | ${lineCount} Ë°å`;
        }

        // Èò≤ÊäñÂ§ÑÁêÜÂáΩÊï∞
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func.apply(this, args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // ‰ºòÂåñÁöÑÈ¢ÑËßàÊõ¥Êñ∞ÂáΩÊï∞
        function updatePreview() {
            const markdownText = markdownInput.value;
            
            if (markdownText.trim() === '') {
                preview.innerHTML = 'ËØ∑Âú®Â∑¶‰æßËæìÂÖ•MarkdownÂÜÖÂÆπ...';
                return;
            }
            
            try {
                const html = marked.parse(markdownText);
                preview.innerHTML = html;
                // Êï∞Â≠¶ÂÖ¨ÂºèÊ∏≤Êüì‰ΩøÁî®Èò≤Êäñ
                debouncedRenderMath();
            } catch (error) {
                preview.innerHTML = 'Ëß£ÊûêÈîôËØØ: ' + error.message;
            }
        }

        // Èò≤ÊäñÂ§ÑÁêÜÁöÑÊï∞Â≠¶ÂÖ¨ÂºèÊ∏≤Êüì
        const debouncedRenderMath = debounce(() => {
            renderMath(preview);
        }, 100);

        // Èò≤ÊäñÂ§ÑÁêÜÁöÑÈ¢ÑËßàÊõ¥Êñ∞
        const debouncedUpdatePreview = debounce(updatePreview, 150);

        // ÂÆûÊó∂È¢ÑËßàÂäüËÉΩÔºà‰ºòÂåñÁâàÔºâ
        markdownInput.addEventListener('input', function() {
            // Â≠óÊï∞ÁªüËÆ°ÂÆûÊó∂Êõ¥Êñ∞
            updateWordCount();
            
            // È¢ÑËßàÊõ¥Êñ∞‰ΩøÁî®Èò≤Êäñ
            debouncedUpdatePreview();
        });

        // Âä†ËΩΩÁ§∫‰æãÂÜÖÂÆπ
        function loadExample() {
            const exampleMarkdown = `# ÊàëÁöÑÊñáÊ°£Ê†áÈ¢ò

## ÁÆÄ‰ªã

ËøôÊòØ‰∏Ä‰∏™**MarkdownËΩ¨Word**ÁöÑÁ§∫‰æãÊñáÊ°£„ÄÇ

### ÂäüËÉΩÁâπËâ≤

- ‚úÖ ÊîØÊåÅÊ†áÈ¢òÊ†ºÂºè
- ‚úÖ ÊîØÊåÅ**Á≤ó‰Ωì**Âíå*Êñú‰Ωì*
- ‚úÖ ÊîØÊåÅÂàóË°®ÂíåÁºñÂè∑
- ‚úÖ ÊîØÊåÅ‰ª£Á†ÅÂùó
- ‚úÖ ÊîØÊåÅË°®Ê†º
- ‚úÖ ÊîØÊåÅÂºïÁî®Âùó
- ‚úÖ ÊîØÊåÅÊï∞Â≠¶ÂÖ¨Âºè üìê

### ‰ª£Á†ÅÁ§∫‰æã

\`\`\`javascript
function hello() {
    console.log("Hello, World!");
}
\`\`\`

### Ë°®Ê†ºÁ§∫‰æã

| ÂäüËÉΩ | ÊîØÊåÅ | Â§áÊ≥® |
|------|------|------|
| Ê†áÈ¢ò | ‚úÖ | 1-6Á∫ßÊ†áÈ¢ò |
| ÂàóË°® | ‚úÖ | ÊúâÂ∫èÂíåÊó†Â∫è |
| ‰ª£Á†Å | ‚úÖ | Ë°åÂÜÖÂíåÂùóÁ∫ß |
| Ë°®Ê†º | ‚úÖ | Âü∫Êú¨Ë°®Ê†º |

### ÂºïÁî®

> ËøôÊòØ‰∏Ä‰∏™ÂºïÁî®ÂùóÁöÑÁ§∫‰æã„ÄÇ
> ÂèØ‰ª•ÂåÖÂê´Â§öË°åÂÜÖÂÆπ„ÄÇ

### Êï∞Â≠¶ÂÖ¨ÂºèÁ§∫‰æã

#### Ë°åÂÜÖÂÖ¨Âºè
ËøôÊòØË°åÂÜÖÂÖ¨ÂºèÔºö$E = mc^2$ÔºåÁà±Âõ†ÊñØÂù¶Ë¥®ËÉΩÊñπÁ®ã„ÄÇ

#### ÂùóÁ∫ßÂÖ¨Âºè
ËøôÊòØÂùóÁ∫ßÂÖ¨ÂºèÔºö

$$\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}$$

#### Â§çÊùÇÂÖ¨Âºè
‰∫åÊ¨°ÊñπÁ®ãÁöÑËß£Ôºö

$$x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$

### ÈìæÊé•

ËÆøÈóÆ [GitHub](https://github.com) ‰∫ÜËß£Êõ¥Â§ö‰ø°ÊÅØ„ÄÇ

---

*ÊñáÊ°£ÁªìÊùü*`;

            markdownInput.value = exampleMarkdown;
            markdownInput.dispatchEvent(new Event('input'));
            showStatus('Á§∫‰æãÂÜÖÂÆπÂ∑≤Âä†ËΩΩ');
            // Á°Æ‰øùÊï∞Â≠¶ÂÖ¨ÂºèÊ∏≤Êüì
            setTimeout(() => renderMath(preview), 100);
        }

        // Ê∏ÖÁ©∫ÂÜÖÂÆπ
        function clearContent() {
            if (markdownInput.value.trim() && !confirm('Á°ÆËÆ§Ê∏ÖÁ©∫ÊâÄÊúâÂÜÖÂÆπÔºü')) {
                return;
            }
            markdownInput.value = '';
            preview.innerHTML = 'ËØ∑Âú®Â∑¶‰æßËæìÂÖ•MarkdownÂÜÖÂÆπ...';
            updateWordCount();
            showStatus('ÂÜÖÂÆπÂ∑≤Ê∏ÖÁ©∫');
        }

        // Â§çÂà∂ÂØåÊñáÊú¨ÂÜÖÂÆπ
        function copyFormattedText() {
            const markdownText = markdownInput.value.trim();
            
            if (!markdownText) {
                alert('ËØ∑ÂÖàËæìÂÖ•MarkdownÂÜÖÂÆπÔºÅ');
                return;
            }

            try {
                // Ëß£Êûêmarkdown‰∏∫HTML
                const html = marked.parse(markdownText);
                
                // ÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂divÊù•Â§ÑÁêÜHTML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = html;
                
                // ÈÄâÊã©È¢ÑËßàÂå∫ÂüüÁöÑÂÜÖÂÆπ
                const range = document.createRange();
                range.selectNodeContents(preview);
                
                // Ê∏ÖÈô§‰πãÂâçÁöÑÈÄâÊã©
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
                
                // Â∞ùËØïÂ§çÂà∂
                try {
                    // Áé∞‰ª£ÊµèËßàÂô®‰ΩøÁî® Clipboard API
                    if (navigator.clipboard && navigator.clipboard.write) {
                        // ÂàõÂª∫ ClipboardItemÔºåÂêåÊó∂ÂåÖÂê´HTMLÂíåÁ∫ØÊñáÊú¨
                        const clipboardItems = new ClipboardItem({
                            'text/html': new Blob([html], { type: 'text/html' }),
                            'text/plain': new Blob([preview.textContent], { type: 'text/plain' })
                        });
                        
                        navigator.clipboard.write([clipboardItems]).then(() => {
                            showStatus('ÂØåÊñáÊú¨Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                            
                            // ËÆ∞ÂΩïÂ§çÂà∂Êìç‰Ωú
                            logOperation('copy_content', {
                                method: 'clipboard_api',
                                contentLength: markdownText.length,
                                timestamp: new Date().toISOString()
                            });
                        }).catch(() => {
                            // Â¶ÇÊûúClipboard APIÂ§±Ë¥•ÔºåÂõûÈÄÄÂà∞‰º†ÁªüÊñπÊ≥ï
                            fallbackCopy();
                        });
                    } else {
                        // ÂõûÈÄÄÂà∞‰º†ÁªüÂ§çÂà∂ÊñπÊ≥ï
                        fallbackCopy();
                    }
                } catch (error) {
                    fallbackCopy();
                }
                
                function fallbackCopy() {
                    // ‰º†ÁªüÁöÑÂ§çÂà∂ÊñπÊ≥ï
                    const successful = document.execCommand('copy');
                    if (successful) {
                        showStatus('ÂÜÖÂÆπÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                        
                        // ËÆ∞ÂΩïÂ§çÂà∂Êìç‰Ωú
                        logOperation('copy_content', {
                            method: 'exec_command',
                            contentLength: markdownText.length,
                            timestamp: new Date().toISOString()
                        });
                    } else {
                        showStatus('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®ÈÄâÊã©ÂÜÖÂÆπ', 'error');
                    }
                }
                
                // Ê∏ÖÈô§ÈÄâÊã©
                selection.removeAllRanges();
                
            } catch (error) {
                console.error('Â§çÂà∂Â§±Ë¥•:', error);
                alert('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÊÇ®ÁöÑMarkdownÊ†ºÂºèÊòØÂê¶Ê≠£Á°Æ„ÄÇ');
            }
        }

        // ËΩ¨Êç¢‰∏∫WordÊñáÊ°£
        function downloadWord() {
            const markdownText = markdownInput.value.trim();
            
            if (!markdownText) {
                alert('ËØ∑ÂÖàËæìÂÖ•MarkdownÂÜÖÂÆπÔºÅ');
                return;
            }

            try {
                // Ëß£Êûêmarkdown‰∏∫HTML
                const html = marked.parse(markdownText);
                
                // Â∞ÜHTMLËΩ¨Êç¢‰∏∫Á∫ØÊñáÊú¨Âπ∂‰øùÊåÅÂü∫Êú¨Ê†ºÂºè
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = html;
                
                // ÊèêÂèñÊñáÊ°£ÂÜÖÂÆπ
                const children = [];
                
                // Â§ÑÁêÜÂêÑÁßçÂÖÉÁ¥†
                Array.from(tempDiv.children).forEach(element => {
                    const tagName = element.tagName.toLowerCase();
                    const text = element.textContent.trim();
                    
                    if (!text) return;
                    
                    switch(tagName) {
                        case 'h1':
                            children.push(new docx.Paragraph({
                                text: text,
                                heading: docx.HeadingLevel.HEADING_1,
                                spacing: { after: 200 }
                            }));
                            break;
                        case 'h2':
                            children.push(new docx.Paragraph({
                                text: text,
                                heading: docx.HeadingLevel.HEADING_2,
                                spacing: { after: 200 }
                            }));
                            break;
                        case 'h3':
                            children.push(new docx.Paragraph({
                                text: text,
                                heading: docx.HeadingLevel.HEADING_3,
                                spacing: { after: 200 }
                            }));
                            break;
                        case 'h4':
                            children.push(new docx.Paragraph({
                                text: text,
                                heading: docx.HeadingLevel.HEADING_4,
                                spacing: { after: 200 }
                            }));
                            break;
                        case 'p':
                            // Â§ÑÁêÜÊÆµËêΩ‰∏≠ÁöÑÊ†ºÂºèÔºàÈÄíÂΩíÂ§ÑÁêÜÊ∑∑ÂêàÊ†ºÂºèÔºâ
                            const runs = [];
                            
                            const processNode = (node) => {
                                if (node.nodeType === Node.TEXT_NODE) {
                                    const textContent = node.textContent;
                                    if (textContent) {
                                        runs.push(new docx.TextRun(textContent));
                                    }
                                } else if (node.nodeType === Node.ELEMENT_NODE) {
                                    const tag = node.tagName.toLowerCase();
                                    
                                    // ÈÄíÂΩíÂ§ÑÁêÜÂµåÂ•óÊ†áÁ≠æ
                                    if (node.childNodes.length > 0) {
                                        Array.from(node.childNodes).forEach(childNode => {
                                            if (childNode.nodeType === Node.TEXT_NODE) {
                                                const textContent = childNode.textContent;
                                                if (textContent) {
                                                    const runProps = {};
                                                    
                                                    // Ê†πÊçÆÁà∂Ê†áÁ≠æËÆæÁΩÆÊ†ºÂºè
                                                    switch(tag) {
                                                        case 'strong':
                                                        case 'b':
                                                            runProps.bold = true;
                                                            break;
                                                        case 'em':
                                                        case 'i':
                                                            runProps.italics = true;
                                                            break;
                                                        case 'code':
                                                            runProps.font = "Courier New";
                                                            runProps.highlight = "yellow";
                                                            break;
                                                        case 'u':
                                                            runProps.underline = {};
                                                            break;
                                                        case 's':
                                                        case 'del':
                                                            runProps.strike = true;
                                                            break;
                                                    }
                                                    
                                                    runs.push(new docx.TextRun({
                                                        text: textContent,
                                                        ...runProps
                                                    }));
                                                }
                                            } else if (childNode.nodeType === Node.ELEMENT_NODE) {
                                                // Â§ÑÁêÜÂµåÂ•óÊ†ºÂºèÔºàÂ¶ÇÁ≤ó‰Ωì+Êñú‰ΩìÔºâ
                                                const childTag = childNode.tagName.toLowerCase();
                                                const childText = childNode.textContent;
                                                if (childText) {
                                                    const runProps = {};
                                                    
                                                    // ÁªßÊâøÁà∂Ê†áÁ≠æÊ†ºÂºè
                                                    if (tag === 'strong' || tag === 'b') runProps.bold = true;
                                                    if (tag === 'em' || tag === 'i') runProps.italics = true;
                                                    if (tag === 'code') {
                                                        runProps.font = "Courier New";
                                                        runProps.highlight = "yellow";
                                                    }
                                                    
                                                    // Ê∑ªÂä†Â≠êÊ†áÁ≠æÊ†ºÂºè
                                                    if (childTag === 'strong' || childTag === 'b') runProps.bold = true;
                                                    if (childTag === 'em' || childTag === 'i') runProps.italics = true;
                                                    if (childTag === 'code') {
                                                        runProps.font = "Courier New";
                                                        runProps.highlight = "yellow";
                                                    }
                                                    if (childTag === 'u') runProps.underline = {};
                                                    if (childTag === 's' || childTag === 'del') runProps.strike = true;
                                                    
                                                    runs.push(new docx.TextRun({
                                                        text: childText,
                                                        ...runProps
                                                    }));
                                                }
                                            }
                                        });
                                    } else {
                                        // Ê≤°ÊúâÂ≠êËäÇÁÇπÁöÑÂÖÉÁ¥†
                                        const content = node.textContent;
                                        if (content) {
                                            const runProps = {};
                                            switch(tag) {
                                                case 'strong':
                                                case 'b':
                                                    runProps.bold = true;
                                                    break;
                                                case 'em':
                                                case 'i':
                                                    runProps.italics = true;
                                                    break;
                                                case 'code':
                                                    runProps.font = "Courier New";
                                                    runProps.highlight = "yellow";
                                                    break;
                                                case 'u':
                                                    runProps.underline = {};
                                                    break;
                                                case 's':
                                                case 'del':
                                                    runProps.strike = true;
                                                    break;
                                            }
                                            runs.push(new docx.TextRun({
                                                text: content,
                                                ...runProps
                                            }));
                                        }
                                    }
                                }
                            };
                            
                            // Â§ÑÁêÜÊâÄÊúâÂ≠êËäÇÁÇπ
                            Array.from(element.childNodes).forEach(processNode);
                            
                            // Â¶ÇÊûúÊ≤°ÊúârunsÔºå‰ΩøÁî®Á∫ØÊñáÊú¨
                            if (runs.length === 0 && text) {
                                runs.push(new docx.TextRun(text));
                            }
                            
                            if (runs.length > 0) {
                                children.push(new docx.Paragraph({
                                    children: runs,
                                    spacing: { after: 120 }
                                }));
                            }
                            break;
                        case 'ul':
                            Array.from(element.querySelectorAll('li')).forEach((li, index) => {
                                children.push(new docx.Paragraph({
                                    text: li.textContent.trim(),
                                    bullet: {
                                        level: 0
                                    },
                                    spacing: { after: 80 }
                                }));
                            });
                            break;
                        case 'ol':
                            Array.from(element.querySelectorAll('li')).forEach((li, index) => {
                                children.push(new docx.Paragraph({
                                    text: li.textContent.trim(),
                                    numbering: {
                                        reference: "default-numbering",
                                        level: 0
                                    },
                                    spacing: { after: 80 }
                                }));
                            });
                            break;
                        case 'blockquote':
                            children.push(new docx.Paragraph({
                                text: text,
                                indent: {
                                    left: 720
                                },
                                spacing: { after: 120 }
                            }));
                            break;
                        case 'pre':
                            // Â§ÑÁêÜ‰ª£Á†ÅÂùó
                            const codeElement = element.querySelector('code');
                            const codeText = codeElement ? codeElement.textContent : text;
                            const codeLines = codeText.split('\n');
                            
                            // Ê∑ªÂä†‰ª£Á†ÅÂùóÊ†áÈ¢ò
                            children.push(new docx.Paragraph({
                                text: "‰ª£Á†ÅÂùó:",
                                spacing: { before: 120, after: 80 },
                                run: {
                                    bold: true,
                                    color: "666666"
                                }
                            }));
                            
                            // ‰∏∫ÊØèË°å‰ª£Á†ÅÂàõÂª∫ÊÆµËêΩ
                            codeLines.forEach((line, index) => {
                                children.push(new docx.Paragraph({
                                    text: line || " ", // Á©∫Ë°åÁî®Á©∫Ê†ºÂç†‰Ωç
                                    spacing: { after: 0, before: 0 },
                                    run: {
                                        font: "Consolas",
                                        size: 18
                                    },
                                    shading: {
                                        type: docx.ShadingType.SOLID,
                                        color: "f8f8f8"
                                    },
                                    border: {
                                        left: {
                                            color: "cccccc",
                                            size: 1,
                                            type: docx.BorderStyle.SINGLE
                                        }
                                    },
                                    indent: {
                                        left: 360
                                    }
                                }));
                            });
                            
                            // ‰ª£Á†ÅÂùóÂêéÁ©∫Ë°å
                            children.push(new docx.Paragraph({
                                text: "",
                                spacing: { after: 120 }
                            }));
                            break;
                        case 'table':
                            // ÁÆÄÂçïË°®Ê†ºÂ§ÑÁêÜ
                            const rows = Array.from(element.querySelectorAll('tr'));
                            if (rows.length > 0) {
                                const tableRows = rows.map(row => {
                                    const cells = Array.from(row.querySelectorAll('td, th'));
                                    return new docx.TableRow({
                                        children: cells.map(cell => new docx.TableCell({
                                            children: [new docx.Paragraph(cell.textContent.trim())]
                                        }))
                                    });
                                });
                                
                                children.push(new docx.Table({
                                    rows: tableRows,
                                    width: {
                                        size: 100,
                                        type: docx.WidthType.PERCENTAGE
                                    }
                                }));
                            }
                            break;
                        default:
                            children.push(new docx.Paragraph({
                                text: text,
                                spacing: { after: 120 }
                            }));
                    }
                });

                // Â¶ÇÊûúÊ≤°ÊúâÂÜÖÂÆπÔºåÂàõÂª∫‰∏Ä‰∏™ÈªòËÆ§ÊÆµËêΩ
                if (children.length === 0) {
                    children.push(new docx.Paragraph("ÊñáÊ°£ÂÜÖÂÆπ"));
                }

                // ÂàõÂª∫WordÊñáÊ°£
                const doc = new docx.Document({
                    sections: [{
                        properties: {},
                        children: children
                    }]
                });

                // ÁîüÊàêÂπ∂‰∏ãËΩΩÊñá‰ª∂
                showStatus('Ê≠£Âú®ÁîüÊàêWordÊñáÊ°£...', 'info');
                docx.Packer.toBlob(doc).then(blob => {
                    const currentDate = new Date().toISOString().slice(0, 10);
                    saveAs(blob, `markdown-document-${currentDate}.docx`);
                    showStatus('WordÊñáÊ°£‰∏ãËΩΩÊàêÂäü');
                    
                    // ËÆ∞ÂΩïWord‰∏ãËΩΩÊìç‰Ωú
                    logOperation('word_download', {
                        filename: `markdown-document-${currentDate}.docx`,
                        contentLength: markdownInput.value.length,
                        timestamp: new Date().toISOString()
                    });
                }).catch(error => {
                    console.error('WordÁîüÊàêÂ§±Ë¥•:', error);
                    showStatus('WordÊñáÊ°£ÁîüÊàêÂ§±Ë¥•', 'error');
                });

            } catch (error) {
                console.error('ËΩ¨Êç¢Â§±Ë¥•:', error);
                alert('ËΩ¨Êç¢Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÊÇ®ÁöÑMarkdownÊ†ºÂºèÊòØÂê¶Ê≠£Á°Æ„ÄÇ');
            }
        }

        // ‰∏ä‰º†MarkdownÊñá‰ª∂
        function uploadFile() {
            document.getElementById('fileInput').click();
        }

        // Â§ÑÁêÜÊñá‰ª∂‰∏ä‰º†
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                markdownInput.value = e.target.result;
                markdownInput.dispatchEvent(new Event('input'));
                showStatus(`Êñá‰ª∂ ${file.name} ‰∏ä‰º†ÊàêÂäü`);
                
                // ËÆ∞ÂΩïÊñá‰ª∂‰∏ä‰º†Êìç‰Ωú
                logOperation('file_upload', {
                    filename: file.name,
                    fileSize: file.size,
                    fileType: file.type,
                    contentLength: e.target.result.length,
                    timestamp: new Date().toISOString()
                });
            };
            reader.readAsText(file);
        }

        // ‰øùÂ≠òËçâÁ®øÂà∞Êú¨Âú∞Â≠òÂÇ®
        function saveToLocal() {
            const content = markdownInput.value;
            if (!content.trim()) {
                alert('Ê≤°ÊúâÂÜÖÂÆπÂèØ‰øùÂ≠òÔºÅ');
                return;
            }
            
            const timestamp = new Date().toLocaleString();
            localStorage.setItem('markdown-draft', content);
            localStorage.setItem('markdown-draft-timestamp', timestamp);
            showStatus(`ËçâÁ®øÂ∑≤‰øùÂ≠ò (${timestamp})`);
        }

        // ‰ªéÊú¨Âú∞Â≠òÂÇ®Âä†ËΩΩËçâÁ®ø
        function loadFromLocal() {
            const savedContent = localStorage.getItem('markdown-draft');
            const timestamp = localStorage.getItem('markdown-draft-timestamp');
            
            if (!savedContent) {
                alert('Ê≤°ÊúâÊâæÂà∞‰øùÂ≠òÁöÑËçâÁ®øÔºÅ');
                return;
            }
            
            if (markdownInput.value.trim() && !confirm('ÂΩìÂâçÊúâÂÜÖÂÆπÔºåÊòØÂê¶Á°ÆËÆ§Âä†ËΩΩËçâÁ®øÔºüËøôÂ∞ÜË¶ÜÁõñÂΩìÂâçÂÜÖÂÆπ„ÄÇ')) {
                return;
            }
            
            markdownInput.value = savedContent;
            markdownInput.dispatchEvent(new Event('input'));
            showStatus(`ËçâÁ®øÂä†ËΩΩÊàêÂäü (${timestamp || 'Êú™Áü•'})`);
        }

        // Ëá™Âä®‰øùÂ≠òÂäüËÉΩÂ∑≤ÁßªÈô§ÔºåÈÅøÂÖçÂºπÁ™óÈóÆÈ¢ò

        // Ê∑ªÂä†ÊãñÊãΩ‰∏ä‰º†ÊîØÊåÅÔºàÂè™ÊúâÂú®ËÆ§ËØÅÂêéÊâçÊ∑ªÂä†Ôºâ
        function initializeDragAndDrop() {
            const markdownInput = document.getElementById('markdownInput');
            if (!markdownInput) return;

            markdownInput.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.style.backgroundColor = '#f0f8ff';
            });

            markdownInput.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.style.backgroundColor = '';
            });

            markdownInput.addEventListener('drop', function(e) {
                e.preventDefault();
                this.style.backgroundColor = '';
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const file = files[0];
                    if (file.type === 'text/markdown' || file.name.endsWith('.md') || file.name.endsWith('.txt')) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            markdownInput.value = e.target.result;
                            markdownInput.dispatchEvent(new Event('input'));
                            showStatus(`Êñá‰ª∂ ${file.name} ÊãñÊãΩ‰∏ä‰º†ÊàêÂäü`);
                            
                            // ËÆ∞ÂΩïÊãñÊãΩ‰∏ä‰º†Êìç‰Ωú
                            logOperation('file_upload', {
                                filename: file.name,
                                fileSize: file.size,
                                fileType: file.type,
                                method: 'drag_drop',
                                contentLength: e.target.result.length,
                                timestamp: new Date().toISOString()
                            });
                        };
                        reader.readAsText(file);
                    } else {
                        alert('ËØ∑‰∏ä‰º† .md Êàñ .txt Ê†ºÂºèÁöÑÊñá‰ª∂ÔºÅ');
                    }
                }
            });
        }

        // Ëá™Âä®‰øùÂ≠òÂäüËÉΩÂ∑≤ÁßªÈô§

        // ÁÆ°ÁêÜÂëòÈù¢ÊùøÂäüËÉΩ
        let titleClickCount = 0;
        let titleClickTimer = null;

        function handleTitleClick() {
            titleClickCount++;
            
            if (titleClickTimer) {
                clearTimeout(titleClickTimer);
            }
            
            titleClickTimer = setTimeout(() => {
                if (titleClickCount >= 3) {
                    openAdminPanel();
                }
                titleClickCount = 0;
            }, 1000);
        }

        function openAdminPanel() {
            const userInfo = JSON.parse(sessionStorage.getItem('user_info') || '{}');
            
            if (userInfo.type !== 'super_admin') {
                showStatus('‰ªÖË∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂèØ‰ª•ËÆøÈóÆÁÆ°ÁêÜÈù¢Êùø', 'error');
                return;
            }
            
            document.getElementById('adminPanel').style.display = 'flex';
            refreshPasswordList();
            refreshStatistics();
        }

        function closeAdminPanel() {
            document.getElementById('adminPanel').style.display = 'none';
        }

        function showAdminTab(tabName) {
            // ÈöêËóèÊâÄÊúâÊ†áÁ≠æÈ°µ
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // ÁßªÈô§ÊâÄÊúâÊåâÈíÆÁöÑactiveÁä∂ÊÄÅ
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ÊòæÁ§∫ÈÄâ‰∏≠ÁöÑÊ†áÁ≠æÈ°µ
            document.getElementById('adminTab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.display = 'block';
            
            // ÊøÄÊ¥ªÂØπÂ∫îÊåâÈíÆ
            event.target.classList.add('active');
            
            // Âà∑Êñ∞ÂÜÖÂÆπ
            if (tabName === 'passwords') {
                refreshPasswordList();
            } else if (tabName === 'statistics') {
                refreshStatistics();
            } else if (tabName === 'categories') {
                refreshCategoryManagement();
            } else if (tabName === 'monitoring') {
                refreshMonitoringData();
            }
        }

        function refreshPasswordList() {
            const passwordList = document.getElementById('passwordList');
            const now = new Date();
            
            let html = '';
            
            Object.entries(passwordConfig.tempPasswords).forEach(([password, config]) => {
                const expiresAt = new Date(config.expiresAt);
                const isExpired = now > expiresAt;
                const usageExceeded = config.usageCount >= config.maxUsage;
                
                let statusClass = '';
                if (isExpired) statusClass = 'expired';
                else if (usageExceeded) statusClass = 'usage-exceeded';
                
                const remainingDays = Math.ceil((expiresAt - now) / (1000 * 60 * 60 * 24));
                const remainingUsage = config.maxUsage - config.usageCount;
                
                html += `
                    <div class="password-item ${statusClass}">
                        <div class="password-info">
                            <div class="password-text">${password}</div>
                            <div class="password-meta">
                                Âà∞Êúü: ${expiresAt.toLocaleDateString()} (${isExpired ? 'Â∑≤ËøáÊúü' : remainingDays + 'Â§©'}) | 
                                ‰ΩøÁî®: ${config.usageCount}/${config.maxUsage} (Ââ©‰Ωô${remainingUsage}Ê¨°) |
                                ÂàõÂª∫: ${new Date(config.createdAt).toLocaleDateString()}
                            </div>
                        </div>
                        <div class="password-actions">
                            <button class="action-btn extend-btn" onclick="extendPassword('${password}')">Âª∂Êúü</button>
                            <button class="action-btn usage-btn" onclick="addUsageCount('${password}')">+Ê¨°Êï∞</button>
                            <button class="action-btn delete-btn" onclick="deletePassword('${password}')">Âà†Èô§</button>
                        </div>
                    </div>
                `;
            });
            
            if (html === '') {
                html = '<p style="text-align: center; color: #666; padding: 20px;">ÊöÇÊó†‰∏¥Êó∂ÂØÜÁ†Å</p>';
            }
            
            passwordList.innerHTML = html;
        }

        function refreshStatistics() {
            const statisticsList = document.getElementById('statisticsList');
            
            let html = '';
            
            // Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÁªüËÆ°
            const superAdminStats = passwordConfig.usageStats[passwordConfig.superAdmin.password];
            if (superAdminStats) {
                html += `
                    <div class="stat-item">
                        <div class="stat-info">
                            <strong>Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëò (${passwordConfig.superAdmin.password})</strong>
                            <div class="password-meta">
                                ÊÄª‰ΩøÁî®Ê¨°Êï∞: ${superAdminStats.totalUsage} | 
                                ÊúÄÂêé‰ΩøÁî®: ${superAdminStats.lastUsed ? new Date(superAdminStats.lastUsed).toLocaleString() : '‰ªéÊú™‰ΩøÁî®'}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // ‰∏¥Êó∂ÂØÜÁ†ÅÁªüËÆ°
            Object.entries(passwordConfig.usageStats).forEach(([password, stats]) => {
                if (password === passwordConfig.superAdmin.password) return;
                
                const config = passwordConfig.tempPasswords[password];
                if (!config) return;
                
                html += `
                    <div class="stat-item">
                        <div class="stat-info">
                            <strong>‰∏¥Êó∂ÂØÜÁ†Å: ${password}</strong>
                            <div class="password-meta">
                                ÊÄª‰ΩøÁî®Ê¨°Êï∞: ${stats.totalUsage} | 
                                ÊúÄÂêé‰ΩøÁî®: ${stats.lastUsed ? new Date(stats.lastUsed).toLocaleString() : '‰ªéÊú™‰ΩøÁî®'} |
                                Ââ©‰ΩôÊ¨°Êï∞: ${config.maxUsage - config.usageCount}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            if (html === '') {
                html = '<p style="text-align: center; color: #666; padding: 20px;">ÊöÇÊó†‰ΩøÁî®ÁªüËÆ°</p>';
            }
            
            statisticsList.innerHTML = html;
        }

        function generateRandomPassword(length = 8) {
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        // ÁîüÊàêÈöèÊú∫ÂØÜÁ†Å
        function generateRandomPassword(length = 8) {
            const chars = 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        // Ëé∑ÂèñÊúâÊïàÊúüÂ§©Êï∞
        function getExpiryDays(selectId, customInputId) {
            const selectElement = document.getElementById(selectId);
            const customInputElement = document.getElementById(customInputId);
            
            if (!selectElement) return 30; // ÈªòËÆ§30Â§©
            
            const value = selectElement.value;
            if (value === 'custom') {
                if (!customInputElement) return null;
                const customDays = parseInt(customInputElement.value);
                if (isNaN(customDays) || customDays < 1 || customDays > 3650) {
                    alert('Ëá™ÂÆö‰πâÂ§©Êï∞ÂøÖÈ°ªÂú®1-3650‰πãÈó¥ÔºÅ');
                    return null;
                }
                return customDays;
            }
            return parseInt(value);
        }

        // ÂàáÊç¢Ëá™ÂÆö‰πâÊúâÊïàÊúüÊòæÁ§∫
        function toggleCustomExpiry(selectId, groupId) {
            const selectElement = document.getElementById(selectId);
            const groupElement = document.getElementById(groupId);
            
            if (!selectElement || !groupElement) return;
            
            if (selectElement.value === 'custom') {
                groupElement.style.display = 'block';
            } else {
                groupElement.style.display = 'none';
            }
        }

        // ÂàáÊç¢Ëá™ÂÆö‰πâÂàÜÁªÑÊòæÁ§∫
        function toggleCustomCategory(selectId, groupId) {
            const selectElement = document.getElementById(selectId);
            const groupElement = document.getElementById(groupId);
            
            if (!selectElement || !groupElement) return;
            
            if (selectElement.value === 'custom') {
                groupElement.style.display = 'block';
            } else {
                groupElement.style.display = 'none';
            }
        }

        function generateNewPassword() {
            const passwordText = document.getElementById('newPasswordText').value.trim() || generateRandomPassword();
            const description = document.getElementById('newPasswordDesc').value.trim() || '‰∏¥Êó∂Áî®Êà∑';
            const expiryDays = getExpiryDays('newPasswordExpiry', 'customExpiryDays');
            const maxUsage = parseInt(document.getElementById('newPasswordMaxUsage').value);
            const category = document.getElementById('newPasswordCategory').value || 'default';
            const tags = document.getElementById('newPasswordTags').value.trim();
            
            if (expiryDays === null) return;
            
            // Ê£ÄÊü•ÂØÜÁ†ÅÊòØÂê¶Â∑≤Â≠òÂú®
            if (passwordConfig.tempPasswords[passwordText] || passwordText === passwordConfig.superAdmin.password) {
                alert('ËØ•ÂØÜÁ†ÅÂ∑≤Â≠òÂú®ÔºåËØ∑‰ΩøÁî®ÂÖ∂‰ªñÂØÜÁ†ÅÔºÅ');
                return;
            }
            
            const now = new Date();
            const expiresAt = new Date(now.getTime() + expiryDays * 24 * 60 * 60 * 1000);
            
            const newPasswordConfig = {
                password: passwordText,
                type: 'temp_user',
                expiresAt: expiresAt.toISOString(),
                permissions: ['convert'],
                usageCount: 0,
                maxUsage: maxUsage,
                createdAt: now.toISOString(),
                createdBy: 'admin',
                description: description,
                category: category,
                tags: tags
            };
            
            passwordConfig.tempPasswords[passwordText] = newPasswordConfig;
            
            logOperation('create_password', {
                password: passwordText,
                description: description,
                expiryDays: expiryDays,
                maxUsage: maxUsage
            });
            
            saveTempPasswords();
            refreshPasswordList();
            
            // Ê∏ÖÁ©∫Ë°®Âçï
            document.getElementById('newPasswordText').value = '';
            document.getElementById('newPasswordDesc').value = '';
            document.getElementById('newPasswordMaxUsage').value = '100';
            document.getElementById('newPasswordCategory').value = 'default';
            document.getElementById('newPasswordTags').value = '';
            document.getElementById('newPasswordExpiry').value = '30';
            
            // ÈöêËóèËá™ÂÆö‰πâÊúâÊïàÊúüÂ≠óÊÆµ
            const customExpiryGroup = document.getElementById('customExpiryGroup');
            if (customExpiryGroup) customExpiryGroup.style.display = 'none';
            
            showStatus(`Êñ∞ÂØÜÁ†Å "${passwordText}" ÁîüÊàêÊàêÂäüÔºÅÊúâÊïàÊúü${expiryDays}Â§©ÔºåÂèØ‰ΩøÁî®${maxUsage}Ê¨°`, 'success');
        }

        function deletePassword(password) {
            if (confirm(`Á°ÆËÆ§Âà†Èô§ÂØÜÁ†Å "${password}"ÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊí§ÈîÄ„ÄÇ`)) {
                const config = passwordConfig.tempPasswords[password];
                
                logOperation('delete_password', {
                    password: password,
                    deletedConfig: config
                });
                
                delete passwordConfig.tempPasswords[password];
                delete passwordConfig.usageStats[password];
                saveTempPasswords();
                saveUsageStats();
                refreshPasswordList();
                refreshStatistics();
                showStatus(`ÂØÜÁ†Å "${password}" Â∑≤Âà†Èô§`, 'info');
            }
        }

        function extendPassword(password) {
            const config = passwordConfig.tempPasswords[password];
            if (!config) return;
            
            const days = prompt('Âª∂ÈïøÂ§öÂ∞ëÂ§©Ôºü', '30');
            if (!days || isNaN(days) || days <= 0) return;
            
            const currentExpiry = new Date(config.expiresAt);
            const newExpiry = new Date(currentExpiry.getTime() + parseInt(days) * 24 * 60 * 60 * 1000);
            
            config.expiresAt = newExpiry.toISOString();
            saveTempPasswords();
            refreshPasswordList();
            
            showStatus(`ÂØÜÁ†Å "${password}" Â∑≤Âª∂Êúü${days}Â§©`, 'info');
        }

        function addUsageCount(password) {
            const config = passwordConfig.tempPasswords[password];
            if (!config) return;
            
            const additionalCount = prompt('Â¢ûÂä†Â§öÂ∞ëÊ¨°‰ΩøÁî®Ê¨°Êï∞Ôºü', '50');
            if (!additionalCount || isNaN(additionalCount) || additionalCount <= 0) return;
            
            const oldMaxUsage = config.maxUsage;
            config.maxUsage += parseInt(additionalCount);
            
            saveTempPasswords();
            refreshPasswordList();
            
            showStatus(`ÂØÜÁ†Å "${password}" ‰ΩøÁî®Ê¨°Êï∞Â∑≤‰ªé${oldMaxUsage}Ê¨°Â¢ûÂä†Âà∞${config.maxUsage}Ê¨°`, 'info');
        }

        // ÊâπÈáèÁîüÊàêÂØÜÁ†ÅÂäüËÉΩ
        function batchGeneratePasswords() {
            const count = parseInt(document.getElementById('batchCount').value);
            const prefix = document.getElementById('batchPrefix').value.trim();
            const length = parseInt(document.getElementById('batchLength').value);
            const description = document.getElementById('batchDesc').value.trim() || 'ÊâπÈáèÁîüÊàêÁî®Êà∑';
            const expiryDays = getExpiryDays('batchExpiry', 'batchCustomExpiryDays');
            const maxUsage = parseInt(document.getElementById('batchMaxUsage').value);
            
            // Ëé∑ÂèñÂàÜÁ±ªÂíåÊ†áÁ≠æ‰ø°ÊÅØ
            const categorySelect = document.getElementById('batchCategory');
            const customCategoryInput = document.getElementById('customCategoryName');
            const tagsInput = document.getElementById('batchTags');
            
            let category = categorySelect ? categorySelect.value : 'default';
            if (category === 'custom' && customCategoryInput) {
                const customCategory = customCategoryInput.value.trim();
                if (customCategory) {
                    // ÂàõÂª∫Êñ∞ÁöÑËá™ÂÆö‰πâÂàÜÁ±ª
                    category = 'cat_' + Date.now();
                    categoryConfig.categories.push({
                        id: category,
                        name: customCategory,
                        description: 'ÊâπÈáèÁîüÊàêÊó∂ÂàõÂª∫',
                        color: '#4CAF50'
                    });
                    saveCategories();
                } else {
                    category = 'default';
                }
            }
            
            const tags = tagsInput ? tagsInput.value.trim() : '';
            
            if (expiryDays === null) return;
            
            if (count < 1 || count > 50) {
                alert('ÁîüÊàêÊï∞ÈáèÂøÖÈ°ªÂú®1-50‰πãÈó¥ÔºÅ');
                return;
            }
            
            const now = new Date();
            const expiresAt = new Date(now.getTime() + expiryDays * 24 * 60 * 60 * 1000);
            const generatedPasswords = [];
            const conflicts = [];
            
            for (let i = 0; i < count; i++) {
                let passwordText;
                let attempts = 0;
                
                // ÁîüÊàêÂØÜÁ†ÅÔºåÈÅøÂÖçÈáçÂ§ç
                do {
                    const randomSuffix = generateRandomPassword(length - (prefix ? prefix.length : 0));
                    passwordText = prefix ? `${prefix}${randomSuffix}` : randomSuffix;
                    attempts++;
                } while ((passwordConfig.tempPasswords[passwordText] || passwordText === passwordConfig.superAdmin.password) && attempts < 100);
                
                if (attempts >= 100) {
                    conflicts.push(`Á¨¨${i + 1}‰∏™ÂØÜÁ†ÅÁîüÊàêÂ§±Ë¥•ÔºàÊó†Ê≥ïÈÅøÂÖçÈáçÂ§çÔºâ`);
                    continue;
                }
                
                // ÂàõÂª∫ÂØÜÁ†ÅÈÖçÁΩÆÔºàÂåÖÂê´ÂàÜÁ±ªÂíåÊ†áÁ≠æÔºâ
                passwordConfig.tempPasswords[passwordText] = {
                    password: passwordText,
                    type: 'temp_user',
                    expiresAt: expiresAt.toISOString(),
                    permissions: ['convert'],
                    usageCount: 0,
                    maxUsage: maxUsage,
                    createdAt: now.toISOString(),
                    createdBy: 'admin',
                    description: `${description} #${i + 1}`,
                    category: category,
                    tags: tags
                };
                
                generatedPasswords.push(passwordText);
            }
            
            // ‰øùÂ≠òÂà∞Â≠òÂÇ®
            saveTempPasswords();
            refreshPasswordList();
            
            // ÊòæÁ§∫ÁªìÊûú
            displayBatchResult(generatedPasswords, conflicts);
            
            showStatus(`ÊâπÈáèÁîüÊàêÂÆåÊàêÔºÅÊàêÂäü${generatedPasswords.length}‰∏™ÔºåÂ§±Ë¥•${conflicts.length}‰∏™`, generatedPasswords.length > 0 ? 'success' : 'error');
        }
        
        function displayBatchResult(passwords, conflicts) {
            const resultDiv = document.getElementById('batchResult');
            const resultList = document.getElementById('batchResultList');
            
            let html = '';
            
            if (passwords.length > 0) {
                html += '<strong>‚úÖ ÊàêÂäüÁîüÊàêÁöÑÂØÜÁ†ÅÔºö</strong><br>';
                passwords.forEach((password, index) => {
                    html += `<div class="batch-password-item">${index + 1}. ${password}</div>`;
                });
            }
            
            if (conflicts.length > 0) {
                html += '<br><strong>‚ùå ÁîüÊàêÂ§±Ë¥•Ôºö</strong><br>';
                conflicts.forEach(conflict => {
                    html += `<div style="color: #f44336; padding: 2px 0;">${conflict}</div>`;
                });
            }
            
            resultList.innerHTML = html;
            resultDiv.style.display = 'block';
            
            // ‰øùÂ≠òÁîüÊàêÁöÑÂØÜÁ†ÅÁî®‰∫éÂ§çÂà∂
            window.lastBatchPasswords = passwords;
        }
        
        function copyBatchResult() {
            if (!window.lastBatchPasswords || window.lastBatchPasswords.length === 0) {
                alert('Ê≤°ÊúâÂØÜÁ†ÅÂèØÂ§çÂà∂ÔºÅ');
                return;
            }
            
            const passwordText = window.lastBatchPasswords.join('\n');
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(passwordText).then(() => {
                    showStatus('ÊâÄÊúâÂØÜÁ†ÅÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø', 'success');
                }).catch(() => {
                    fallbackCopy(passwordText);
                });
            } else {
                fallbackCopy(passwordText);
            }
            
            function fallbackCopy(text) {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                const successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (successful) {
                    showStatus('ÊâÄÊúâÂØÜÁ†ÅÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø', 'success');
                } else {
                    alert('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂ÂØÜÁ†ÅÂàóË°®');
                }
            }
        }

        // CSVÂØºÂá∫ÈÄöÁî®ÂáΩÊï∞
        function downloadCSV(data, filename) {
            const csvContent = "data:text/csv;charset=utf-8," + data;
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", filename);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // ÂØºÂá∫ÂØÜÁ†ÅÂàóË°®‰∏∫CSV
        function exportPasswordsCSV() {
            logOperation('export_passwords', { format: 'csv' });
            
            const headers = ['ÂØÜÁ†Å', 'Á±ªÂûã', 'ÊèèËø∞', 'ÂàõÂª∫Êó∂Èó¥', 'Âà∞ÊúüÊó∂Èó¥', 'ÊúÄÂ§ß‰ΩøÁî®Ê¨°Êï∞', 'Â∑≤‰ΩøÁî®Ê¨°Êï∞', 'Ââ©‰ΩôÊ¨°Êï∞', 'ÂàõÂª∫ËÄÖ', 'Áä∂ÊÄÅ'];
            let csvData = headers.join(',') + '\n';
            
            Object.entries(passwordConfig.tempPasswords).forEach(([password, config]) => {
                const expiresAt = new Date(config.expiresAt);
                const isExpired = new Date() > expiresAt;
                const usageExceeded = config.usageCount >= config.maxUsage;
                
                let status = 'Ê≠£Â∏∏';
                if (isExpired) status = 'Â∑≤ËøáÊúü';
                else if (usageExceeded) status = 'Ê¨°Êï∞Áî®ÂÆå';
                
                const row = [
                    `"${password}"`,
                    `"${config.type}"`,
                    `"${config.description || ''}"`,
                    `"${new Date(config.createdAt).toLocaleString()}"`,
                    `"${expiresAt.toLocaleString()}"`,
                    config.maxUsage,
                    config.usageCount,
                    config.maxUsage - config.usageCount,
                    `"${config.createdBy || 'system'}"`,
                    `"${status}"`
                ].join(',');
                
                csvData += row + '\n';
            });
            
            const timestamp = new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-');
            downloadCSV(csvData, `passwords_${timestamp}.csv`);
            showStatus('ÂØÜÁ†ÅÂàóË°®Â∑≤ÂØºÂá∫', 'success');
        }

        // ÂØºÂá∫‰ΩøÁî®ÁªüËÆ°Êä•Ë°®
        function exportUsageReport() {
            logOperation('export_usage_stats', { format: 'csv' });
            
            const headers = ['ÂØÜÁ†Å', 'Áî®Êà∑Á±ªÂûã', 'ÊÄª‰ΩøÁî®Ê¨°Êï∞', 'ÊúÄÂêé‰ΩøÁî®Êó∂Èó¥', '‰ºöËØùÊï∞Èáè', 'ÊúÄËøë‰ºöËØù', 'Áä∂ÊÄÅ'];
            let csvData = headers.join(',') + '\n';
            
            // Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÁªüËÆ°
            const superAdminStats = passwordConfig.usageStats[passwordConfig.superAdmin.password];
            if (superAdminStats) {
                const lastSession = superAdminStats.sessions && superAdminStats.sessions.length > 0 
                    ? new Date(superAdminStats.sessions[superAdminStats.sessions.length - 1].timestamp).toLocaleString()
                    : 'Êó†';
                
                const row = [
                    `"${passwordConfig.superAdmin.password}"`,
                    '"Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëò"',
                    superAdminStats.totalUsage,
                    `"${superAdminStats.lastUsed ? new Date(superAdminStats.lastUsed).toLocaleString() : '‰ªéÊú™‰ΩøÁî®'}"`,
                    superAdminStats.sessions ? superAdminStats.sessions.length : 0,
                    `"${lastSession}"`,
                    '"Ê∞∏‰πÖÊúâÊïà"'
                ].join(',');
                
                csvData += row + '\n';
            }
            
            // ‰∏¥Êó∂ÂØÜÁ†ÅÁªüËÆ°
            Object.entries(passwordConfig.usageStats).forEach(([password, stats]) => {
                if (password === passwordConfig.superAdmin.password) return;
                
                const config = passwordConfig.tempPasswords[password];
                if (!config) return;
                
                const lastSession = stats.sessions && stats.sessions.length > 0 
                    ? new Date(stats.sessions[stats.sessions.length - 1].timestamp).toLocaleString()
                    : 'Êó†';
                
                let status = 'Ê≠£Â∏∏';
                const expiresAt = new Date(config.expiresAt);
                if (new Date() > expiresAt) status = 'Â∑≤ËøáÊúü';
                else if (config.usageCount >= config.maxUsage) status = 'Ê¨°Êï∞Áî®ÂÆå';
                
                const row = [
                    `"${password}"`,
                    '"‰∏¥Êó∂Áî®Êà∑"',
                    stats.totalUsage,
                    `"${stats.lastUsed ? new Date(stats.lastUsed).toLocaleString() : '‰ªéÊú™‰ΩøÁî®'}"`,
                    stats.sessions ? stats.sessions.length : 0,
                    `"${lastSession}"`,
                    `"${status}"`
                ].join(',');
                
                csvData += row + '\n';
            });
            
            const timestamp = new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-');
            downloadCSV(csvData, `usage_report_${timestamp}.csv`);
            showStatus('‰ΩøÁî®ÁªüËÆ°Êä•Ë°®Â∑≤ÂØºÂá∫', 'success');
        }

        // ÂØºÂá∫Êìç‰ΩúÊó•Âøó
        function exportOperationLogs() {
            logOperation('export_logs', { format: 'csv', logCount: passwordConfig.operationLogs.length });
            
            const headers = ['Êó∂Èó¥', 'Êìç‰Ωú', 'Áî®Êà∑', 'Áî®Êà∑Á±ªÂûã', 'ËØ¶ÁªÜ‰ø°ÊÅØ', 'Áî®Êà∑‰ª£ÁêÜ'];
            let csvData = headers.join(',') + '\n';
            
            passwordConfig.operationLogs.forEach(log => {
                const row = [
                    `"${new Date(log.timestamp).toLocaleString()}"`,
                    `"${log.action}"`,
                    `"${log.user}"`,
                    `"${log.userType}"`,
                    `"${JSON.stringify(log.details).replace(/"/g, '""')}"`,
                    `"${log.userAgent}"`
                ].join(',');
                
                csvData += row + '\n';
            });
            
            const timestamp = new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-');
            downloadCSV(csvData, `operation_logs_${timestamp}.csv`);
            showStatus('Êìç‰ΩúÊó•ÂøóÂ∑≤ÂØºÂá∫', 'success');
        }

        // ÂàõÂª∫Á≥ªÁªüÂ§á‰ªΩ
        function exportSystemBackup() {
            logOperation('create_backup', { timestamp: new Date().toISOString() });
            
            const backupData = {
                version: '1.0',
                timestamp: new Date().toISOString(),
                data: {
                    tempPasswords: passwordConfig.tempPasswords,
                    usageStats: passwordConfig.usageStats,
                    operationLogs: passwordConfig.operationLogs
                }
            };
            
            const jsonString = JSON.stringify(backupData, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            const timestamp = new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-');
            link.download = `system_backup_${timestamp}.json`;
            link.href = url;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showStatus('Á≥ªÁªüÂ§á‰ªΩÂ∑≤ÂàõÂª∫', 'success');
        }

        // ÂØºÂÖ•Á≥ªÁªüÂ§á‰ªΩ
        function importSystemBackup() {
            document.getElementById('backupFile').click();
        }

        // Â§ÑÁêÜÂ§á‰ªΩÊñá‰ª∂ÂØºÂÖ•
        function handleBackupImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!confirm('Á°ÆËÆ§ÂØºÂÖ•Â§á‰ªΩÔºüËøôÂ∞ÜË¶ÜÁõñÂΩìÂâçÊâÄÊúâÊï∞ÊçÆÔºÅ')) {
                event.target.value = '';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    if (!backupData.version || !backupData.data) {
                        throw new Error('Êó†ÊïàÁöÑÂ§á‰ªΩÊñá‰ª∂Ê†ºÂºè');
                    }
                    
                    // ÊÅ¢Â§çÊï∞ÊçÆ
                    passwordConfig.tempPasswords = backupData.data.tempPasswords || {};
                    passwordConfig.usageStats = backupData.data.usageStats || {};
                    passwordConfig.operationLogs = backupData.data.operationLogs || [];
                    
                    // ‰øùÂ≠òÂà∞localStorage
                    saveTempPasswords();
                    saveUsageStats();
                    saveOperationLogs();
                    
                    logOperation('restore_backup', { 
                        backupVersion: backupData.version,
                        backupTimestamp: backupData.timestamp
                    });
                    
                    showStatus('Á≥ªÁªüÂ§á‰ªΩÂ∑≤ÊÅ¢Â§ç', 'success');
                    
                    // Âà∑Êñ∞ÊòæÁ§∫
                    if (document.getElementById('adminPanel').style.display === 'flex') {
                        refreshPasswordList();
                        refreshStatistics();
                    }
                    
                } catch (error) {
                    console.error('Â§á‰ªΩÊÅ¢Â§çÂ§±Ë¥•:', error);
                    showStatus('Â§á‰ªΩÊñá‰ª∂Ê†ºÂºèÈîôËØØÊàñÊçüÂùè', 'error');
                }
                
                event.target.value = '';
            };
            
            reader.readAsText(file);
        }

        // Ê∏ÖÁ©∫Êìç‰ΩúÊó•Âøó
        function clearOperationLogs() {
            if (!confirm('Á°ÆËÆ§Ê∏ÖÁ©∫ÊâÄÊúâÊìç‰ΩúÊó•ÂøóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊí§ÈîÄ„ÄÇ')) {
                return;
            }
            
            const logCount = passwordConfig.operationLogs.length;
            logOperation('clear_logs', { clearedCount: logCount });
            
            passwordConfig.operationLogs = [];
            saveOperationLogs();
            
            showStatus(`Â∑≤Ê∏ÖÁ©∫ ${logCount} Êù°Êìç‰ΩúÊó•Âøó`, 'info');
        }

        // Ê∑ªÂä†Âø´Êç∑ÈîÆÊîØÊåÅ
        document.addEventListener('keydown', function(e) {
            // Ctrl+S ‰øùÂ≠òËçâÁ®ø
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveToLocal();
            }
            // Ctrl+O ÊâìÂºÄÊñá‰ª∂
            if (e.ctrlKey && e.key === 'o') {
                e.preventDefault();
                uploadFile();
            }
            // Ctrl+D ‰∏ãËΩΩWord
            if (e.ctrlKey && e.key === 'd') {
                e.preventDefault();
                downloadWord();
            }
        });

        // Â§ÑÁêÜËá™ÂÆö‰πâÊúâÊïàÊúüÈÄâÊã©
        document.addEventListener('DOMContentLoaded', function() {
            // Âçï‰∏™ÁîüÊàêÁöÑÊúâÊïàÊúüÈÄâÊã©
            const newPasswordExpiry = document.getElementById('newPasswordExpiry');
            const customExpiryGroup = document.getElementById('customExpiryGroup');
            
            if (newPasswordExpiry && customExpiryGroup) {
                newPasswordExpiry.addEventListener('change', function() {
                    if (this.value === 'custom') {
                        customExpiryGroup.style.display = 'block';
                    } else {
                        customExpiryGroup.style.display = 'none';
                    }
                });
            }
            
            // ÊâπÈáèÁîüÊàêÁöÑÊúâÊïàÊúüÈÄâÊã©
            const batchExpiry = document.getElementById('batchExpiry');
            const batchCustomExpiryGroup = document.getElementById('batchCustomExpiryGroup');
            
            if (batchExpiry && batchCustomExpiryGroup) {
                batchExpiry.addEventListener('change', function() {
                    if (this.value === 'custom') {
                        batchCustomExpiryGroup.style.display = 'block';
                    } else {
                        batchCustomExpiryGroup.style.display = 'none';
                    }
                });
            }
        });

        // Ëé∑ÂèñÊúâÊïàÊúüÂ§©Êï∞
        function getExpiryDays(selectId, customInputId) {
            const selectElement = document.getElementById(selectId);
            const customInput = document.getElementById(customInputId);
            
            if (selectElement.value === 'custom') {
                const customDays = parseInt(customInput.value);
                if (isNaN(customDays) || customDays < 1) {
                    alert('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑËá™ÂÆö‰πâÂ§©Êï∞Ôºà1-3650Â§©Ôºâ');
                    return null;
                }
                return customDays;
            } else {
                return parseInt(selectElement.value);
            }
        }

        // ÁõëÂê¨Áî®Êà∑Ê¥ªÂä®Êù•ÈáçÁΩÆ‰ºöËØùËÆ°Êó∂Âô®
        function addActivityListeners() {
            const events = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'];
            
            events.forEach(event => {
                document.addEventListener(event, function() {
                    if (sessionStorage.getItem('authenticated') === 'true') {
                        resetSessionTimer();
                    }
                }, true);
            });
        }



        // Á¥ßÊÄ•ÈáçÁΩÆÂäüËÉΩ
        function emergencyReset() {
            console.log('=== Á¥ßÊÄ•ÈáçÁΩÆÁ≥ªÁªü ===');
            
            // Ê∏ÖÈô§ÊâÄÊúâÊú¨Âú∞Â≠òÂÇ®
            localStorage.clear();
            sessionStorage.clear();
            
            // ÈáçÊñ∞ÂàùÂßãÂåñÂØÜÁ†ÅÈÖçÁΩÆ
            passwordConfig.tempPasswords = {};
            passwordConfig.usageStats = {};
            passwordConfig.operationLogs = [];
            
            // Âº∫Âà∂ÈáçÊñ∞ÂàõÂª∫ÈªòËÆ§ÂØÜÁ†Å
            const now = new Date();
            const oneWeekLater = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);
            const oneMonthLater = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000);
            
            passwordConfig.tempPasswords = {
                '517517': {
                    password: '517517',
                    type: 'temp_user',
                    expiresAt: oneMonthLater.toISOString(),
                    permissions: ['convert'],
                    usageCount: 0,
                    maxUsage: 50,
                    createdAt: now.toISOString(),
                    createdBy: 'system',
                    description: 'È´òÁ∫ß‰∏¥Êó∂Ë¥¶Êà∑'
                },
                'demo2024': {
                    password: 'demo2024',
                    type: 'temp_user', 
                    expiresAt: oneWeekLater.toISOString(),
                    permissions: ['convert'],
                    usageCount: 0,
                    maxUsage: 30,
                    createdAt: now.toISOString(),
                    createdBy: 'system',
                    description: 'ÊºîÁ§∫Ë¥¶Êà∑'
                }
            };
            
            // ‰øùÂ≠òÂà∞localStorage
            localStorage.setItem('temp_passwords', JSON.stringify(passwordConfig.tempPasswords));
            localStorage.setItem('password_usage', JSON.stringify(passwordConfig.usageStats));
            localStorage.setItem('operation_logs', JSON.stringify(passwordConfig.operationLogs));
            
            console.log('ÈáçÁΩÆÂÆåÊàê');
            console.log('Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†Å: lingling');
            console.log('‰∏¥Êó∂ÂØÜÁ†Å: 517517, demo2024');
            
            alert('Á≥ªÁªüÂ∑≤ÈáçÁΩÆÔºÅ\n\nÂèØÁî®ÂØÜÁ†ÅÔºö\n- Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëò: lingling\n- ‰∏¥Êó∂ÂØÜÁ†Å: 517517\n- ‰∏¥Êó∂ÂØÜÁ†Å: demo2024\n\nÈ°µÈù¢Â∞ÜÂà∑Êñ∞...');
            
            // Âà∑Êñ∞È°µÈù¢
            location.reload();
        }

        // ========== ÂàÜÁ±ªÁÆ°ÁêÜÂäüËÉΩ ==========
        
        // ÂØÜÁ†ÅÂàÜÁ±ªÊï∞ÊçÆÁªìÊûÑ
        const categoryConfig = {
            categories: JSON.parse(localStorage.getItem('password_categories') || '[]'),
            getDefaultCategories() {
                return [
                    { id: 'default', name: 'ÈªòËÆ§ÂàÜÁ±ª', description: 'Êú™ÂàÜÁ±ªÁöÑÂØÜÁ†Å', color: '#666666' },
                    { id: 'premium', name: 'È´òÁ∫ßÁî®Êà∑', description: '‰ªòË¥πÁî®Êà∑Ë¥¶Êà∑', color: '#4CAF50' },
                    { id: 'trial', name: 'ËØïÁî®Ë¥¶Êà∑', description: '‰∏¥Êó∂ËØïÁî®ÂØÜÁ†Å', color: '#FF9800' },
                    { id: 'internal', name: 'ÂÜÖÈÉ®ÊµãËØï', description: 'Âõ¢ÈòüÂÜÖÈÉ®‰ΩøÁî®', color: '#2196F3' }
                ];
            }
        };

        // ÂàùÂßãÂåñÂàÜÁ±ªÊï∞ÊçÆ
        function initCategories() {
            if (categoryConfig.categories.length === 0) {
                categoryConfig.categories = categoryConfig.getDefaultCategories();
                saveCategories();
            }
        }

        // ‰øùÂ≠òÂàÜÁ±ªÊï∞ÊçÆ
        function saveCategories() {
            localStorage.setItem('password_categories', JSON.stringify(categoryConfig.categories));
        }

        // Âà∑Êñ∞ÂàÜÁ±ªÁÆ°ÁêÜÁïåÈù¢
        function refreshCategoryManagement() {
            initCategories();
            const categoryList = document.getElementById('categoryList');
            const filterSelect = document.getElementById('categoryFilter');
            
            if (!categoryList || !filterSelect) return;

            // Êõ¥Êñ∞ÂàÜÁ±ªÂàóË°®
            let html = '';
            categoryConfig.categories.forEach(category => {
                const passwordCount = getPasswordCountByCategory(category.id);
                html += `
                    <div class="category-item">
                        <div class="category-name" style="color: ${category.color}">
                            ${category.name}
                        </div>
                        <div class="category-stats">
                            ${category.description} | ${passwordCount} ‰∏™ÂØÜÁ†Å
                        </div>
                        <div class="category-actions">
                            <button class="action-btn" onclick="editCategory('${category.id}')">ÁºñËæë</button>
                            <button class="action-btn delete-btn" onclick="deleteCategory('${category.id}')">Âà†Èô§</button>
                        </div>
                    </div>
                `;
            });
            categoryList.innerHTML = html;

            // Êõ¥Êñ∞Á≠õÈÄâ‰∏ãÊãâÊ°Ü
            let filterOptions = '<option value="">ÊâÄÊúâÂàÜÁ±ª</option>';
            categoryConfig.categories.forEach(category => {
                filterOptions += `<option value="${category.id}">${category.name}</option>`;
            });
            filterSelect.innerHTML = filterOptions;
        }

        // Ê∑ªÂä†Êñ∞ÂàÜÁ±ª
        function addCategory() {
            const name = document.getElementById('categoryName').value.trim();
            const description = document.getElementById('categoryDesc').value.trim();
            const color = document.getElementById('categoryColor').value;

            if (!name) {
                alert('ËØ∑ËæìÂÖ•ÂàÜÁ±ªÂêçÁß∞');
                return;
            }

            const newCategory = {
                id: 'cat_' + Date.now(),
                name: name,
                description: description,
                color: color
            };

            categoryConfig.categories.push(newCategory);
            saveCategories();
            refreshCategoryManagement();
            
            // Ê∏ÖÁ©∫Ë°®Âçï
            document.getElementById('categoryName').value = '';
            document.getElementById('categoryDesc').value = '';
            document.getElementById('categoryColor').value = '#4CAF50';

            showStatus('ÂàÜÁ±ªÊ∑ªÂä†ÊàêÂäü', 'success');
            logOperation('category_add', { categoryName: name });
        }

        // Ëé∑ÂèñÂàÜÁ±ª‰∏ãÁöÑÂØÜÁ†ÅÊï∞Èáè
        function getPasswordCountByCategory(categoryId) {
            let count = 0;
            Object.values(passwordConfig.tempPasswords).forEach(password => {
                if ((password.category || 'default') === categoryId) {
                    count++;
                }
            });
            return count;
        }

        // Âà†Èô§ÂàÜÁ±ª
        function deleteCategory(categoryId) {
            if (categoryId === 'default') {
                alert('ÈªòËÆ§ÂàÜÁ±ª‰∏çËÉΩÂà†Èô§');
                return;
            }

            if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™ÂàÜÁ±ªÂêóÔºüËØ•ÂàÜÁ±ª‰∏ãÁöÑÂØÜÁ†ÅÂ∞ÜÁßªÂà∞ÈªòËÆ§ÂàÜÁ±ª„ÄÇ')) {
                // Â∞ÜËØ•ÂàÜÁ±ª‰∏ãÁöÑÂØÜÁ†ÅÁßªÂà∞ÈªòËÆ§ÂàÜÁ±ª
                Object.values(passwordConfig.tempPasswords).forEach(password => {
                    if (password.category === categoryId) {
                        password.category = 'default';
                    }
                });

                // Âà†Èô§ÂàÜÁ±ª
                categoryConfig.categories = categoryConfig.categories.filter(cat => cat.id !== categoryId);
                saveCategories();
                saveTempPasswords();
                refreshCategoryManagement();
                
                showStatus('ÂàÜÁ±ªÂà†Èô§ÊàêÂäü', 'success');
                logOperation('category_delete', { categoryId: categoryId });
            }
        }

        // Á≠õÈÄâÂØÜÁ†Å
        function filterPasswords() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            const tagFilter = document.getElementById('tagFilter').value.toLowerCase();
            
            refreshPasswordList(categoryFilter, tagFilter);
        }

        // ========== ÁõëÊéßÂëäË≠¶ÂäüËÉΩ ==========
        
        // ÁõëÊéßÈÖçÁΩÆ
        const monitoringConfig = {
            alerts: JSON.parse(localStorage.getItem('monitoring_alerts') || '[]'),
            settings: JSON.parse(localStorage.getItem('monitoring_settings') || '{}'),
            getDefaultSettings() {
                return {
                    enableEmailAlerts: false,
                    enableBrowserNotifications: true,
                    expiryWarningDays: 7,
                    usageWarningPercent: 80,
                    maxLoginAttempts: 5,
                    monitoringInterval: 300000 // 5ÂàÜÈíü
                };
            }
        };

        // ÂàùÂßãÂåñÁõëÊéßÈÖçÁΩÆ
        function initMonitoring() {
            if (Object.keys(monitoringConfig.settings).length === 0) {
                monitoringConfig.settings = monitoringConfig.getDefaultSettings();
                saveMonitoringSettings();
            }
            startMonitoring();
        }

        // ‰øùÂ≠òÁõëÊéßËÆæÁΩÆ
        function saveMonitoringSettings() {
            localStorage.setItem('monitoring_settings', JSON.stringify(monitoringConfig.settings));
        }

        // ‰øùÂ≠òÂëäË≠¶ËÆ∞ÂΩï
        function saveAlerts() {
            localStorage.setItem('monitoring_alerts', JSON.stringify(monitoringConfig.alerts));
        }

        // Âà∑Êñ∞ÁõëÊéßÊï∞ÊçÆ
        function refreshMonitoringData() {
            initMonitoring();
            updateMonitoringStats();
            updateAlertsList();
        }

        // Êõ¥Êñ∞ÁõëÊéßÁªüËÆ°
        function updateMonitoringStats() {
            const stats = getMonitoringStats();
            
            const elements = {
                'expiringPasswords': stats.expiringPasswords,
                'overusedPasswords': stats.overusedPasswords,
                'failedLogins': stats.failedLogins,
                'activeAlerts': monitoringConfig.alerts.filter(a => a.status === 'active').length
            };

            Object.entries(elements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
        }

        // Ëé∑ÂèñÁõëÊéßÁªüËÆ°Êï∞ÊçÆ
        function getMonitoringStats() {
            const now = new Date();
            const warningTime = new Date(now.getTime() + monitoringConfig.settings.expiryWarningDays * 24 * 60 * 60 * 1000);
            
            let expiringPasswords = 0;
            let overusedPasswords = 0;
            
            Object.values(passwordConfig.tempPasswords).forEach(password => {
                const expiresAt = new Date(password.expiresAt);
                if (expiresAt <= warningTime && expiresAt > now) {
                    expiringPasswords++;
                }
                
                const usagePercent = (password.usageCount / password.maxUsage) * 100;
                if (usagePercent >= monitoringConfig.settings.usageWarningPercent) {
                    overusedPasswords++;
                }
            });

            return {
                expiringPasswords,
                overusedPasswords,
                failedLogins: JSON.parse(sessionStorage.getItem('failed_logins') || '0'),
                totalPasswords: Object.keys(passwordConfig.tempPasswords).length
            };
        }

        // Êõ¥Êñ∞ÂëäË≠¶ÂàóË°®
        function updateAlertsList() {
            const alertsList = document.getElementById('alertsList');
            if (!alertsList) return;

            let html = '';
            const recentAlerts = monitoringConfig.alerts.slice(-10).reverse();
            
            recentAlerts.forEach(alert => {
                const alertClass = `alert-${alert.level}`;
                const timeStr = new Date(alert.timestamp).toLocaleString();
                
                html += `
                    <div class="alert-item ${alertClass}">
                        <strong>[${alert.level.toUpperCase()}]</strong> ${alert.message}
                        <br><small>Êó∂Èó¥: ${timeStr}</small>
                    </div>
                `;
            });

            if (html === '') {
                html = '<p style="text-align: center; color: #666; padding: 20px;">ÊöÇÊó†ÂëäË≠¶‰ø°ÊÅØ</p>';
            }

            alertsList.innerHTML = html;
        }

        // Ê∑ªÂä†ÂëäË≠¶
        function addAlert(level, message, details = {}) {
            const alert = {
                id: 'alert_' + Date.now(),
                level: level, // info, warning, critical
                message: message,
                details: details,
                timestamp: new Date().toISOString(),
                status: 'active'
            };

            monitoringConfig.alerts.push(alert);
            saveAlerts();
            
            // Â¶ÇÊûúÂêØÁî®‰∫ÜÊµèËßàÂô®ÈÄöÁü•
            if (monitoringConfig.settings.enableBrowserNotifications && 'Notification' in window) {
                if (Notification.permission === 'granted') {
                    new Notification(`[${level.toUpperCase()}] Á≥ªÁªüÂëäË≠¶`, {
                        body: message,
                        icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDIyQzEzLjEgMjIgMTQgMjEuMSAxNCAyMEgxMEMxMCAyMS4xIDEwLjkgMjIgMTIgMjJaTTE4IDE2VjExQzE4IDcuOTMgMTYuMzYgNS4zNiAxMy41IDQuNjhWNEMxMy41IDMuMTcgMTIuODMgMi41IDEyIDIuNUMxMS4xNyAyLjUgMTAuNSAzLjE3IDEwLjUgNFY0LjY4QzcuNjMgNS4zNiA2IDcuOTIgNiAxMVYxNkw0IDE4VjE5SDE5VjE4TDE4IDE2WiIgZmlsbD0iIzRDQUY1MCIvPgo8L3N2Zz4K'
                    });
                }
            }

            logOperation('alert_generated', { level, message });
        }

        // ÂêØÂä®ÁõëÊéß
        function startMonitoring() {
            // Ê£ÄÊü•Âç≥Â∞ÜËøáÊúüÁöÑÂØÜÁ†Å
            checkExpiringPasswords();
            
            // Ê£ÄÊü•‰ΩøÁî®ÁéáËøáÈ´òÁöÑÂØÜÁ†Å
            checkOverusedPasswords();
            
            // ËÆæÁΩÆÂÆöÊó∂Ê£ÄÊü•
            if (window.monitoringInterval) {
                clearInterval(window.monitoringInterval);
            }
            
            window.monitoringInterval = setInterval(() => {
                checkExpiringPasswords();
                checkOverusedPasswords();
                updateMonitoringStats();
            }, monitoringConfig.settings.monitoringInterval);
        }

        // Ê£ÄÊü•Âç≥Â∞ÜËøáÊúüÁöÑÂØÜÁ†Å
        function checkExpiringPasswords() {
            const now = new Date();
            const warningTime = new Date(now.getTime() + monitoringConfig.settings.expiryWarningDays * 24 * 60 * 60 * 1000);
            
            Object.entries(passwordConfig.tempPasswords).forEach(([password, config]) => {
                const expiresAt = new Date(config.expiresAt);
                if (expiresAt <= warningTime && expiresAt > now) {
                    const daysLeft = Math.ceil((expiresAt - now) / (1000 * 60 * 60 * 24));
                    addAlert('warning', `ÂØÜÁ†Å ${password} Â∞ÜÂú® ${daysLeft} Â§©ÂêéËøáÊúü`, { 
                        password: password,
                        expiresAt: config.expiresAt,
                        daysLeft: daysLeft
                    });
                }
            });
        }

        // Ê£ÄÊü•‰ΩøÁî®ÁéáËøáÈ´òÁöÑÂØÜÁ†Å
        function checkOverusedPasswords() {
            Object.entries(passwordConfig.tempPasswords).forEach(([password, config]) => {
                const usagePercent = (config.usageCount / config.maxUsage) * 100;
                if (usagePercent >= monitoringConfig.settings.usageWarningPercent) {
                    addAlert('warning', `ÂØÜÁ†Å ${password} ‰ΩøÁî®ÁéáÂ∑≤Ëææ ${usagePercent.toFixed(1)}%`, {
                        password: password,
                        usagePercent: usagePercent,
                        usageCount: config.usageCount,
                        maxUsage: config.maxUsage
                    });
                }
            });
        }

        // Êõ¥Êñ∞ÁõëÊéßËÆæÁΩÆ
        function updateMonitoringSettings() {
            const settings = {
                enableBrowserNotifications: document.getElementById('enableNotifications').checked,
                expiryWarningDays: parseInt(document.getElementById('expiryWarningDays').value),
                usageWarningPercent: parseInt(document.getElementById('usageWarningPercent').value),
                monitoringInterval: parseInt(document.getElementById('monitoringInterval').value) * 1000
            };

            monitoringConfig.settings = { ...monitoringConfig.settings, ...settings };
            saveMonitoringSettings();
            
            // ÈáçÂêØÁõëÊéß
            startMonitoring();
            
            showStatus('ÁõëÊéßËÆæÁΩÆÂ∑≤Êõ¥Êñ∞', 'success');
            logOperation('monitoring_settings_update', settings);
        }

        // Êõ¥Êñ∞ÈòàÂÄºÊòæÁ§∫
        function updateThresholdDisplay() {
            const threshold = document.getElementById('usageWarningPercent');
            const display = document.getElementById('thresholdDisplay');
            if (threshold && display) {
                display.textContent = threshold.value + '%';
            }
        }

        // ÁºñËæëÂàÜÁ±ª
        function editCategory(categoryId) {
            const category = categoryConfig.categories.find(cat => cat.id === categoryId);
            if (!category) {
                alert('ÂàÜÁ±ª‰∏çÂ≠òÂú®');
                return;
            }

            const newName = prompt('ËØ∑ËæìÂÖ•Êñ∞ÁöÑÂàÜÁ±ªÂêçÁß∞:', category.name);
            if (newName && newName.trim() !== '' && newName !== category.name) {
                category.name = newName.trim();
                
                const newDesc = prompt('ËØ∑ËæìÂÖ•Êñ∞ÁöÑÂàÜÁ±ªÊèèËø∞:', category.description || '');
                if (newDesc !== null) {
                    category.description = newDesc.trim();
                }
                
                const newColor = prompt('ËØ∑ËæìÂÖ•Êñ∞ÁöÑÂàÜÁ±ªÈ¢úËâ≤ (ÂçÅÂÖ≠ËøõÂà∂):', category.color);
                if (newColor && /^#[0-9A-F]{6}$/i.test(newColor)) {
                    category.color = newColor;
                }
                
                saveCategories();
                refreshCategoryManagement();
                showStatus('ÂàÜÁ±ªÊõ¥Êñ∞ÊàêÂäü', 'success');
                logOperation('category_edit', { categoryId, newName, newDesc, newColor });
            }
        }

        // ÊåâÂàÜÁªÑÁ≠õÈÄâÂØÜÁ†ÅÔºàÂ¢ûÂº∫ÁâàÔºâ
        function refreshPasswordList(categoryFilter = '', tagFilter = '') {
            const passwordList = document.getElementById('passwordList');
            const categoryPasswordsList = document.getElementById('categoryPasswordsList');
            const now = new Date();
            
            let html = '';
            let filteredPasswords = Object.entries(passwordConfig.tempPasswords);
            
            // Â∫îÁî®ÂàÜÁ±ªÁ≠õÈÄâ
            if (categoryFilter) {
                filteredPasswords = filteredPasswords.filter(([_, config]) => 
                    (config.category || 'default') === categoryFilter
                );
            }
            
            // Â∫îÁî®Ê†áÁ≠æÁ≠õÈÄâ
            if (tagFilter) {
                filteredPasswords = filteredPasswords.filter(([_, config]) => 
                    config.tags && config.tags.toLowerCase().includes(tagFilter.toLowerCase())
                );
            }
            
            filteredPasswords.forEach(([password, config]) => {
                const expiresAt = new Date(config.expiresAt);
                const isExpired = now > expiresAt;
                const usageExceeded = config.usageCount >= config.maxUsage;
                
                let statusClass = '';
                if (isExpired) statusClass = 'expired';
                else if (usageExceeded) statusClass = 'usage-exceeded';
                
                const remainingDays = Math.ceil((expiresAt - now) / (1000 * 60 * 60 * 24));
                const remainingUsage = config.maxUsage - config.usageCount;
                
                // Ëé∑ÂèñÂàÜÁ±ª‰ø°ÊÅØ
                const category = categoryConfig.categories.find(cat => cat.id === (config.category || 'default'));
                const categoryName = category ? category.name : 'ÈªòËÆ§ÂàÜÁ±ª';
                const categoryColor = category ? category.color : '#666666';
                
                html += `
                    <div class="password-item ${statusClass}">
                        <div class="password-info">
                            <div class="password-text">${password}</div>
                            <div class="password-meta">
                                <span style="color: ${categoryColor}; font-weight: bold;">[${categoryName}]</span>
                                ${config.tags ? `<span style="color: #888;"> #${config.tags}</span>` : ''}<br>
                                Âà∞Êúü: ${expiresAt.toLocaleDateString()} (${isExpired ? 'Â∑≤ËøáÊúü' : remainingDays + 'Â§©'}) | 
                                ‰ΩøÁî®: ${config.usageCount}/${config.maxUsage} (Ââ©‰Ωô${remainingUsage}Ê¨°) |
                                ÂàõÂª∫: ${new Date(config.createdAt).toLocaleDateString()}
                            </div>
                        </div>
                        <div class="password-actions">
                            <button class="action-btn extend-btn" onclick="extendPassword('${password}')">Âª∂Êúü</button>
                            <button class="action-btn usage-btn" onclick="addUsageCount('${password}')">+Ê¨°Êï∞</button>
                            <button class="action-btn delete-btn" onclick="deletePassword('${password}')">Âà†Èô§</button>
                        </div>
                    </div>
                `;
            });
            
            if (html === '') {
                html = '<p style="text-align: center; color: #666; padding: 20px;">ÊöÇÊó†Á¨¶ÂêàÊù°‰ª∂ÁöÑÂØÜÁ†Å</p>';
            }
            
            if (passwordList) passwordList.innerHTML = html;
            if (categoryPasswordsList) categoryPasswordsList.innerHTML = html;
        }

        // È°µÈù¢Âä†ËΩΩÊó∂ÁöÑÁÆÄÂåñÂàùÂßãÂåñ
        window.addEventListener('load', function() {
            console.log('È°µÈù¢Âä†ËΩΩÂÆåÊàê');
            
            // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁôªÂΩï
            if (sessionStorage.getItem('authenticated') === 'true') {
                const overlay = document.getElementById('passwordOverlay');
                const mainApp = document.getElementById('mainApp');
                
                if (overlay) overlay.style.display = 'none';
                if (mainApp) mainApp.classList.add('authenticated');
            }
            
            // ËÆæÁΩÆÂõûËΩ¶ÈîÆÁõëÂê¨
            const passwordInput = document.getElementById('passwordInput');
            if (passwordInput) {
                passwordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        window.verifyPassword();
                    }
                });
                passwordInput.focus();
            }

            // ÂàùÂßãÂåñÂàÜÁ±ªÂíåÁõëÊéßÂäüËÉΩ
            initCategories();
            initMonitoring();
        });
    </script>
</body>
</html>