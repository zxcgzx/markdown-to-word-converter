<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarkdownËΩ¨WordÊ†ºÂºèËΩ¨Êç¢Âô®</title>
    <script src="https://cdn.jsdelivr.net/npm/marked@9.0.0/marked.min.js"></script>
    <script src="https://unpkg.com/docx@7.8.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- KaTeXÊï∞Â≠¶ÂÖ¨ÂºèÊîØÊåÅ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    <style>
        /* Ê∏©ÊöñÁê•ÁèÄ‰∏ªÈ¢ò‰Ωú‰∏∫ÈªòËÆ§‰∏ªÈ¢ò */
        :root {
            --bg-gradient-start: #ffeaa7;
            --bg-gradient-end: #fab1a0;
            --container-bg: rgba(255, 255, 255, 0.95);
            --header-gradient-start: #0984e3;
            --header-gradient-end: #00b894;
            --text-primary: #2d3436;
            --text-secondary: #636e72;
            --text-muted: #b2bec3;
            --text-white: #ffffff;
            --border-color: rgba(255, 234, 167, 0.6);
            --border-focus: #0984e3;
            --preview-bg: rgba(255, 255, 255, 0.8);
            --controls-bg: rgba(255, 255, 255, 0.9);
            --card-bg: rgba(255, 255, 255, 0.85);
            --accent-primary: #0984e3;
            --accent-secondary: #00b894;
            --success: #00b894;
            --warning: #e17055;
            --info: #74b9ff;
            --shadow: rgba(255, 177, 160, 0.2);
            --shadow-hover: rgba(9, 132, 227, 0.15);
            --shadow-focus: rgba(9, 132, 227, 0.25);
            --transition: all 0.18s ease-out;
            --blur: blur(15px);
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 234, 167, 0.3);
        }

        /* ÁªèÂÖ∏‰∏ªÈ¢ò - ÂéüÂßãÈÖçËâ≤ÊñπÊ°à */
        [data-theme="classic"] {
            --bg-gradient-start: #667eea;
            --bg-gradient-end: #764ba2;
            --container-bg: #ffffff;
            --header-gradient-start: #4CAF50;
            --header-gradient-end: #45a049;
            --text-primary: #333333;
            --text-secondary: #666666;
            --text-muted: #999999;
            --text-white: #ffffff;
            --border-color: #e0e0e0;
            --border-focus: #4CAF50;
            --preview-bg: #fafafa;
            --controls-bg: #f8f9fa;
            --card-bg: #ffffff;
            --accent-primary: #4CAF50;
            --accent-secondary: #2196F3;
            --success: #4CAF50;
            --warning: #ff9800;
            --info: #2196F3;
            --shadow: rgba(0, 0, 0, 0.1);
            --shadow-hover: rgba(76, 175, 80, 0.3);
            --shadow-focus: rgba(76, 175, 80, 0.4);
            --transition: all 0.3s ease;
            --blur: blur(8px);
            --glass-bg: #ffffff;
            --glass-border: #e0e0e0;
        }

        /* ÁªèÂÖ∏‰∏ªÈ¢òÁâπÊÆäÊ†∑ÂºèÂ§ÑÁêÜ */
        [data-theme="classic"] .container {
            background: var(--container-bg);
            border-radius: 15px;
            box-shadow: 0 20px 40px var(--shadow);
            backdrop-filter: none;
            border: none;
        }

        [data-theme="classic"] .btn {
            backdrop-filter: none;
            border: none;
            box-shadow: 0 4px 15px var(--shadow-hover);
        }

        [data-theme="classic"] .btn-secondary {
            backdrop-filter: none;
            box-shadow: 0 1px 3px var(--shadow);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            padding: 10px;
            margin: 0;
            transition: var(--transition);
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: float 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(10px, -10px) rotate(1deg); }
            66% { transform: translate(-5px, 5px) rotate(-1deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--glass-bg);
            border-radius: 24px;
            box-shadow: 
                0 8px 32px var(--shadow),
                0 0 0 1px var(--glass-border),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--blur);
            overflow: hidden;
            min-height: calc(100vh - 20px);
            transition: var(--transition);
            position: relative;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--glass-border), transparent);
        }

        .header {
            background: linear-gradient(135deg, var(--header-gradient-start), var(--header-gradient-end));
            color: var(--text-white);
            text-align: center;
            padding: 32px;
            position: relative;
            transition: var(--transition);
            backdrop-filter: var(--blur);
            box-shadow: 0 1px 0 0 rgba(255, 255, 255, 0.1) inset;
        }

        /* ‰∏ªÈ¢òÂàáÊç¢Âô®Ê†∑Âºè */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 8px 16px;
            color: var(--text-white);
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 8px;
            overflow: hidden;
            position: relative;
        }

        .theme-toggle::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px) scale(1.02);
        }

        .theme-toggle:hover::after {
            left: 100%;
        }

        .theme-toggle.switching {
            animation: themeSwitch 0.8s ease;
        }

        .theme-toggle::before {
            content: 'üé®';
            font-size: 16px;
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover::before {
            transform: rotate(180deg);
        }

        @keyframes themeSwitch {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(90deg); }
            50% { transform: scale(1.05) rotate(180deg); }
            75% { transform: scale(1.1) rotate(270deg); }
            100% { transform: scale(1) rotate(360deg); }
        }

        /* ‰∏ªÈ¢òÂàáÊç¢ËøáÊ∏°ÊïàÊûú */
        .theme-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at var(--mouse-x, 50%) var(--mouse-y, 50%), var(--new-bg) 0%, transparent 70%);
            pointer-events: none;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.6s ease;
        }

        .theme-transition.active {
            opacity: 1;
        }

        /* Êó†ÈöúÁ¢çÊîØÊåÅ */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* È´òÂØπÊØîÂ∫¶Ê®°ÂºèÊîØÊåÅ */
        @media (prefers-contrast: high) {
            :root {
                --text-primary: #000000;
                --text-secondary: #333333;
                --border-color: #000000;
                --border-focus: #0000ff;
                --accent-primary: #0000ff;
                --accent-secondary: #000080;
            }
        }

        /* ÂáèÂ∞ëÂä®ÁîªÊ®°ÂºèÊîØÊåÅ */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .theme-toggle.switching {
                animation: none;
            }
            
            .theme-transition {
                transition: none;
            }
        }

        /* ÈîÆÁõòÁÑ¶ÁÇπÊåáÁ§∫Âô® */
        .btn:focus-visible,
        .theme-toggle:focus-visible,
        #markdownInput:focus-visible,
        .password-input:focus-visible {
            outline: 3px solid var(--border-focus);
            outline-offset: 2px;
        }

        .quick-action-btn:focus-visible {
            outline: 2px solid var(--accent-primary);
            outline-offset: 1px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .author-info {
            font-size: 0.9em;
            opacity: 0.8;
            font-style: italic;
        }

        .author-info .author-name {
            font-weight: bold;
            color: #E8F5E8;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            min-height: 500px;
        }

        .input-section, .preview-section {
            display: flex;
            flex-direction: column;
        }

        .section-title {
            font-size: 1.3em;
            color: var(--text-primary);
            margin-bottom: 15px;
            font-weight: 600;
            transition: var(--transition);
        }

        #markdownInput {
            width: 100%;
            height: 400px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: var(--transition);
            line-height: 1.5;
            background: var(--container-bg);
            color: var(--text-primary);
        }

        #markdownInput:focus {
            outline: none;
            border-color: var(--border-focus);
        }

        #preview {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            min-height: 400px;
            background: var(--preview-bg);
            overflow-y: auto;
            transition: var(--transition);
            color: var(--text-primary);
        }

        .controls {
            padding: 30px;
            background: var(--controls-bg);
            border-top: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .control-group {
            background: var(--glass-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: var(--blur);
            transition: var(--transition);
        }

        .control-group:hover {
            border-color: var(--border-focus);
            transform: translateY(-1px);
        }

        .control-group-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-group-desc {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 16px;
            line-height: 1.4;
        }

        .control-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .control-buttons .btn {
            margin: 0;
            flex: 1;
            min-width: 120px;
        }

        @media (max-width: 768px) {
            .controls-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            
            .control-buttons {
                flex-direction: column;
            }
            
            .control-buttons .btn {
                min-width: unset;
            }
        }

        .btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--text-white);
            border: none;
            padding: 14px 28px;
            font-size: 15px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            margin: 0 8px;
            transition: var(--transition);
            box-shadow: 
                0 4px 14px var(--shadow-hover),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            backdrop-filter: var(--blur);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 24px var(--shadow-focus),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            filter: brightness(1.05) saturate(1.1);
        }

        .btn:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 14px var(--shadow-hover);
        }

        .example-section {
            margin: 20px 0;
        }

        .example-btn {
            background: #2196F3;
            font-size: 14px;
            padding: 8px 20px;
        }

        .example-btn:hover {
            background: #1976D2;
        }

        /* Âπ≥ÊùøÁ´Ø‰ºòÂåñ */
        @media (max-width: 1024px) {
            .container {
                margin: 5px;
                border-radius: 10px;
            }
            
            .main-content {
                padding: 15px;
                gap: 15px;
            }
        }

        /* ÁßªÂä®Á´Ø‰ºòÂåñ */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            .container {
                border-radius: 8px;
                min-height: calc(100vh - 10px);
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 1.8em;
                margin-bottom: 8px;
            }
            
            .header p {
                font-size: 1em;
                margin-bottom: 10px;
            }
            
            .author-info {
                font-size: 0.8em;
            }
            
            .main-content {
                grid-template-columns: 1fr;
                padding: 15px;
                gap: 20px;
            }
            
            #markdownInput {
                height: 300px;
                font-size: 16px; /* Èò≤Ê≠¢iOSÁº©Êîæ */
                padding: 12px;
            }
            
            #preview {
                min-height: 300px;
                padding: 15px;
            }
            
            .controls {
                padding: 20px 15px;
                text-align: center;
            }
            
            .btn {
                margin: 5px;
                padding: 12px 20px;
                font-size: 14px;
                display: inline-block;
                min-width: 120px;
            }
            
            .btn-secondary {
                padding: 10px 16px;
                font-size: 13px;
                min-width: 100px;
            }
            
            .shortcut-info {
                font-size: 0.8em;
                margin-top: 10px;
                line-height: 1.4;
            }
            
            .word-count {
                position: static;
                margin-top: 5px;
                text-align: right;
                background: none;
                font-size: 11px;
            }
            
            .drag-hint::after {
                font-size: 11px;
                bottom: -20px;
            }
        }

        /* Â∞èÂ±èÊâãÊú∫‰ºòÂåñ */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .header p {
                font-size: 0.9em;
            }
            
            .author-info {
                font-size: 0.75em;
            }
            
            .main-content {
                padding: 10px;
            }
            
            #markdownInput {
                height: 250px;
                padding: 10px;
                font-size: 16px;
            }
            
            #preview {
                min-height: 250px;
                padding: 12px;
            }
            
            .controls {
                padding: 15px 10px;
            }
            
            .btn {
                width: calc(50% - 10px);
                margin: 3px 5px;
                padding: 10px 8px;
                font-size: 13px;
            }
            
            .btn-secondary {
                width: calc(50% - 10px);
                margin: 3px 5px;
                padding: 8px 6px;
                font-size: 12px;
            }
            
            .shortcut-info {
                font-size: 0.7em;
                padding: 0 5px;
            }
            
            .section-title {
                font-size: 1.1em;
                margin-bottom: 10px;
            }
        }

        /* È¢ÑËßàÊ†∑Âºè */
        #preview h1, #preview h2, #preview h3, #preview h4, #preview h5, #preview h6 {
            color: #333;
            margin: 20px 0 10px 0;
        }

        #preview h1 { font-size: 2em; }
        #preview h2 { font-size: 1.7em; }
        #preview h3 { font-size: 1.4em; }

        #preview p {
            margin: 10px 0;
            line-height: 1.6;
        }

        #preview ul, #preview ol {
            margin: 10px 0;
            padding-left: 30px;
        }

        #preview li {
            margin: 5px 0;
        }

        #preview code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }

        #preview pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
        }

        #preview blockquote {
            border-left: 4px solid #4CAF50;
            margin: 15px 0;
            padding: 10px 20px;
            background: #f9f9f9;
        }

        #preview table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
        }

        #preview th, #preview td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        #preview th {
            background-color: #f2f2f2;
        }

        /* È¢ÑËßàÂå∫Á©∫Áä∂ÊÄÅ */
        .preview-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            min-height: 350px;
            text-align: center;
            color: var(--text-muted);
            background: linear-gradient(135deg, var(--preview-bg) 0%, rgba(255, 255, 255, 0.5) 100%);
            border-radius: 8px;
        }

        .preview-empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.6;
            animation: float-gentle 3s ease-in-out infinite;
        }

        .preview-empty-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .preview-empty-subtitle {
            font-size: 14px;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .preview-quick-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .quick-action-btn {
            padding: 8px 16px;
            background: var(--glass-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: var(--blur);
        }

        .quick-action-btn:hover {
            background: var(--accent-primary);
            color: var(--text-white);
            border-color: var(--accent-primary);
            transform: translateY(-1px);
        }

        @keyframes float-gentle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        /* Ëá™ÂÆö‰πâÁ°ÆËÆ§ÂØπËØùÊ°Ü */
        .custom-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .custom-dialog.show {
            opacity: 1;
            visibility: visible;
        }

        .dialog-content {
            background: var(--glass-bg);
            border-radius: 16px;
            padding: 24px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.15),
                0 0 0 1px var(--glass-border);
            backdrop-filter: var(--blur);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .custom-dialog.show .dialog-content {
            transform: scale(1);
        }

        .dialog-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .dialog-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .dialog-message {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .dialog-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .dialog-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .dialog-btn-primary {
            background: var(--accent-primary);
            color: var(--text-white);
        }

        .dialog-btn-primary:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
        }

        .dialog-btn-secondary {
            background: var(--glass-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .dialog-btn-secondary:hover {
            background: var(--preview-bg);
            border-color: var(--border-focus);
        }

        /* ToastÈÄöÁü•Ê†∑Âºè */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10002;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .toast {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 12px 16px;
            max-width: 300px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            backdrop-filter: var(--blur);
            transform: translateX(320px);
            transition: all 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-icon {
            font-size: 18px;
            flex-shrink: 0;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .toast-message {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .toast.success {
            border-color: var(--success);
        }

        .toast.success .toast-icon {
            color: var(--success);
        }

        .toast.error {
            border-color: var(--warning);
        }

        .toast.error .toast-icon {
            color: var(--warning);
        }

        .toast.info {
            border-color: var(--info);
        }

        .toast.info .toast-icon {
            color: var(--info);
        }

        /* ÊãñÊãΩÊèêÁ§∫Ê†∑Âºè */
        .drag-hint {
            position: relative;
        }

        .drag-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-white);
            font-size: 18px;
            font-weight: 600;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 10;
            backdrop-filter: blur(10px);
            border: 3px dashed rgba(255, 255, 255, 0.8);
        }

        .drag-overlay.show {
            opacity: 0.95;
            visibility: visible;
        }

        .drag-overlay-icon {
            font-size: 48px;
            margin-bottom: 12px;
            animation: bounce 1s infinite;
        }

        .drag-overlay-text {
            text-align: center;
            line-height: 1.4;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Êï∞Â≠¶ÂÖ¨ÂºèÊ∏≤ÊüìÁä∂ÊÄÅÊåáÁ§∫Âô® */
        .math-rendering-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--info);
            color: var(--text-white);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            display: none;
            align-items: center;
            gap: 4px;
            z-index: 5;
            animation: pulse 1.5s infinite;
        }

        .math-rendering-indicator.show {
            display: flex;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Êï∞Â≠¶ÂÖ¨ÂºèÊ∏≤ÊüìÈîôËØØÊèêÁ§∫ */
        .math-error {
            background: var(--warning);
            color: var(--text-white);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            margin: 5px 0;
            display: inline-block;
        }

        .drag-hint-text {
            position: absolute;
            bottom: -30px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 12px;
            color: var(--text-muted);
            opacity: 0.8;
            transition: var(--transition);
        }

        .drag-hint-text::before {
            content: "üí° ";
        }

        /* Âø´Êç∑ÈîÆÊèêÁ§∫ */
        .shortcut-info {
            margin-top: 15px;
            font-size: 0.9em;
            color: #666;
            text-align: center;
        }

        .shortcut-info strong {
            color: #4CAF50;
        }

        /* Áä∂ÊÄÅÊåáÁ§∫Âô® */
        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 8px 15px;
            background: #4CAF50;
            color: white;
            border-radius: 20px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .status-indicator.show {
            opacity: 1;
        }

        .status-indicator.error {
            background: #f44336;
        }

        .status-indicator.info {
            background: #2196F3;
        }

        /* ÊîπËøõÊåâÈíÆÊ†∑Âºè */
        .btn-secondary {
            background: var(--glass-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            box-shadow: 
                0 2px 8px var(--shadow),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            font-size: 14px;
            padding: 10px 20px;
        }

        .btn-secondary:hover {
            background: var(--preview-bg);
            border-color: var(--border-focus);
            color: var(--accent-primary);
            transform: translateY(-1px);
            box-shadow: 
                0 4px 12px var(--shadow-hover),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        /* Êñá‰ª∂ËæìÂÖ•Âå∫Âüü‰ºòÂåñ */
        .input-section {
            position: relative;
        }

        /* Â≠óÊï∞ÁªüËÆ° */
        .input-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            padding: 8px 12px;
            background: var(--glass-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 12px;
            color: var(--text-secondary);
            backdrop-filter: var(--blur);
            transition: var(--transition);
        }

        .input-stats .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .input-stats .stat-value {
            font-weight: 600;
            color: var(--accent-primary);
            font-size: 14px;
        }

        .input-stats .stat-label {
            font-size: 11px;
            opacity: 0.8;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 0%;
        }

        /* ÂØÜÁ†ÅÈ™åËØÅÁïåÈù¢Ê†∑Âºè */
        .password-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .password-modal {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .password-modal h2 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        .password-modal .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1em;
        }

        .password-modal .beta-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-size: 0.9em;
        }

        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
            transition: border-color 0.3s;
        }

        .password-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .password-btn {
            width: 100%;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px;
            font-size: 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
        }

        .password-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .password-error {
            color: #f44336;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .password-hint {
            color: #666;
            font-size: 12px;
            margin-top: 15px;
            line-height: 1.4;
        }

        /* ÈöêËóè‰∏ªÂÜÖÂÆπ */
        .main-app {
            display: none;
        }

        .main-app.authenticated {
            display: block;
        }

        /* ÂØÜÁ†ÅÁïåÈù¢ÁßªÂä®Á´ØÈÄÇÈÖç */
        @media (max-width: 768px) {
            .password-overlay {
                padding: 10px;
            }
            
            .password-modal {
                padding: 30px 20px;
                margin: 0;
                max-width: none;
                width: 100%;
                max-height: 90vh;
                overflow-y: auto;
                position: relative;
                animation: slideUpMobile 0.4s ease-out;
            }
            
            .password-modal h2 {
                font-size: 1.5em;
                margin-bottom: 8px;
            }
            
            .password-modal .subtitle {
                font-size: 1em;
                margin-bottom: 20px;
            }
            
            .password-modal .beta-info {
                font-size: 0.85em;
                padding: 12px;
                margin-bottom: 20px;
                line-height: 1.4;
            }
            
            .password-input {
                font-size: 16px; /* Èò≤Ê≠¢iOSÁº©Êîæ */
                padding: 16px;
                margin-bottom: 16px;
            }
            
            .password-btn {
                padding: 16px;
                font-size: 16px;
                margin-bottom: 12px;
            }
            
            .password-hint {
                font-size: 12px;
                margin-top: 12px;
                line-height: 1.5;
            }
        }

        @media (max-width: 480px) {
            .password-overlay {
                padding: 5px;
            }
            
            .password-modal {
                padding: 25px 15px;
                border-radius: 12px;
                animation: slideUpMobile 0.3s ease-out;
            }
            
            .password-modal h2 {
                font-size: 1.3em;
                margin-bottom: 6px;
            }
            
            .password-modal .subtitle {
                font-size: 0.9em;
                margin-bottom: 16px;
            }
            
            .password-modal .beta-info {
                font-size: 0.8em;
                padding: 10px;
                margin-bottom: 16px;
                border-radius: 6px;
            }
            
            .password-input {
                padding: 14px;
                font-size: 16px;
                border-radius: 8px;
                margin-bottom: 14px;
            }
            
            .password-btn {
                padding: 14px;
                font-size: 15px;
                border-radius: 8px;
                margin-bottom: 10px;
            }
            
            .password-hint {
                font-size: 11px;
                margin-top: 10px;
                padding: 0 5px;
            }
        }

        @keyframes slideUpMobile {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* ÁßªÂä®Á´ØÈîÆÁõòÈÄÇÈÖç */
        @media (max-height: 600px) and (max-width: 768px) {
            .password-overlay {
                align-items: flex-start;
                padding-top: 20px;
            }
            
            .password-modal {
                margin-top: 0;
                max-height: calc(100vh - 40px);
            }
            
            .password-modal h2 {
                font-size: 1.2em;
            }
            
            .password-modal .beta-info {
                font-size: 0.75em;
                padding: 8px;
                margin-bottom: 12px;
            }
            
            .password-hint {
                font-size: 10px;
                margin-top: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- ÂØÜÁ†ÅÈ™åËØÅÁïåÈù¢ -->
    <div id="passwordOverlay" class="password-overlay" role="dialog" aria-labelledby="passwordTitle" aria-describedby="passwordDesc">
        <div class="password-modal">
            <h2 id="passwordTitle">üîê ËÆøÈóÆÈ™åËØÅ</h2>
            <p class="subtitle" id="passwordDesc">MarkdownËΩ¨WordËΩ¨Êç¢Âô®</p>
            <div class="beta-info" role="alert">
                <strong>‚ö†Ô∏è ‰∏™‰∫∫ÂÜÖÊµãÁâàÊú¨</strong><br>
                Ê≠§ÁâàÊú¨‰ªÖ‰æõÂÜÖÈÉ®ÊµãËØï‰ΩøÁî®ÔºåËØ∑ËæìÂÖ•ËÆøÈóÆÂØÜÁ†Å
            </div>
            <label for="passwordInput" class="visually-hidden">ËÆøÈóÆÂØÜÁ†Å</label>
            <input type="password" id="passwordInput" class="password-input" placeholder="ËØ∑ËæìÂÖ•ËÆøÈóÆÂØÜÁ†Å" maxlength="20" aria-describedby="passwordHint passwordError" autocomplete="current-password">
            <button onclick="verifyPassword()" class="password-btn" aria-describedby="passwordHint">üöÄ ËøõÂÖ•Â∫îÁî®</button>
            <div id="passwordError" class="password-error" role="alert" aria-live="polite">ÂØÜÁ†ÅÈîôËØØÔºåËØ∑ÈáçËØï</div>
            <div class="password-hint" id="passwordHint">
                üí° ÊèêÁ§∫ÔºöÂ¶ÇÈúÄËé∑ÂèñËÆøÈóÆÂØÜÁ†ÅÔºåËØ∑ËÅîÁ≥ªÂºÄÂèëËÄÖ<br>
                <strong>Boning</strong> ¬∑ TJUT
            </div>
        </div>
    </div>

    <!-- ‰∏ªÂ∫îÁî®ÁïåÈù¢ -->
    <div id="mainApp" class="main-app">
        <div class="container">
            <header class="header">
                <button class="theme-toggle" onclick="toggleTheme(event)" title="ÂàáÊç¢‰∏ªÈ¢ò" aria-label="ÂàáÊç¢È¢úËâ≤‰∏ªÈ¢ò">
                    <span id="themeText">Ê∏©ÊöñÁê•ÁèÄ</span>
                </button>
                <h1>üìù MarkdownËΩ¨WordËΩ¨Êç¢Âô®</h1>
                <p>Â∞ÜÊÇ®ÁöÑMarkdownÊñáÊ°£Âø´ÈÄüËΩ¨Êç¢‰∏∫WordÊ†ºÂºè</p>
                <div class="author-info">
                    Áî± <span class="author-name">Boning</span> ÂºÄÂèë ¬∑ TJUT ¬∑ <span style="color: #E8F5E8;">ÂÜÖÊµãÁâà</span>
                </div>
            </header>

        <main class="main-content">
            <section class="input-section drag-hint">
                <h2 class="section-title">üìù ËæìÂÖ•MarkdownÂÜÖÂÆπ</h2>
                <div style="position: relative;">
                    <label for="markdownInput" class="visually-hidden">MarkdownÂÜÖÂÆπËæìÂÖ•Ê°Ü</label>
                    <textarea id="markdownInput" placeholder="Âú®ËøôÈáåËæìÂÖ•ÊÇ®ÁöÑMarkdownÂÜÖÂÆπ..." aria-describedby="inputHelp"

‰æãÂ¶Ç:
# Ê†áÈ¢ò‰∏Ä
## Ê†áÈ¢ò‰∫å
### Ê†áÈ¢ò‰∏â

**Á≤ó‰ΩìÊñáÊú¨**
*Êñú‰ΩìÊñáÊú¨*

- ÂàóË°®È°π1
- ÂàóË°®È°π2
- ÂàóË°®È°π3

> ËøôÊòØ‰∏Ä‰∏™ÂºïÁî®Âùó

```javascript
console.log('Hello World!');
```

[ÈìæÊé•ÊñáÊú¨](https://example.com)

| Ë°®Ê†º | Á§∫‰æã |
|------|------|
| ÂçïÂÖÉÊ†º1 | ÂçïÂÖÉÊ†º2 |
| ÂçïÂÖÉÊ†º3 | ÂçïÂÖÉÊ†º4 |"></textarea>
                    
                    <!-- ÊãñÊãΩË¶ÜÁõñÂ±Ç -->
                    <div class="drag-overlay" id="dragOverlay">
                        <div class="drag-overlay-icon">üìÅ</div>
                        <div class="drag-overlay-text">
                            ÈáäÊîæ‰ª•‰∏ä‰º†MarkdownÊñá‰ª∂<br>
                            <small>ÊîØÊåÅ .md, .markdown, .txt Ê†ºÂºè</small>
                        </div>
                    </div>
                    
                    <!-- ÊãñÊãΩÊèêÁ§∫ÊñáÊú¨ -->
                    <div class="drag-hint-text" id="inputHelp">ÊîØÊåÅÊãñÊãΩ Markdown Êñá‰ª∂Âà∞Ê≠§Â§Ñ‰∏ä‰º†</div>
                </div>
                
                <!-- ËæìÂÖ•ÁªüËÆ°‰ø°ÊÅØ -->
                <div class="input-stats" role="region" aria-label="ÊñáÊ°£ÁªüËÆ°‰ø°ÊÅØ">
                    <div class="stat-item">
                        <div class="stat-value" id="charCount" aria-label="Â≠óÁ¨¶Êï∞">0</div>
                        <div class="stat-label">Â≠óÁ¨¶</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="wordCount" aria-label="ÂçïËØçÊï∞">0</div>
                        <div class="stat-label">ÂçïËØç</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="lineCount" aria-label="Ë°åÊï∞">1</div>
                        <div class="stat-label">Ë°åÊï∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="readTime" aria-label="È¢ÑËÆ°ÈòÖËØªÊó∂Èó¥">0</div>
                        <div class="stat-label">ÈòÖËØªÊó∂Èó¥(ÂàÜ)</div>
                    </div>
                </div>
                
                <div class="example-section" role="group" aria-label="Á§∫‰æãÂÜÖÂÆπ">
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
                        <button class="btn example-btn" onclick="loadExample('simple')" aria-describedby="simpleDesc">üìÑ ÁÆÄÂçïÁ§∫‰æã</button>
                        <button class="btn example-btn" onclick="loadExample('advanced')" aria-describedby="advancedDesc">üöÄ È´òÁ∫ßÁ§∫‰æã</button>
                        <button class="btn example-btn" onclick="loadExample('math')" aria-describedby="mathDesc">üìê Êï∞Â≠¶ÂÖ¨Âºè</button>
                        <button class="btn example-btn" onclick="loadExample('table')" aria-describedby="tableDesc">üìä Ë°®Ê†ºÁ§∫‰æã</button>
                    </div>
                </div>
            </section>

            <section class="preview-section">
                <h2 class="section-title">üëÄ ÂÆûÊó∂È¢ÑËßà</h2>
                <div style="position: relative;">
                    <div id="preview" role="region" aria-label="MarkdownÈ¢ÑËßàÂÜÖÂÆπ" aria-live="polite" aria-atomic="false">
                    <div class="preview-empty">
                        <div class="preview-empty-icon">üìù</div>
                        <div class="preview-empty-title">ÂºÄÂßãÂàõ‰ΩúÊÇ®ÁöÑÊñáÊ°£</div>
                        <div class="preview-empty-subtitle">
                            Âú®Â∑¶‰æßËæìÂÖ•Ê°Ü‰∏≠ËæìÂÖ•MarkdownÂÜÖÂÆπ<br>
                            ÊàñËÄÖ‰ΩøÁî®‰∏ãÊñπÁöÑÂø´ÈÄüÊìç‰Ωú
                        </div>
                        <div class="preview-quick-actions" role="group" aria-label="Âø´ÈÄüÊìç‰Ωú">
                            <button class="quick-action-btn" onclick="loadExample('simple')" aria-label="Âä†ËΩΩÁÆÄÂçïÁ§∫‰æã">üìÑ ÁÆÄÂçïÁ§∫‰æã</button>
                            <button class="quick-action-btn" onclick="loadExample('advanced')" aria-label="Âä†ËΩΩÈ´òÁ∫ßÁ§∫‰æã">üöÄ È´òÁ∫ßÁ§∫‰æã</button>
                            <button class="quick-action-btn" onclick="uploadFile()" aria-label="‰∏ä‰º†MarkdownÊñá‰ª∂">üìÅ ‰∏ä‰º†Êñá‰ª∂</button>
                            <button class="quick-action-btn" onclick="loadFromLocal()" aria-label="Âä†ËΩΩÊú¨Âú∞ËçâÁ®ø">üìÇ Âä†ËΩΩËçâÁ®ø</button>
                        </div>
                    </div>
                    
                    <!-- Êï∞Â≠¶ÂÖ¨ÂºèÊ∏≤ÊüìÁä∂ÊÄÅÊåáÁ§∫Âô® -->
                    <div class="math-rendering-indicator" id="mathIndicator" aria-live="polite" aria-label="Êï∞Â≠¶ÂÖ¨ÂºèÊ∏≤ÊüìÁä∂ÊÄÅ">
                        <span>‚ö°</span>
                        <span>Ê∏≤ÊüìÊï∞Â≠¶ÂÖ¨Âºè...</span>
                    </div>
                </div>
            </section>
        </main>

        <section class="controls" role="group" aria-label="Êìç‰ΩúÊéßÂà∂Èù¢Êùø">
            <div class="controls-grid">
                <!-- ÂØºÂá∫ÂäüËÉΩÁªÑ -->
                <div class="control-group">
                    <div class="control-group-title">
                        <span>üì§</span>
                        <span>ÂØºÂá∫‰∏éÂàÜ‰∫´</span>
                    </div>
                    <div class="control-group-desc">
                        Â∞ÜÊÇ®ÁöÑMarkdownÂÜÖÂÆπÂØºÂá∫‰∏∫‰∏çÂêåÊ†ºÂºèÊàñÂ§çÂà∂Âà∞Ââ™Ë¥¥Êùø
                    </div>
                    <div class="control-buttons" role="group" aria-label="ÂØºÂá∫Êìç‰Ωú">
                        <button class="btn" onclick="downloadWord()" aria-label="‰∏ãËΩΩWordÊñáÊ°£">üìÑ ‰∏ãËΩΩWord</button>
                        <button class="btn" onclick="copyFormattedText()" aria-label="Â§çÂà∂ÂØåÊñáÊú¨Âà∞Ââ™Ë¥¥Êùø">üìã Â§çÂà∂ÂØåÊñáÊú¨</button>
                    </div>
                </div>

                <!-- Êñá‰ª∂ÁÆ°ÁêÜÁªÑ -->
                <div class="control-group">
                    <div class="control-group-title">
                        <span>üìÅ</span>
                        <span>Êñá‰ª∂ÁÆ°ÁêÜ</span>
                    </div>
                    <div class="control-group-desc">
                        ‰∏ä‰º†Â§ñÈÉ®Êñá‰ª∂ÊàñÁÆ°ÁêÜÊú¨Âú∞ËçâÁ®øÔºå‰øùÊåÅÂ∑•‰ΩúËøûÁª≠ÊÄß
                    </div>
                    <div class="control-buttons" role="group" aria-label="Êñá‰ª∂Êìç‰Ωú">
                        <button class="btn btn-secondary" onclick="uploadFile()" aria-label="‰∏ä‰º†MarkdownÊñá‰ª∂">üìÅ ‰∏ä‰º†Êñá‰ª∂</button>
                        <button class="btn btn-secondary" onclick="saveToLocal()" aria-label="‰øùÂ≠òÂΩìÂâçÂÜÖÂÆπ‰∏∫ËçâÁ®ø">üíæ ‰øùÂ≠òËçâÁ®ø</button>
                        <button class="btn btn-secondary" onclick="loadFromLocal()" aria-label="Âä†ËΩΩÊú¨Âú∞‰øùÂ≠òÁöÑËçâÁ®ø">üìÇ Âä†ËΩΩËçâÁ®ø</button>
                    </div>
                </div>

                <!-- ÁºñËæëÂ∑•ÂÖ∑ÁªÑ -->
                <div class="control-group">
                    <div class="control-group-title">
                        <span>‚úèÔ∏è</span>
                        <span>ÁºñËæëÂ∑•ÂÖ∑</span>
                    </div>
                    <div class="control-group-desc">
                        Ê∏ÖÁ©∫ÂΩìÂâçÂÜÖÂÆπÊàñ‰ΩøÁî®ÂÖ∂‰ªñÁºñËæëËæÖÂä©ÂäüËÉΩ
                    </div>
                    <div class="control-buttons" role="group" aria-label="ÁºñËæëÊìç‰Ωú">
                        <button class="btn btn-secondary" onclick="clearContent()" aria-label="Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü‰∏≠ÁöÑÊâÄÊúâÂÜÖÂÆπ">üóëÔ∏è Ê∏ÖÁ©∫ÂÜÖÂÆπ</button>
                        <button class="btn btn-secondary" onclick="showShortcuts()" aria-label="ÊòæÁ§∫ÈîÆÁõòÂø´Êç∑ÈîÆÂ∏ÆÂä©">‚å®Ô∏è Âø´Êç∑ÈîÆ</button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Áä∂ÊÄÅÊåáÁ§∫Âô® -->
        <div id="statusIndicator" class="status-indicator"></div>
        
        <!-- ÈöêËóèÁöÑÊñá‰ª∂ËæìÂÖ• -->
        <input type="file" id="fileInput" accept=".md,.markdown,.txt" style="display: none;" onchange="handleFileUpload(event)">
        
        <!-- ToastÈÄöÁü•ÂÆπÂô® -->
        <div class="toast-container" id="toastContainer"></div>
        
        <!-- Ëá™ÂÆö‰πâÁ°ÆËÆ§ÂØπËØùÊ°Ü -->
        <div class="custom-dialog" id="customDialog">
            <div class="dialog-content">
                <div class="dialog-icon" id="dialogIcon">‚ùì</div>
                <div class="dialog-title" id="dialogTitle">Á°ÆËÆ§Êìç‰Ωú</div>
                <div class="dialog-message" id="dialogMessage">ÊÇ®Á°ÆÂÆöË¶ÅÊâßË°åÊ≠§Êìç‰ΩúÂêóÔºü</div>
                <div class="dialog-buttons">
                    <button class="dialog-btn dialog-btn-secondary" id="dialogCancel">ÂèñÊ∂à</button>
                    <button class="dialog-btn dialog-btn-primary" id="dialogConfirm">Á°ÆËÆ§</button>
                </div>
            </div>
        </div>
        
        <!-- ‰∏ªÈ¢òÂàáÊç¢ËøáÊ∏°Â±Ç -->
        <div class="theme-transition" id="themeTransition"></div>
        </div>
    </div>

    <script>
        // ÂØÜÁ†ÅÈ™åËØÅÂäüËÉΩ
        const validPasswords = ['517517', 'lingling'];
        
        function verifyPassword() {
            const passwordInput = document.getElementById('passwordInput');
            const passwordError = document.getElementById('passwordError');
            const password = passwordInput.value.trim();
            
            if (validPasswords.includes(password)) {
                // ÂØÜÁ†ÅÊ≠£Á°ÆÔºåÈöêËóèÈ™åËØÅÁïåÈù¢ÔºåÊòæÁ§∫‰∏ªÂ∫îÁî®
                document.getElementById('passwordOverlay').style.display = 'none';
                document.getElementById('mainApp').classList.add('authenticated');
                
                // ‰øùÂ≠òÈ™åËØÅÁä∂ÊÄÅÂà∞sessionStorageÔºà‰ªÖÂú®ÂΩìÂâç‰ºöËØùÊúâÊïàÔºâ
                sessionStorage.setItem('authenticated', 'true');
                
                // ÂàùÂßãÂåñÂ∫îÁî®
                initializeApp();
            } else {
                // ÂØÜÁ†ÅÈîôËØØÔºåÊòæÁ§∫ÈîôËØØ‰ø°ÊÅØ
                passwordError.style.display = 'block';
                passwordInput.value = '';
                passwordInput.focus();
                
                // 3ÁßíÂêéÈöêËóèÈîôËØØ‰ø°ÊÅØ
                setTimeout(() => {
                    passwordError.style.display = 'none';
                }, 3000);
            }
        }
        
        // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÈ™åËØÅËøá
        function checkAuthentication() {
            if (sessionStorage.getItem('authenticated') === 'true') {
                document.getElementById('passwordOverlay').style.display = 'none';
                document.getElementById('mainApp').classList.add('authenticated');
                initializeApp();
            } else {
                // ËÅöÁÑ¶Âà∞ÂØÜÁ†ÅËæìÂÖ•Ê°Ü
                setTimeout(() => {
                    document.getElementById('passwordInput').focus();
                }, 100);
            }
        }
        
        // ÊîØÊåÅÂõûËΩ¶ÈîÆÊèê‰∫§ÂØÜÁ†Å
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                verifyPassword();
            }
        });
        
        // ÂàùÂßãÂåñÂ∫îÁî®ÔºàÂéüÊù•ÁöÑÂàùÂßãÂåñÈÄªËæëÔºâ
        function initializeApp() {
            // Ê∏ÖÈô§ÂèØËÉΩÂØºËá¥ÂºπÁ™óÁöÑËá™Âä®‰øùÂ≠òÊï∞ÊçÆ
            localStorage.removeItem('markdown-auto-save');
            localStorage.removeItem('markdown-auto-save-timestamp');
            
            // ÂàùÂßãÂåñÊãñÊãΩÂäüËÉΩ
            initializeDragAndDrop();
            
            // Áõ¥Êé•Âä†ËΩΩÁ§∫‰æãÔºå‰∏çÊ£ÄÊü•Ëá™Âä®‰øùÂ≠òÂÜÖÂÆπÈÅøÂÖçÂºπÁ™ó
            loadExample();
        }
        // ÈÖçÁΩÆmarkedÈÄâÈ°π
        marked.setOptions({
            breaks: true,
            gfm: true
        });

        const markdownInput = document.getElementById('markdownInput');
        const preview = document.getElementById('preview');
        const wordCount = document.getElementById('wordCount');
        const statusIndicator = document.getElementById('statusIndicator');

        // Ê∏≤ÊüìÊï∞Â≠¶ÂÖ¨Âºè
        function renderMath(element) {
            if (!window.renderMathInElement) {
                return;
            }
            
            const mathIndicator = document.getElementById('mathIndicator');
            const markdownText = document.getElementById('markdownInput').value;
            
            // Ê£ÄÊü•ÊòØÂê¶ÂåÖÂê´Êï∞Â≠¶ÂÖ¨Âºè
            const hasMath = /\$.*?\$|\\\(.*?\\\)|\\\[.*?\\\]|\$\$.*?\$\$/s.test(markdownText);
            
            if (!hasMath) {
                return;
            }
            
            // ÊòæÁ§∫Ê∏≤ÊüìÊåáÁ§∫Âô®
            if (mathIndicator) {
                mathIndicator.classList.add('show');
            }
            
            try {
                renderMathInElement(element, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\(', right: '\\)', display: false},
                        {left: '\\[', right: '\\]', display: true}
                    ],
                    throwOnError: false,
                    errorCallback: function(msg, err) {
                        console.warn('Êï∞Â≠¶ÂÖ¨ÂºèÊ∏≤ÊüìË≠¶Âëä:', msg, err);
                        // Âú®Âá∫ÈîôÁöÑÂú∞ÊñπÊòæÁ§∫ÈîôËØØÊèêÁ§∫
                        if (err && err.position) {
                            const errorSpan = document.createElement('span');
                            errorSpan.className = 'math-error';
                            errorSpan.textContent = 'ÂÖ¨ÂºèÈîôËØØ: ' + msg;
                            err.position.insertAdjacentElement('afterend', errorSpan);
                        }
                    }
                });
                
                // Ê∏≤ÊüìÂÆåÊàêÂêéÈöêËóèÊåáÁ§∫Âô®
                setTimeout(() => {
                    if (mathIndicator) {
                        mathIndicator.classList.remove('show');
                    }
                }, 500);
                
            } catch (error) {
                console.error('Êï∞Â≠¶ÂÖ¨ÂºèÊ∏≤ÊüìÂ§±Ë¥•:', error);
                if (mathIndicator) {
                    mathIndicator.classList.remove('show');
                }
                showToast('ÂÖ¨ÂºèÊ∏≤ÊüìÂ§±Ë¥•', 'ÈÉ®ÂàÜÊï∞Â≠¶ÂÖ¨ÂºèÂèØËÉΩÊó†Ê≥ïÊ≠£Á°ÆÊòæÁ§∫', 'warning', 2000);
            }
        }

        // ToastÈÄöÁü•Á≥ªÁªü
        function showToast(title, message, type = 'success', duration = 3000) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            toast.innerHTML = `
                <div class="toast-icon">${icons[type] || icons.info}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    ${message ? `<div class="toast-message">${message}</div>` : ''}
                </div>
            `;
            
            container.appendChild(toast);
            
            // ÊòæÁ§∫Âä®Áîª
            setTimeout(() => toast.classList.add('show'), 10);
            
            // Ëá™Âä®ÁßªÈô§
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (container.contains(toast)) {
                        container.removeChild(toast);
                    }
                }, 300);
            }, duration);
        }

        // Ëá™ÂÆö‰πâÁ°ÆËÆ§ÂØπËØùÊ°Ü
        function showConfirm(title, message, icon = '‚ùì') {
            return new Promise((resolve) => {
                const dialog = document.getElementById('customDialog');
                const dialogIcon = document.getElementById('dialogIcon');
                const dialogTitle = document.getElementById('dialogTitle');
                const dialogMessage = document.getElementById('dialogMessage');
                const confirmBtn = document.getElementById('dialogConfirm');
                const cancelBtn = document.getElementById('dialogCancel');
                
                dialogIcon.textContent = icon;
                dialogTitle.textContent = title;
                dialogMessage.innerHTML = message;
                
                dialog.classList.add('show');
                
                const handleConfirm = () => {
                    cleanup();
                    resolve(true);
                };
                
                const handleCancel = () => {
                    cleanup();
                    resolve(false);
                };
                
                const cleanup = () => {
                    dialog.classList.remove('show');
                    confirmBtn.removeEventListener('click', handleConfirm);
                    cancelBtn.removeEventListener('click', handleCancel);
                };
                
                confirmBtn.addEventListener('click', handleConfirm);
                cancelBtn.addEventListener('click', handleCancel);
                
                // ESCÈîÆÂèñÊ∂à
                const handleEsc = (e) => {
                    if (e.key === 'Escape') {
                        handleCancel();
                        document.removeEventListener('keydown', handleEsc);
                    }
                };
                document.addEventListener('keydown', handleEsc);
            });
        }

        // ÊòæÁ§∫Áä∂ÊÄÅÊ∂àÊÅØÔºà‰øùÁïôÂêëÂêéÂÖºÂÆπÔºâ
        function showStatus(message, type = 'success') {
            showToast('ÊèêÁ§∫', message, type);
        }

        // Êõ¥Êñ∞Â≠óÊï∞ÁªüËÆ°
        function updateWordCount() {
            const text = markdownInput.value;
            const charCount = text.length;
            const wordCount_val = text.trim() ? text.trim().split(/\s+/).length : 0;
            const lineCount = text.split('\n').length;
            
            // ‰º∞ÁÆóÈòÖËØªÊó∂Èó¥ÔºàÂÅáËÆæÊØèÂàÜÈíü200‰∏™ÂçïËØçÔºâ
            const readTime = Math.ceil(wordCount_val / 200);
            
            // Êõ¥Êñ∞ÂêÑ‰∏™ÁªüËÆ°È°π
            document.getElementById('charCount').textContent = charCount.toLocaleString();
            document.getElementById('wordCount').textContent = wordCount_val.toLocaleString();
            document.getElementById('lineCount').textContent = lineCount.toLocaleString();
            document.getElementById('readTime').textContent = readTime || '<1';
        }

        // Èò≤ÊäñÂáΩÊï∞
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // È¢ÑËßàÊõ¥Êñ∞ÂáΩÊï∞
        function updatePreview() {
            const markdownText = markdownInput.value;
            
            if (markdownText.trim() === '') {
                preview.innerHTML = `
                    <div class="preview-empty">
                        <div class="preview-empty-icon">üìù</div>
                        <div class="preview-empty-title">ÂºÄÂßãÂàõ‰ΩúÊÇ®ÁöÑÊñáÊ°£</div>
                        <div class="preview-empty-subtitle">
                            Âú®Â∑¶‰æßËæìÂÖ•Ê°Ü‰∏≠ËæìÂÖ•MarkdownÂÜÖÂÆπ<br>
                            ÊàñËÄÖ‰ΩøÁî®‰∏ãÊñπÁöÑÂø´ÈÄüÊìç‰Ωú
                        </div>
                        <div class="preview-quick-actions" role="group" aria-label="Âø´ÈÄüÊìç‰Ωú">
                            <button class="quick-action-btn" onclick="loadExample('simple')" aria-label="Âä†ËΩΩÁÆÄÂçïÁ§∫‰æã">üìÑ ÁÆÄÂçïÁ§∫‰æã</button>
                            <button class="quick-action-btn" onclick="loadExample('advanced')" aria-label="Âä†ËΩΩÈ´òÁ∫ßÁ§∫‰æã">üöÄ È´òÁ∫ßÁ§∫‰æã</button>
                            <button class="quick-action-btn" onclick="uploadFile()" aria-label="‰∏ä‰º†MarkdownÊñá‰ª∂">üìÅ ‰∏ä‰º†Êñá‰ª∂</button>
                            <button class="quick-action-btn" onclick="loadFromLocal()" aria-label="Âä†ËΩΩÊú¨Âú∞ËçâÁ®ø">üìÇ Âä†ËΩΩËçâÁ®ø</button>
                        </div>
                    </div>
                `;
                return;
            }
            
            try {
                const html = marked.parse(markdownText);
                preview.innerHTML = html;
                // Ê∏≤ÊüìÊï∞Â≠¶ÂÖ¨Âºè
                setTimeout(() => renderMath(preview), 10);
            } catch (error) {
                preview.innerHTML = `
                    <div style="color: var(--warning); padding: 20px; text-align: center;">
                        <div style="font-size: 24px; margin-bottom: 10px;">‚ö†Ô∏è</div>
                        <div><strong>Ëß£ÊûêÈîôËØØ</strong></div>
                        <div style="font-size: 14px; margin-top: 8px; opacity: 0.8;">${error.message}</div>
                    </div>
                `;
            }
        }

        // Èò≤ÊäñÁöÑÈ¢ÑËßàÊõ¥Êñ∞Ôºà300msÂª∂ËøüÔºâ
        const debouncedUpdatePreview = debounce(updatePreview, 300);

        // ÂÆûÊó∂È¢ÑËßàÂäüËÉΩÔºà‰ΩøÁî®Èò≤ÊäñÔºâ
        markdownInput.addEventListener('input', function() {
            updateWordCount(); // Â≠óÊï∞ÁªüËÆ°Á´ãÂç≥Êõ¥Êñ∞
            debouncedUpdatePreview(); // È¢ÑËßàÊõ¥Êñ∞‰ΩøÁî®Èò≤Êäñ
        });

        // Á§∫‰æãÂÜÖÂÆπÂ∫ì
        const examples = {
            simple: {
                title: 'ÁÆÄÂçïÁ§∫‰æã',
                content: `# ÊàëÁöÑÁ¨¨‰∏Ä‰∏™ÊñáÊ°£

Ê¨¢Ëøé‰ΩøÁî® **MarkdownËΩ¨Word** ËΩ¨Êç¢Âô®ÔºÅ

## Âü∫Á°ÄÊ†ºÂºè

### ÊñáÊú¨Ê†∑Âºè
- **Á≤ó‰ΩìÊñáÊú¨**
- *Êñú‰ΩìÊñáÊú¨*  
- ~~Âà†Èô§Á∫ø~~
- \`Ë°åÂÜÖ‰ª£Á†Å\`

### ÂàóË°®
1. ÊúâÂ∫èÂàóË°®È°π‰∏Ä
2. ÊúâÂ∫èÂàóË°®È°π‰∫å
   - ÂµåÂ•óÊó†Â∫èÂàóË°®
   - Âè¶‰∏Ä‰∏™È°πÁõÆ

### ÂºïÁî®
> ËøôÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂºïÁî®Âùó„ÄÇ
> ÈùûÂ∏∏ÈÄÇÂêàÂº∫Ë∞ÉÈáçË¶ÅÂÜÖÂÆπ„ÄÇ

---
*ÊñáÊ°£ÂàõÂª∫‰∫é ${new Date().toLocaleDateString()}*`
            },
            
            advanced: {
                title: 'È´òÁ∫ßÁ§∫‰æã',
                content: `# üìù È´òÁ∫ßÊñáÊ°£Á§∫‰æã

## üöÄ ÂäüËÉΩÁâπËâ≤

Ëøô‰∏™ËΩ¨Êç¢Âô®ÊîØÊåÅ‰∏∞ÂØåÁöÑMarkdownËØ≠Ê≥ïÔºö

### ‰ª£Á†ÅÂùó
\`\`\`javascript
// ÂáΩÊï∞ÂÆö‰πâ
function convertMarkdown() {
    console.log("Ê≠£Âú®ËΩ¨Êç¢Markdown...");
    return "ËΩ¨Êç¢ÂÆåÊàêÔºÅ";
}

// Ë∞ÉÁî®ÂáΩÊï∞
convertMarkdown();
\`\`\`

### ‰ªªÂä°ÂàóË°®
- [x] ÊîØÊåÅÂü∫Á°ÄMarkdownËØ≠Ê≥ï
- [x] ÊîØÊåÅÊï∞Â≠¶ÂÖ¨ÂºèÊ∏≤Êüì
- [ ] Ê∑ªÂä†Êõ¥Â§öÂØºÂá∫Ê†ºÂºè
- [ ] ÊîØÊåÅÂõæÁâáÊèíÂÖ•

### ÈìæÊé•ÂíåÂõæÁâá
ËÆøÈóÆ [MarkdownÂÆòÊñπÊñáÊ°£](https://daringfireball.net/projects/markdown/) ‰∫ÜËß£Êõ¥Â§öËØ≠Ê≥ï„ÄÇ

### Ê∞¥Âπ≥ÂàÜÂâ≤Á∫ø
---

### Ë°®Ê†ºÂ¢ûÂº∫
| ÂäüËÉΩ | Áä∂ÊÄÅ | ‰ºòÂÖàÁ∫ß | Â§áÊ≥® |
|------|------|--------|------|
| Âü∫Á°ÄËΩ¨Êç¢ | ‚úÖ ÂÆåÊàê | È´ò | Ê†∏ÂøÉÂäüËÉΩ |
| Ê†∑Âºè‰ºòÂåñ | üîÑ ËøõË°å‰∏≠ | ‰∏≠ | ÊåÅÁª≠ÊîπËøõ |
| Êèí‰ª∂ÊîØÊåÅ | üìÖ ËÆ°Âàí‰∏≠ | ‰Ωé | Êú™Êù•ÁâàÊú¨ |

> üí° **ÊèêÁ§∫**: Ëøô‰∏™ËΩ¨Êç¢Âô®‰ºö‰øùÊåÅÂéüÊúâÁöÑÊ†ºÂºèÂíåÊ†∑ÂºèÔºÅ`
            },
            
            math: {
                title: 'Êï∞Â≠¶ÂÖ¨ÂºèÁ§∫‰æã',
                content: `# üìê Êï∞Â≠¶ÂÖ¨ÂºèÁ§∫‰æã

## Ë°åÂÜÖÂÖ¨Âºè
Ë¥®Èáè-ËÉΩÈáèÁ≠â‰ª∑ÊÄßÔºö$E = mc^2$

ÂúÜÁöÑÈù¢ÁßØÂÖ¨ÂºèÔºö$A = \\pi r^2$

## ÂùóÁ∫ßÂÖ¨Âºè

### ÁßØÂàÜ
$$\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}$$

### Áü©Èòµ
$$\\begin{pmatrix}
a & b \\\\
c & d
\\end{pmatrix}$$

### Ê±ÇÂíå
$$\\sum_{i=1}^{n} i = \\frac{n(n+1)}{2}$$

### ‰∫åÊ¨°ÊñπÁ®ãËß£
$$x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$

### ÊûÅÈôê
$$\\lim_{x \\to \\infty} \\frac{1}{x} = 0$$

> Ê≥®ÊÑèÔºöÊï∞Â≠¶ÂÖ¨Âºè‰ΩøÁî®KaTeXÊ∏≤ÊüìÔºåÊîØÊåÅÂ§ßÈÉ®ÂàÜLaTeXËØ≠Ê≥ï„ÄÇ`
            },
            
            table: {
                title: 'Ë°®Ê†ºÁ§∫‰æã',
                content: `# üìä Ë°®Ê†ºÂäüËÉΩÂ±ïÁ§∫

## Âü∫Á°ÄË°®Ê†º
| ‰∫ßÂìÅ | ‰ª∑Ê†º | Êï∞Èáè |
|------|------|------|
| ËãπÊûú | ¬•5 | 10‰∏™ |
| È¶ôËïâ | ¬•3 | 20‰∏™ |
| Ê©ôÂ≠ê | ¬•4 | 15‰∏™ |

## ÂØπÈΩêË°®Ê†º
| Â∑¶ÂØπÈΩê | Â±Ö‰∏≠ÂØπÈΩê | Âè≥ÂØπÈΩê |
|:-------|:-------:|-------:|
| ÊñáÊú¨ | Êï∞Â≠ó | ‰ª∑Ê†º |
| Apple | 100 | $50.00 |
| Banana | 200 | $30.00 |

## Â§çÊùÇË°®Ê†º
| ÂäüËÉΩÊ®°Âùó | ÂºÄÂèëÁä∂ÊÄÅ | ÂÆåÊàêÂ∫¶ | Ë¥üË¥£‰∫∫ | È¢ÑËÆ°Êó∂Èó¥ |
|----------|----------|--------|--------|----------|
| Áî®Êà∑ËÆ§ËØÅ | ‚úÖ Â∑≤ÂÆåÊàê | 100% | Âº†‰∏â | 2024-01 |
| Êñá‰ª∂‰∏ä‰º† | üîÑ ÂºÄÂèë‰∏≠ | 80% | ÊùéÂõõ | 2024-02 |
| Êï∞ÊçÆÂàÜÊûê | üìã ÂæÖÂºÄÂßã | 0% | Áéã‰∫î | 2024-03 |
| Á≥ªÁªü‰ºòÂåñ | üîÑ ÊµãËØï‰∏≠ | 90% | ËµµÂÖ≠ | 2024-01 |

## Êï∞ÊçÆÁªüËÆ°Ë°®
| Êúà‰ªΩ | Áî®Êà∑Êï∞ | Â¢ûÈïøÁéá | Êî∂ÂÖ• |
|------|--------|--------|------|
| 1Êúà | 1,000 | - | ¬•10,000 |
| 2Êúà | 1,200 | +20% | ¬•12,000 |
| 3Êúà | 1,500 | +25% | ¬•15,000 |
| **ÊÄªËÆ°** | **3,700** | **+50%** | **¬•37,000** |`
            }
        };

        // Âä†ËΩΩÁ§∫‰æãÂÜÖÂÆπ
        function loadExample(type = 'simple') {
            const example = examples[type];
            if (!example) {
                showToast('ÈîôËØØ', 'Á§∫‰æãÁ±ªÂûã‰∏çÂ≠òÂú®', 'error');
                return;
            }
            
            markdownInput.value = example.content;
            updateWordCount();
            updatePreview();
            showToast('Âä†ËΩΩÂÆåÊàê', `${example.title}Â∑≤Âä†ËΩΩ`);
            
            // Á°Æ‰øùÊï∞Â≠¶ÂÖ¨ÂºèÊ∏≤Êüì
            if (type === 'math') {
                setTimeout(() => renderMath(preview), 200);
            }
        }

        // Ê∏ÖÁ©∫ÂÜÖÂÆπ
        async function clearContent() {
            if (markdownInput.value.trim()) {
                const confirmed = await showConfirm(
                    'Ê∏ÖÁ©∫ÂÜÖÂÆπ',
                    'Á°ÆËÆ§Ê∏ÖÁ©∫ÊâÄÊúâÂÜÖÂÆπÔºüÊ≠§Êìç‰ΩúÊó†Ê≥ïÊí§ÈîÄ„ÄÇ',
                    'üóëÔ∏è'
                );
                if (!confirmed) return;
            }
            
            markdownInput.value = '';
            updatePreview();
            updateWordCount();
            showToast('Êìç‰ΩúÂÆåÊàê', 'ÂÜÖÂÆπÂ∑≤Ê∏ÖÁ©∫');
        }

        // Â§çÂà∂ÂØåÊñáÊú¨ÂÜÖÂÆπ
        function copyFormattedText() {
            const markdownText = markdownInput.value.trim();
            
            if (!markdownText) {
                showToast('ÊèêÁ§∫', 'ËØ∑ÂÖàËæìÂÖ•MarkdownÂÜÖÂÆπÔºÅ', 'warning');
                return;
            }

            try {
                // Ëß£Êûêmarkdown‰∏∫HTML
                const html = marked.parse(markdownText);
                
                // ÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂divÊù•Â§ÑÁêÜHTML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = html;
                
                // ÈÄâÊã©È¢ÑËßàÂå∫ÂüüÁöÑÂÜÖÂÆπ
                const range = document.createRange();
                range.selectNodeContents(preview);
                
                // Ê∏ÖÈô§‰πãÂâçÁöÑÈÄâÊã©
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
                
                // Â∞ùËØïÂ§çÂà∂
                try {
                    // Áé∞‰ª£ÊµèËßàÂô®‰ΩøÁî® Clipboard API
                    if (navigator.clipboard && navigator.clipboard.write) {
                        // ÂàõÂª∫ ClipboardItemÔºåÂêåÊó∂ÂåÖÂê´HTMLÂíåÁ∫ØÊñáÊú¨
                        const clipboardItems = new ClipboardItem({
                            'text/html': new Blob([html], { type: 'text/html' }),
                            'text/plain': new Blob([preview.textContent], { type: 'text/plain' })
                        });
                        
                        navigator.clipboard.write([clipboardItems]).then(() => {
                            showToast('Â§çÂà∂ÊàêÂäü', 'ÂØåÊñáÊú¨Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                        }).catch(() => {
                            // Â¶ÇÊûúClipboard APIÂ§±Ë¥•ÔºåÂõûÈÄÄÂà∞‰º†ÁªüÊñπÊ≥ï
                            fallbackCopy();
                        });
                    } else {
                        // ÂõûÈÄÄÂà∞‰º†ÁªüÂ§çÂà∂ÊñπÊ≥ï
                        fallbackCopy();
                    }
                } catch (error) {
                    fallbackCopy();
                }
                
                function fallbackCopy() {
                    // ‰º†ÁªüÁöÑÂ§çÂà∂ÊñπÊ≥ï
                    const successful = document.execCommand('copy');
                    if (successful) {
                        showToast('Â§çÂà∂ÊàêÂäü', 'ÂÜÖÂÆπÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                    } else {
                        showToast('Â§çÂà∂Â§±Ë¥•', 'ËØ∑ÊâãÂä®ÈÄâÊã©ÂÜÖÂÆπÂêéÂ§çÂà∂', 'error');
                    }
                }
                
                // Ê∏ÖÈô§ÈÄâÊã©
                selection.removeAllRanges();
                
            } catch (error) {
                console.error('Â§çÂà∂Â§±Ë¥•:', error);
                showToast('Â§çÂà∂Â§±Ë¥•', 'ËØ∑Ê£ÄÊü•ÊÇ®ÁöÑMarkdownÊ†ºÂºèÊòØÂê¶Ê≠£Á°Æ', 'error');
            }
        }

        // ËΩ¨Êç¢‰∏∫WordÊñáÊ°£
        function downloadWord() {
            const markdownText = markdownInput.value.trim();
            
            if (!markdownText) {
                showToast('ÊèêÁ§∫', 'ËØ∑ÂÖàËæìÂÖ•MarkdownÂÜÖÂÆπÔºÅ', 'warning');
                return;
            }

            try {
                // Ëß£Êûêmarkdown‰∏∫HTML
                const html = marked.parse(markdownText);
                
                // Â∞ÜHTMLËΩ¨Êç¢‰∏∫Á∫ØÊñáÊú¨Âπ∂‰øùÊåÅÂü∫Êú¨Ê†ºÂºè
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = html;
                
                // ÊèêÂèñÊñáÊ°£ÂÜÖÂÆπ
                const children = [];
                
                // Â§ÑÁêÜÂêÑÁßçÂÖÉÁ¥†
                Array.from(tempDiv.children).forEach(element => {
                    const tagName = element.tagName.toLowerCase();
                    const text = element.textContent.trim();
                    
                    if (!text) return;
                    
                    switch(tagName) {
                        case 'h1':
                            children.push(new docx.Paragraph({
                                text: text,
                                heading: docx.HeadingLevel.HEADING_1,
                                spacing: { after: 200 }
                            }));
                            break;
                        case 'h2':
                            children.push(new docx.Paragraph({
                                text: text,
                                heading: docx.HeadingLevel.HEADING_2,
                                spacing: { after: 200 }
                            }));
                            break;
                        case 'h3':
                            children.push(new docx.Paragraph({
                                text: text,
                                heading: docx.HeadingLevel.HEADING_3,
                                spacing: { after: 200 }
                            }));
                            break;
                        case 'h4':
                            children.push(new docx.Paragraph({
                                text: text,
                                heading: docx.HeadingLevel.HEADING_4,
                                spacing: { after: 200 }
                            }));
                            break;
                        case 'p':
                            // Â§ÑÁêÜÊÆµËêΩ‰∏≠ÁöÑÊ†ºÂºèÔºàÈÄíÂΩíÂ§ÑÁêÜÊ∑∑ÂêàÊ†ºÂºèÔºâ
                            const runs = [];
                            
                            const processNode = (node) => {
                                if (node.nodeType === Node.TEXT_NODE) {
                                    const textContent = node.textContent;
                                    if (textContent) {
                                        runs.push(new docx.TextRun(textContent));
                                    }
                                } else if (node.nodeType === Node.ELEMENT_NODE) {
                                    const tag = node.tagName.toLowerCase();
                                    
                                    // ÈÄíÂΩíÂ§ÑÁêÜÂµåÂ•óÊ†áÁ≠æ
                                    if (node.childNodes.length > 0) {
                                        Array.from(node.childNodes).forEach(childNode => {
                                            if (childNode.nodeType === Node.TEXT_NODE) {
                                                const textContent = childNode.textContent;
                                                if (textContent) {
                                                    const runProps = {};
                                                    
                                                    // Ê†πÊçÆÁà∂Ê†áÁ≠æËÆæÁΩÆÊ†ºÂºè
                                                    switch(tag) {
                                                        case 'strong':
                                                        case 'b':
                                                            runProps.bold = true;
                                                            break;
                                                        case 'em':
                                                        case 'i':
                                                            runProps.italics = true;
                                                            break;
                                                        case 'code':
                                                            runProps.font = "Courier New";
                                                            runProps.highlight = "yellow";
                                                            break;
                                                        case 'u':
                                                            runProps.underline = {};
                                                            break;
                                                        case 's':
                                                        case 'del':
                                                            runProps.strike = true;
                                                            break;
                                                    }
                                                    
                                                    runs.push(new docx.TextRun({
                                                        text: textContent,
                                                        ...runProps
                                                    }));
                                                }
                                            } else if (childNode.nodeType === Node.ELEMENT_NODE) {
                                                // Â§ÑÁêÜÂµåÂ•óÊ†ºÂºèÔºàÂ¶ÇÁ≤ó‰Ωì+Êñú‰ΩìÔºâ
                                                const childTag = childNode.tagName.toLowerCase();
                                                const childText = childNode.textContent;
                                                if (childText) {
                                                    const runProps = {};
                                                    
                                                    // ÁªßÊâøÁà∂Ê†áÁ≠æÊ†ºÂºè
                                                    if (tag === 'strong' || tag === 'b') runProps.bold = true;
                                                    if (tag === 'em' || tag === 'i') runProps.italics = true;
                                                    if (tag === 'code') {
                                                        runProps.font = "Courier New";
                                                        runProps.highlight = "yellow";
                                                    }
                                                    
                                                    // Ê∑ªÂä†Â≠êÊ†áÁ≠æÊ†ºÂºè
                                                    if (childTag === 'strong' || childTag === 'b') runProps.bold = true;
                                                    if (childTag === 'em' || childTag === 'i') runProps.italics = true;
                                                    if (childTag === 'code') {
                                                        runProps.font = "Courier New";
                                                        runProps.highlight = "yellow";
                                                    }
                                                    if (childTag === 'u') runProps.underline = {};
                                                    if (childTag === 's' || childTag === 'del') runProps.strike = true;
                                                    
                                                    runs.push(new docx.TextRun({
                                                        text: childText,
                                                        ...runProps
                                                    }));
                                                }
                                            }
                                        });
                                    } else {
                                        // Ê≤°ÊúâÂ≠êËäÇÁÇπÁöÑÂÖÉÁ¥†
                                        const content = node.textContent;
                                        if (content) {
                                            const runProps = {};
                                            switch(tag) {
                                                case 'strong':
                                                case 'b':
                                                    runProps.bold = true;
                                                    break;
                                                case 'em':
                                                case 'i':
                                                    runProps.italics = true;
                                                    break;
                                                case 'code':
                                                    runProps.font = "Courier New";
                                                    runProps.highlight = "yellow";
                                                    break;
                                                case 'u':
                                                    runProps.underline = {};
                                                    break;
                                                case 's':
                                                case 'del':
                                                    runProps.strike = true;
                                                    break;
                                            }
                                            runs.push(new docx.TextRun({
                                                text: content,
                                                ...runProps
                                            }));
                                        }
                                    }
                                }
                            };
                            
                            // Â§ÑÁêÜÊâÄÊúâÂ≠êËäÇÁÇπ
                            Array.from(element.childNodes).forEach(processNode);
                            
                            // Â¶ÇÊûúÊ≤°ÊúârunsÔºå‰ΩøÁî®Á∫ØÊñáÊú¨
                            if (runs.length === 0 && text) {
                                runs.push(new docx.TextRun(text));
                            }
                            
                            if (runs.length > 0) {
                                children.push(new docx.Paragraph({
                                    children: runs,
                                    spacing: { after: 120 }
                                }));
                            }
                            break;
                        case 'ul':
                            Array.from(element.querySelectorAll('li')).forEach((li, index) => {
                                children.push(new docx.Paragraph({
                                    text: li.textContent.trim(),
                                    bullet: {
                                        level: 0
                                    },
                                    spacing: { after: 80 }
                                }));
                            });
                            break;
                        case 'ol':
                            Array.from(element.querySelectorAll('li')).forEach((li, index) => {
                                children.push(new docx.Paragraph({
                                    text: li.textContent.trim(),
                                    numbering: {
                                        reference: "default-numbering",
                                        level: 0
                                    },
                                    spacing: { after: 80 }
                                }));
                            });
                            break;
                        case 'blockquote':
                            children.push(new docx.Paragraph({
                                text: text,
                                indent: {
                                    left: 720
                                },
                                spacing: { after: 120 }
                            }));
                            break;
                        case 'pre':
                            // Â§ÑÁêÜ‰ª£Á†ÅÂùó
                            const codeElement = element.querySelector('code');
                            const codeText = codeElement ? codeElement.textContent : text;
                            const codeLines = codeText.split('\n');
                            
                            // Ê∑ªÂä†‰ª£Á†ÅÂùóÊ†áÈ¢ò
                            children.push(new docx.Paragraph({
                                text: "‰ª£Á†ÅÂùó:",
                                spacing: { before: 120, after: 80 },
                                run: {
                                    bold: true,
                                    color: "666666"
                                }
                            }));
                            
                            // ‰∏∫ÊØèË°å‰ª£Á†ÅÂàõÂª∫ÊÆµËêΩ
                            codeLines.forEach((line, index) => {
                                children.push(new docx.Paragraph({
                                    text: line || " ", // Á©∫Ë°åÁî®Á©∫Ê†ºÂç†‰Ωç
                                    spacing: { after: 0, before: 0 },
                                    run: {
                                        font: "Consolas",
                                        size: 18
                                    },
                                    shading: {
                                        type: docx.ShadingType.SOLID,
                                        color: "f8f8f8"
                                    },
                                    border: {
                                        left: {
                                            color: "cccccc",
                                            size: 1,
                                            type: docx.BorderStyle.SINGLE
                                        }
                                    },
                                    indent: {
                                        left: 360
                                    }
                                }));
                            });
                            
                            // ‰ª£Á†ÅÂùóÂêéÁ©∫Ë°å
                            children.push(new docx.Paragraph({
                                text: "",
                                spacing: { after: 120 }
                            }));
                            break;
                        case 'table':
                            // ÁÆÄÂçïË°®Ê†ºÂ§ÑÁêÜ
                            const rows = Array.from(element.querySelectorAll('tr'));
                            if (rows.length > 0) {
                                const tableRows = rows.map(row => {
                                    const cells = Array.from(row.querySelectorAll('td, th'));
                                    return new docx.TableRow({
                                        children: cells.map(cell => new docx.TableCell({
                                            children: [new docx.Paragraph(cell.textContent.trim())]
                                        }))
                                    });
                                });
                                
                                children.push(new docx.Table({
                                    rows: tableRows,
                                    width: {
                                        size: 100,
                                        type: docx.WidthType.PERCENTAGE
                                    }
                                }));
                            }
                            break;
                        default:
                            children.push(new docx.Paragraph({
                                text: text,
                                spacing: { after: 120 }
                            }));
                    }
                });

                // Â¶ÇÊûúÊ≤°ÊúâÂÜÖÂÆπÔºåÂàõÂª∫‰∏Ä‰∏™ÈªòËÆ§ÊÆµËêΩ
                if (children.length === 0) {
                    children.push(new docx.Paragraph("ÊñáÊ°£ÂÜÖÂÆπ"));
                }

                // ÂàõÂª∫WordÊñáÊ°£
                const doc = new docx.Document({
                    sections: [{
                        properties: {},
                        children: children
                    }]
                });

                // ÁîüÊàêÂπ∂‰∏ãËΩΩÊñá‰ª∂
                showToast('Â§ÑÁêÜ‰∏≠', 'Ê≠£Âú®ÁîüÊàêWordÊñáÊ°£...', 'info');
                docx.Packer.toBlob(doc).then(blob => {
                    const currentDate = new Date().toISOString().slice(0, 10);
                    saveAs(blob, `markdown-document-${currentDate}.docx`);
                    showToast('‰∏ãËΩΩÂÆåÊàê', 'WordÊñáÊ°£Â∑≤ÊàêÂäüÁîüÊàêÂπ∂‰∏ãËΩΩ');
                }).catch(error => {
                    console.error('WordÁîüÊàêÂ§±Ë¥•:', error);
                    showToast('ÁîüÊàêÂ§±Ë¥•', 'WordÊñáÊ°£ÁîüÊàêËøáÁ®ã‰∏≠Âá∫Áé∞ÈîôËØØ', 'error');
                });

            } catch (error) {
                console.error('ËΩ¨Êç¢Â§±Ë¥•:', error);
                showToast('ËΩ¨Êç¢Â§±Ë¥•', 'ËØ∑Ê£ÄÊü•ÊÇ®ÁöÑMarkdownÊ†ºÂºèÊòØÂê¶Ê≠£Á°Æ', 'error');
            }
        }

        // ‰∏ä‰º†MarkdownÊñá‰ª∂
        function uploadFile() {
            document.getElementById('fileInput').click();
        }

        // Â§ÑÁêÜÂçï‰∏™Êñá‰ª∂ÁöÑÈÄöÁî®ÂáΩÊï∞
        function processFile(file, uploadType = '‰∏ä‰º†') {
            if (!file) return;

            // Ê£ÄÊü•Êñá‰ª∂Á±ªÂûã
            const allowedTypes = ['.md', '.markdown', '.txt'];
            const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
            if (!allowedTypes.includes(fileExtension)) {
                showToast('Êñá‰ª∂Á±ªÂûãÈîôËØØ', `ËØ∑${uploadType} .md, .markdown Êàñ .txt Ê†ºÂºèÁöÑÊñá‰ª∂`, 'error');
                return;
            }

            // Ê£ÄÊü•Êñá‰ª∂Â§ßÂ∞è (ÈôêÂà∂5MB)
            if (file.size > 5 * 1024 * 1024) {
                showToast('Êñá‰ª∂ËøáÂ§ß', 'Êñá‰ª∂Â§ßÂ∞è‰∏çËÉΩË∂ÖËøá5MB', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    markdownInput.value = e.target.result;
                    updateWordCount();
                    updatePreview();
                    showToast('‰∏ä‰º†ÊàêÂäü', `Êñá‰ª∂ ${file.name} ${uploadType}ÊàêÂäü`);
                } catch (error) {
                    console.error('Êñá‰ª∂Â§ÑÁêÜÈîôËØØ:', error);
                    showToast('Â§ÑÁêÜÂ§±Ë¥•', 'Êñá‰ª∂ÂÜÖÂÆπÂ§ÑÁêÜÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂Ê†ºÂºè', 'error');
                }
            };
            reader.onerror = function() {
                showToast('ËØªÂèñÂ§±Ë¥•', 'Êñá‰ª∂ËØªÂèñÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error');
            };
            reader.readAsText(file, 'UTF-8');
        }

        // Â§ÑÁêÜÊñá‰ª∂‰∏ä‰º†
        function handleFileUpload(event) {
            const file = event.target.files[0];
            processFile(file, '‰∏ä‰º†');
        }

        // ‰øùÂ≠òËçâÁ®øÂà∞Êú¨Âú∞Â≠òÂÇ®
        function saveToLocal() {
            const content = markdownInput.value;
            if (!content.trim()) {
                showToast('ÊèêÁ§∫', 'Ê≤°ÊúâÂÜÖÂÆπÂèØ‰øùÂ≠òÔºÅ', 'warning');
                return;
            }
            
            const timestamp = new Date().toLocaleString();
            localStorage.setItem('markdown-draft', content);
            localStorage.setItem('markdown-draft-timestamp', timestamp);
            showToast('‰øùÂ≠òÊàêÂäü', `ËçâÁ®øÂ∑≤‰øùÂ≠ò (${timestamp})`);
        }

        // ‰ªéÊú¨Âú∞Â≠òÂÇ®Âä†ËΩΩËçâÁ®ø
        async function loadFromLocal() {
            const savedContent = localStorage.getItem('markdown-draft');
            const timestamp = localStorage.getItem('markdown-draft-timestamp');
            
            if (!savedContent) {
                showToast('ÊèêÁ§∫', 'Ê≤°ÊúâÊâæÂà∞‰øùÂ≠òÁöÑËçâÁ®øÔºÅ', 'info');
                return;
            }
            
            if (markdownInput.value.trim()) {
                const confirmed = await showConfirm(
                    'Âä†ËΩΩËçâÁ®ø',
                    'ÂΩìÂâçÊúâÂÜÖÂÆπÔºåÊòØÂê¶Á°ÆËÆ§Âä†ËΩΩËçâÁ®øÔºüËøôÂ∞ÜË¶ÜÁõñÂΩìÂâçÂÜÖÂÆπ„ÄÇ',
                    'üìÇ'
                );
                if (!confirmed) return;
            }
            
            markdownInput.value = savedContent;
            updateWordCount();
            updatePreview();
            showToast('Âä†ËΩΩÂÆåÊàê', `ËçâÁ®øÂä†ËΩΩÊàêÂäü (${timestamp || 'Êú™Áü•'})`);
        }

        // Ëá™Âä®‰øùÂ≠òÂäüËÉΩÂ∑≤ÁßªÈô§ÔºåÈÅøÂÖçÂºπÁ™óÈóÆÈ¢ò

        // Ê∑ªÂä†ÊãñÊãΩ‰∏ä‰º†ÊîØÊåÅÔºàÂè™ÊúâÂú®ËÆ§ËØÅÂêéÊâçÊ∑ªÂä†Ôºâ
        function initializeDragAndDrop() {
            const markdownInput = document.getElementById('markdownInput');
            const dragOverlay = document.getElementById('dragOverlay');
            if (!markdownInput || !dragOverlay) return;

            // ÊãñÊãΩËøõÂÖ•
            markdownInput.addEventListener('dragenter', function(e) {
                e.preventDefault();
                dragOverlay.classList.add('show');
            });

            // ÊãñÊãΩÊÇ¨ÂÅú
            markdownInput.addEventListener('dragover', function(e) {
                e.preventDefault();
                dragOverlay.classList.add('show');
            });

            // ÊãñÊãΩÁ¶ªÂºÄ
            markdownInput.addEventListener('dragleave', function(e) {
                e.preventDefault();
                // Ê£ÄÊü•ÊòØÂê¶ÁúüÁöÑÁ¶ªÂºÄ‰∫ÜÊãñÊãΩÂå∫Âüü
                const rect = this.getBoundingClientRect();
                if (e.clientX < rect.left || e.clientX > rect.right || 
                    e.clientY < rect.top || e.clientY > rect.bottom) {
                    dragOverlay.classList.remove('show');
                }
            });

            // Êñá‰ª∂ÊîæÁΩÆ
            markdownInput.addEventListener('drop', function(e) {
                e.preventDefault();
                dragOverlay.classList.remove('show');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const file = files[0];
                    // ÊòæÁ§∫‰∏ä‰º†ÂºÄÂßãÊèêÁ§∫
                    showToast('ÂºÄÂßã‰∏ä‰º†', `Ê≠£Âú®ËØªÂèñÊñá‰ª∂ ${file.name}...`, 'info', 1000);
                    processFile(file, 'ÊãñÊãΩ‰∏ä‰º†');
                }
            });

            // ÂÖ®Â±ÄÊãñÊãΩ‰∫ã‰ª∂Â§ÑÁêÜÔºåÈò≤Ê≠¢È°µÈù¢Âà∑Êñ∞
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.addEventListener(eventName, function(e) {
                    e.preventDefault();
                }, false);
            });
        }

        // Ëá™Âä®‰øùÂ≠òÂäüËÉΩÂ∑≤ÁßªÈô§

        // Ê∑ªÂä†Âø´Êç∑ÈîÆÊîØÊåÅ
        document.addEventListener('keydown', function(e) {
            // Ctrl+S ‰øùÂ≠òËçâÁ®ø
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveToLocal();
            }
            // Ctrl+O ÊâìÂºÄÊñá‰ª∂
            if (e.ctrlKey && e.key === 'o') {
                e.preventDefault();
                uploadFile();
            }
            // Ctrl+D ‰∏ãËΩΩWord
            if (e.ctrlKey && e.key === 'd') {
                e.preventDefault();
                downloadWord();
            }
            // Ctrl+Enter Â§çÂà∂ÂØåÊñáÊú¨
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                copyFormattedText();
            }
            // Ctrl+/ ÊòæÁ§∫Âø´Êç∑ÈîÆ
            if (e.ctrlKey && e.key === '/') {
                e.preventDefault();
                showShortcuts();
            }
        });

        // ÊòæÁ§∫Âø´Êç∑ÈîÆÂ∏ÆÂä©
        function showShortcuts() {
            const shortcuts = [
                { key: 'Ctrl + S', desc: '‰øùÂ≠òËçâÁ®øÂà∞Êú¨Âú∞Â≠òÂÇ®' },
                { key: 'Ctrl + O', desc: 'ÊâìÂºÄÂπ∂‰∏ä‰º†Êñá‰ª∂' },
                { key: 'Ctrl + D', desc: '‰∏ãËΩΩWordÊñáÊ°£' },
                { key: 'Ctrl + Enter', desc: 'Â§çÂà∂ÂØåÊñáÊú¨ÂÜÖÂÆπ' },
                { key: 'Ctrl + /', desc: 'ÊòæÁ§∫Âø´Êç∑ÈîÆÂ∏ÆÂä©' },
                { key: 'Esc', desc: 'ÂÖ≥Èó≠ÂØπËØùÊ°Ü' }
            ];
            
            const shortcutsList = shortcuts.map(item => 
                `<div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 6px 0; border-bottom: 1px solid var(--border-color);">
                    <code style="background: var(--preview-bg); padding: 2px 6px; border-radius: 4px; font-weight: 600;">${item.key}</code>
                    <span style="color: var(--text-secondary);">${item.desc}</span>
                </div>`
            ).join('');
            
            showConfirm(
                '‚å®Ô∏è ÈîÆÁõòÂø´Êç∑ÈîÆ',
                `<div style="text-align: left; max-width: 400px;">${shortcutsList}</div>`,
                'üí°'
            );
        }

        // ‰∏ªÈ¢òÁÆ°ÁêÜÂäüËÉΩ
        let currentTheme = 'amber'; // ÈªòËÆ§Ê∏©ÊöñÁê•ÁèÄ‰∏ªÈ¢ò
        
        function toggleTheme(event) {
            const themes = [
                { name: 'amber', text: 'Ê∏©ÊöñÁê•ÁèÄ', dataTheme: null, bg: '#ffeaa7' },
                { name: 'classic', text: 'ÁªèÂÖ∏ÁªøËâ≤', dataTheme: 'classic', bg: '#667eea' }
            ];
            
            const currentIndex = themes.findIndex(theme => theme.name === currentTheme);
            const nextIndex = (currentIndex + 1) % themes.length;
            const nextTheme = themes[nextIndex];
            
            // Ëé∑ÂèñÈº†Ê†á‰ΩçÁΩÆ
            const rect = event.target.getBoundingClientRect();
            const x = ((rect.left + rect.width / 2) / window.innerWidth) * 100;
            const y = ((rect.top + rect.height / 2) / window.innerHeight) * 100;
            
            // ËÆæÁΩÆËøáÊ∏°ÊïàÊûúÁöÑËµ∑Âßã‰ΩçÁΩÆÂíåÈ¢úËâ≤
            const transition = document.getElementById('themeTransition');
            const themeToggle = event.target.closest('.theme-toggle');
            
            transition.style.setProperty('--mouse-x', x + '%');
            transition.style.setProperty('--mouse-y', y + '%');
            transition.style.setProperty('--new-bg', nextTheme.bg);
            
            // Ê∑ªÂä†ÂàáÊç¢Âä®ÁîªÁ±ª
            themeToggle.classList.add('switching');
            
            // ÂºÄÂßãËøáÊ∏°Âä®Áîª
            transition.classList.add('active');
            
            // Âª∂ËøüÂàáÊç¢‰∏ªÈ¢òÔºåËÆ©ËøáÊ∏°Âä®ÁîªÂÖàÂºÄÂßã
            setTimeout(() => {
                currentTheme = nextTheme.name;
                
                // Êõ¥Êñ∞bodyÁöÑdata-themeÂ±ûÊÄß
                if (nextTheme.dataTheme) {
                    document.body.setAttribute('data-theme', nextTheme.dataTheme);
                } else {
                    document.body.removeAttribute('data-theme');
                }
                
                // Êõ¥Êñ∞ÊåâÈíÆÊñáÊú¨
                document.getElementById('themeText').textContent = nextTheme.text;
                
                // ‰øùÂ≠òÂà∞localStorage
                localStorage.setItem('selectedTheme', currentTheme);
            }, 200);
            
            // ÁªìÊùüËøáÊ∏°Âä®Áîª
            setTimeout(() => {
                transition.classList.remove('active');
                themeToggle.classList.remove('switching');
                showToast('‰∏ªÈ¢òÂ∑≤ÂàáÊç¢', `Â∑≤ÂàáÊç¢Âà∞${nextTheme.text}‰∏ªÈ¢ò`);
            }, 600);
        }
        
        function loadSavedTheme() {
            const savedTheme = localStorage.getItem('selectedTheme');
            if (savedTheme && savedTheme !== 'amber') {
                currentTheme = savedTheme;
                const themes = [
                    { name: 'amber', text: 'Ê∏©ÊöñÁê•ÁèÄ', dataTheme: null },
                    { name: 'classic', text: 'ÁªèÂÖ∏ÁªøËâ≤', dataTheme: 'classic' }
                ];
                
                const theme = themes.find(t => t.name === savedTheme);
                if (theme) {
                    if (theme.dataTheme) {
                        document.body.setAttribute('data-theme', theme.dataTheme);
                    }
                    document.getElementById('themeText').textContent = theme.text;
                }
            }
        }

        // È°µÈù¢Âä†ËΩΩÊó∂Ê£ÄÊü•ËÆ§ËØÅÁä∂ÊÄÅ
        window.addEventListener('load', function() {
            checkAuthentication();
            // Âä†ËΩΩ‰øùÂ≠òÁöÑ‰∏ªÈ¢òÔºàÂú®ËÆ§ËØÅÂêéÔºâ
            setTimeout(() => {
                loadSavedTheme();
            }, 100);
        });
    </script>
</body>
</html>